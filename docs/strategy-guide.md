# HFT Platform Strategy Development Guide

## 1. Overview
Strategies inherit `BaseStrategy` and implement event handlers:
- `on_tick(TickEvent)`
- `on_book_update(BidAskEvent)`
- `on_stats(LOBStatsEvent)`
- `on_fill(FillEvent)`
- `on_order(OrderEvent)`

Use the built-in helpers `buy`, `sell`, `cancel`, and `position`.

## 2. Creating a Strategy
Create a file in `src/hft_platform/strategies/` (or `examples/strategies/` for samples).

```python
from hft_platform.events import LOBStatsEvent
from hft_platform.strategy.base import BaseStrategy


class MyStrategy(BaseStrategy):
    def on_stats(self, event: LOBStatsEvent) -> None:
        if event.spread > 5:
            self.buy(event.symbol, event.best_bid, 1)
```

## 3. Using Alpha Factors
Alpha helpers live in `hft_platform.strategy.factors` and expect a LOB snapshot
with `{"bids": [[price, volume], ...], "asks": [[price, volume], ...]}`.

```python
from hft_platform.events import BidAskEvent
from hft_platform.strategy import factors


def on_book_update(self, event: BidAskEvent) -> None:
    lob = {
        "bids": event.bids.tolist() if hasattr(event.bids, "tolist") else event.bids,
        "asks": event.asks.tolist() if hasattr(event.asks, "tolist") else event.asks,
    }
    entropy = factors.price_entropy(lob)
```

## 4. Registering a Strategy
Defaults live in `config/base/strategies.yaml`. For local overrides, create
`config/strategies.yaml` (auto-generated by `python -m hft_platform init`).

```yaml
strategies:
  - id: "maker_01"
    module: "hft_platform.strategies.my_strategy"
    class: "MyStrategy"
    enabled: true
    params:
      lookback: 20
```

## 5. Running and Testing

```bash
python -m hft_platform run --mode sim --strategy maker_01
python -m hft_platform strat test --symbol 2330
python -m hft_platform backtest run \
  --data data/sample_feed.npz \
  --strategy-module hft_platform.strategies.my_strategy \
  --strategy-class MyStrategy \
  --strategy-id maker_01 \
  --symbol 2330
```
