# HFT Platform Strategy Development Guide

## 1. Overview
Strategies in HFT Platform are Python classes inheriting from `BaseStrategy`. They run in an event-driven loop, responding to:
*   **LOB Updates**: `on_lob(lob, metadata)`
*   **Trades**: `on_trade(trade)`
*   **Timer**: `on_timer(ts)`
*   **Order Events**: `on_fill(event)`, `on_cancel(event)`

## 2. Creating a Strategy
Create a file in `src/hft_platform/strategies/` or `examples/strategies/`.

```python
from hft_platform.strategy.base import BaseStrategy
from hft_platform.contracts.schema import Side

class MyStrategy(BaseStrategy):
    def on_lob(self, lob, metadata):
        symbol = metadata["symbol"]
        mid = (lob["bids"][0][0] + lob["asks"][0][0]) / 2
        
        # Simple Logic
        self.place_limit_order(symbol, Side.BUY, int(mid * 0.99 * 10000), 1)
```

## 3. Utilizing Alpha Features (New!)
The platform provides a suite of advanced microstructure features in `hft_platform.strategy.factors`.

### Available Factors
| Feature | Function | Description |
| :--- | :--- | :--- |
| **Entropy** | `factors.price_entropy(lob)` | Shannon entropy of volume distribution. |
| **Micro-Price** | `factors.stoikov_micro_price(lob)` | Imbalance-adjusted fair value. |
| **Hurst** | `factors.get_hurst(prices)` | Fractal dimension (Trend vs Mean Reversion). |
| **Spread** | `est = factors.create_roll_estimator(w)` | Rolling effective spread (Covariance). |
| **Liquidity** | `est = factors.create_amihud_estimator(w)` | Amihud Illiquidity Ratio. |

### Example Usage
See `examples/strategies/advanced_mm.py` for a full implementation.

```python
from hft_platform.strategy import factors

def on_lob(self, lob, meta):
    # 1. Normalize
    norm_lob = factors.normalize_lob(lob)
    
    # 2. Calculate
    h = factors.price_entropy(norm_lob)
    
    # 3. Decide
    if h < 2.0:
       self.logger.info("Liquidity Concentrated (Wall Detected)")
```

## 4. Running Backtests
Use the `backtest` command to simulate your strategy.

```bash
# Generate mock data if needed (auto-generated by runner)
python -m hft_platform backtest run --strategy MyStrategy --date 2023-01-01
```

## 5. Deployment
Register your strategy in `config/strategies.yaml`:

```yaml
strategies:
  - id: "maker_01"
    class: "strategies.my_strategy.MyStrategy"
    params:
      lookback: 20
```
