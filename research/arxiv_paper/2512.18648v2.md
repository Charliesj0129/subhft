# Optimal Signal Extraction from Order Flow: A Matched Filter Perspective on Normalization and Market Microstructure

#### Sungwoo Kang [∗] _Department of Electrical and Computer Engineering_ _Korea University, Seoul 02841, Republic of Korea_ December 2025

**Abstract**


We demonstrate that the choice of normalization for order flow intensity is fundamental to signal extraction in finance, not merely a technical detail. Through theoretical modeling, Monte Carlo simulation, and empirical validation using 2.1 million
stock-day observations from the Korean market, we prove that market capitalization
normalization acts as a “matched filter” for informed trading signals, achieving 1.32–
1.92 _×_ higher correlation with future returns compared to traditional trading value
normalization. The key insight is that informed traders scale positions by firm value
(market capitalization), while noise traders respond to daily liquidity (trading volume),
creating heteroskedastic corruption when normalizing by trading volume. By reframing the normalization problem using signal processing theory, we show that dividing
order flow by market capitalization preserves the information signal while traditional
volume normalization multiplies the signal by inverse turnover—a highly volatile quantity. Empirically, market capitalization normalization achieves highly significant return
predictability ( _t_ = 9 _._ 65) while trading value normalization is only marginally significant ( _t_ = 2 _._ 10). In horse race regressions for return prediction, market capitalization
normalization strengthens ( _t_ = 10 _._ 99) while trading value normalization’s coefficient
reverses sign ( _t_ = _−_ 6 _._ 81), confirming it captures spurious correlation rather than genuine information. The advantage is strongest for small-cap stocks where turnover heterogeneity is greatest. These findings have immediate implications for high-frequency
trading algorithms, risk factor construction, and information-based trading strategies.


**Keywords:** Signal extraction; Order flow; Matched filter; Market microstructure; Normalization; Information asymmetry; Heteroskedasticity
**JEL Classification:** G12; G14; C58


∗Corresponding author. Email: krml919@korea.ac.kr


1


### **1 Introduction**

The measurement of trading intensity is central to modern finance. Whether detecting
informed trading (Easley et al., 1996) or designing high-frequency strategies, researchers
and practitioners must normalize raw order flow by some measure of firm size or activity.
The standard approach divides net buying (in dollars) by contemporaneous trading volume,
creating what we term a “participation” measure. This normalization appears natural: it
captures what fraction of daily trading was directional.
However, this normalization choice is not innocuous. We demonstrate that it fundamentally corrupts the information signal researchers seek to extract. The problem is one
of _heteroskedastic mismatch_ : informed traders scale their positions relative to firm market
capitalization (a measure of capacity), while noise traders respond to daily liquidity (trading volume). When we normalize by trading volume, we inadvertently scale the true signal
by the inverse of turnover—a highly variable, firm-specific quantity—creating systematic
heteroskedasticity that obscures the very relationship we aim to measure.

#### **1.1 The Matched Filter Perspective**


Our contribution is to reframe order flow normalization as a _signal processing_ problem. In
communications theory, a matched filter maximizes signal-to-noise ratio by weighting the
received signal according to the known structure of the transmitted signal (Turin, 1960). We
show that informed trader order flow has a known structure: _Qinf,i_ = _k · αi · Mi_, where _αi_
is the information signal (expected return), _Mi_ is market capitalization, and _k_ is a scaling
constant reflecting risk aversion and capital constraints.
The matched filter for this signal structure is simply division by market capitalization:
_Di/Mi_ . This normalization “undoes” the informed trader’s scaling, recovering the pure signal
_αi_ (plus additive noise). In contrast, division by trading volume _Vi_ creates multiplicative
noise proportional to ( _Mi/Vi_ ), the inverse turnover ratio.

#### **1.2 Main Results**


Through 1,000 Monte Carlo simulations with 500 stocks each, we establish that market
capitalization normalization achieves:


  - 1.32 _×_ higher correlation with returns in the baseline specification


  - 1.20–1.39 _×_ advantage for moderate to strong signals ( _σα_ = 0 _._ 03 to 0 _._ 10)


  - 1.14–1.41 _×_ advantage across noise levels ( _σζ_ = 1 _._ 0 to 7 _._ 0)


  - 1.92 _×_ advantage when turnover heterogeneity is high (wide distribution)


All differences are statistically significant at _p <_ 0 _._ 001 (paired _t_ -tests with _t >_ 100 across
specifications).


2


#### **1.3 Related Literature**

Our work connects three strands of literature. First, _market microstructure_ research on
order flow and price discovery (Kyle, 1985; Glosten and Milgrom, 1985; Easley et al., 1996;
Hasbrouck, 1991). While this literature recognizes informed vs. noise trader heterogeneity,
it has not formalized the normalization problem from a signal processing perspective.
Second, _institutional trading_ and _asset pricing_ studies that examine how large investors
trade or construct factors based on firm capacity (Fama and French, 1993; Campbell et al.,
2009; Beber et al., 2011). These papers implicitly support market capitalization scaling by
analyzing positions relative to firm size rather than daily volume.
Third, _asset pricing_ studies using trading-based measures (Pastor and Stambaugh, 2003;
Amihud, 2002) typically normalize by dollar volume or share volume without theoretical
justification, potentially explaining mixed empirical results.
Fourth, _turnover research_ that characterizes turnover as a proxy for investor disagreement
and uncertainty rather than pure liquidity (Barinov, 2014; Datar et al., 1998). This supports
our theoretical claim that noise trading scales with volume.
Finally, _signal processing_ applications to finance (Campbell et al., 1997; Turin, 1960).
We extend this by explicitly modeling the matched filter property of market capitalization
normalization.

#### **1.4 Roadmap**


The remainder of this paper is organized as follows. Section 2 provides a comprehensive
review of related literature. Section 3 develops our theoretical model and the matched filter
proposition. Section 4 presents Monte Carlo validation. Section 5 provides empirical evidence
from the Korean stock market. Section 6 discusses implications, and Section 7 concludes.

### **2 Literature Review**


To contextualize our matched filter hypothesis, we review related works across market microstructure, institutional trading, asset pricing, and signal processing. While explicit application of matched filter theory to order flow normalization is novel, several strands of
research implicitly support the superiority of market capitalization as a scaling factor.

#### **2.1 Market Microstructure and Price Discovery**


The foundational work of Kyle (1985) establishes that price impact ( _λ_ ) is a function of the
signal-to-noise ratio in the order flow. In Kyle’s model, the market maker sets prices based
on total order flow, which mixes informed and uninformed trading. The key insight is that
informed traders optimize their trading intensity based on their information advantage and
the market’s depth.
Glosten and Milgrom (1985) develop a complementary model where the bid-ask spread
reflects adverse selection costs. Both frameworks establish that informed and noise traders
have fundamentally different motivations and, crucially, different scaling behaviors. However,
neither framework explicitly addresses the normalization question we pose.


3


The “Square Root Law” of market impact, empirically documented by Torre (1997)
and theoretically grounded by Gabaix et al. (2003), states that price impact scales with
the square root of order size relative to volume: _I ∝_ - _Q/V_ . This law is often cited to

justify volume normalization. However, a careful reading reveals nuances that support our
matched filter approach. The Square Root Law describes the _cost_ of trading—the friction
the market imposes. Informed traders optimize their execution to minimize this friction,
but their _desired_ position size is driven by the fundamental signal value, which scales with
market capitalization. The presence of concave impact costs (square root rather than linear)
actually allows informed traders to scale up their positions more aggressively in large-cap
stocks.

#### **2.2 Institutional Trading and Order Flow Studies**


The strongest empirical support for our hypothesis comes from studies that isolate institutional (informed) trading from aggregate data.
Campbell et al. (2009) develop an algorithm to infer institutional order flow from TAQ
(Trade and Quote) data. Crucially, they validate their measure against quarterly 13F filings,
which report holdings as a percentage of shares outstanding. Their methodology naturally
aligns with market capitalization scaling, as 13F-based validation requires measuring flow
relative to total equity, not daily volume. They explicitly measure institutional order flow
as a percentage of total market capitalization, providing a direct precedent for our _S_ _[MC]_

measure.
Beber et al. (2011) investigate the information content of sector-level order flow. They
explicitly define “active sector order flow” as the flow in excess of the proportion dictated by
the sector’s _market capitalization_ . Mathematically, they calculate “passive” flow as the total
market flow multiplied by the sector’s market cap weight ( _wi_ = _Mi/_ [�] _Mj_ ). This definition
formalizes the idea that the “neutral” expectation for flow is proportional to _Mi_, not _Vi_ . Any
deviation from this cap-weighted baseline represents an active, potentially informed, view.
Lewellen (2011) analyzes how institutional investors aggregate to affect asset prices. His
findings suggest that institutions, constrained by benchmarks and capacity, allocate capital
in ways that scale with firm size rather than daily trading activity.

#### **2.3 Turnover as Uncertainty, Not Liquidity**


A key pillar of our argument is that turnover ( _Vi/Mi_ ) proxies for noise rather than information. If turnover were purely information-driven, normalizing by it might be justified.
Barinov (2014) explicitly argues that turnover is a proxy for _firm-specific uncertainty_
and _investor disagreement_, rather than liquidity or information arrival. High turnover indicates high disagreement, which creates noise in the price discovery process. Stocks with
high turnover have higher volatility and lower future returns, consistent with the view that
turnover reflects speculative activity rather than informed trading.
Datar et al. (1998) document a negative relationship between turnover and expected
returns, which they attribute to liquidity effects. However, subsequent research suggests this
“liquidity” effect may actually capture uncertainty and disagreement.


4


Banerjee and Kremer (2010) develop a theoretical model showing that high volume often
reflects differences of opinion (noise) rather than the arrival of new fundamental information.
This directly supports our model specification _Qnoise ∝_ _Vi_ .
The implication is clear: normalizing by turnover-contaminated volume ( _S_ _[TV]_ = _Di/Vi_ )
mechanically down-weights informed signals during periods of high disagreement. Market
capitalization normalization ( _S_ _[MC]_ ) does not impose this penalty, allowing informed views
to be expressed more clearly.

#### **2.4 Probability of Informed Trading and Flow Toxicity**


The PIN (Probability of Informed Trading) metric, developed by Easley et al. (1996), estimates the probability of informed trading based on order imbalance. Standard PIN estimation often bins data by time or trade count.
Easley et al. (2012) introduced Volume-Synchronized Probability of Informed Trading
(VPIN), which samples data in volume-time rather than clock-time. While VPIN is effective
for detecting flow toxicity (a risk management application), it is fundamentally a measure
of imbalance _per unit of volume_ . For alpha prediction—where the goal is to identify the
magnitude and direction of informed trading—preserving the absolute scale of the imbalance
relative to the firm’s equity base is crucial. VPIN’s volume normalization may be appropriate
for its intended purpose (toxicity detection), but our analysis suggests market capitalization
normalization is superior for return prediction.

#### **2.5 Signal Processing in Finance**


While rare, applications of signal processing to finance have precedents. Turin (1960) provides the foundational treatment of matched filters in communications theory. The key
insight is that to detect a known signal waveform embedded in noise, one should correlate
the received data with a template of the expected signal structure.
Campbell et al. (1997) apply various filtering techniques to financial time series, though
primarily in a time-series (rather than cross-sectional) context. Kalman filters and statespace models are used for noise reduction and signal extraction.
Our contribution is to extend matched filter logic to the cross-sectional normalization
problem. We identify market capitalization as the “replica” of the informed trader’s capacity
function, making 1 _/Mi_ the optimal filter for recovering the latent signal _αi_ .

#### **2.6 Summary of Literature Position**


Table 1 summarizes how different methodological approaches in the literature align with our
matched filter perspective. The key observation is that papers explicitly studying informed
institutional trading tend to normalize by market capitalization (or shares outstanding),
while papers focused on liquidity and market impact tend to normalize by volume. Our
contribution is to provide a theoretical foundation for this distinction: market capitalization
normalization is optimal for _signal extraction_, while volume normalization may be appropriate for _execution cost_ analysis.


5


Table 1: Comparative Analysis of Normalization Approaches in Literature

**Literature** **Do-** **Representative** **NormalizationImplicit** **As-** **Matched** **Filter**
**main** **Papers** **sumption** **Assessment**



Market Mi- Kyle (1985);
crostructure Glosten & Milgrom
(1985)



Order Flow / Price impact _λ_
_λ_ scales with signalto-noise ratio



Conflates execution
cost with signal intent



Illiquidity Mea- Amihud (2002) Return / Vol- Volume drives price Correct for measursures ume change ing illiquidity, not
directional signal



Institutional Campbell et al.
Trading (2009); Beber et al.
(2011)



% of Shares / Holdings scale with **Aligned** : RecogMarket Cap firm size nizes cap-scaling of
positions



Turnover Re- Barinov (2014); Shares Out- Turnover = Dis- **Supports** : Idensearch Datar et al. (1998) standing agreement (Noise) tifies _Vi_ as noise
proxy


Flow Toxicity Easley et al. (2012) Volume buck- Toxicity per unit Appropriate for
(VPIN) ets volume risk; suboptimal
for alpha


Technical Analy- VWAP, OBV Volume- Volume confirms Lacks structural
sis Weighted price foundation


**Proposed** **This Paper** **Market Cap** **Signal** _∝_ _Mi_ **;** **Optimal** :
**Method** **Noise** _∝_ _Vi_ Matched filter
for informed flow


_Notes_ : This table summarizes how different methodological approaches in the literature handle order
flow normalization. Papers studying informed institutional trading tend to normalize by market capitalization or shares outstanding (aligned with our matched filter approach), while papers focused on
liquidity and market impact normalize by volume. Our contribution provides a theoretical foundation
for this distinction: market capitalization normalization is optimal for signal extraction, while volume
normalization may be appropriate for execution cost analysis.


6


### **3 Theoretical Model**

#### **3.1 Setup and Primitives**

Consider a cross-section of _N_ stocks indexed by _i ∈{_ 1 _, . . ., N_ _}_ . Each stock has:


  - Market capitalization _Mi_ (known, time-invariant for simplicity)


  - Daily trading volume _Vi_ = _τiMi_, where _τi_ is the turnover rate


  - True information content _αi_ (latent, mean-zero, variance _σα_ [2] [)]


  - Future returns _Ri_ = _γαi_ + _ϵi_, where _ϵi ∼_ _N_ (0 _, σϵ_ [2][)]

#### **3.2 Order Flow Generation**


Two types of traders generate order flow:
**Informed Traders** observe _αi_ and trade to exploit it. From mean-variance optimization,
optimal position size is proportional to expected return and inversely proportional to risk.
Crucially, informed traders scale their absolute dollar positions by market cap, reflecting
capacity constraints and capital allocation rules:


_Qinf,i_ = _k · αi · Mi_ (1)


where _k >_ 0 captures risk aversion and institutional constraints.
**Noise Traders** trade for non-informational reasons (liquidity needs, attention, behavioral biases). Their order flow scales with daily trading activity:


_Qnoise,i_ = _ζi · Vi_ (2)


where _ζi ∼_ _N_ (0 _, σζ_ [2][) is independent of] _[ α][i]_ [.]
**Observed Order Flow** is the sum:


_Di_ = _Qinf,i_ + _Qnoise,i_ = _kαiMi_ + _ζiVi_ (3)

#### **3.3 Signal Extraction Problem**


Our goal: extract _αi_ from observed _Di_ to predict _Ri_ .
**Trading Value Normalization** (existing literature):



_Si_ _[TV]_ = _[D][i]_




_[D][i]_ = _[kα][i][M][i]_ [ +] _[ ζ][i][V][i]_

_Vi_ _Vi_



_Vi_







= _kαi_




- _Mi_

_Vi_



+ _ζi_ (4)




- ~~�~~ - ~~�~~

_τi_ _[−]_ [1]



_Problem_ : The signal _αi_ is multiplied by 1 _/τi_ (inverse turnover), which varies substantially
across stocks and time. This creates heteroskedastic corruption of the signal.


7


**Market Capitalization Normalization** (our proposal):




_[D][i]_ = _[kα][i][M][i]_ [ +] _[ ζ][i][V][i]_

_Mi_ _Mi_



_Si_ _[MC]_ = _[D][i]_



_Mi_ _Mi_

= _kαi_ + _ζiτi_ (5)



_Advantage_ : The signal _kαi_ appears unscaled and unbiased. Noise is scaled by turnover
_τi_, but this affects only the noise term, not the signal itself.

#### **3.4 Matched Filter Proposition**


**Proposition 3.1** (Matched Filter Optimality) **.** _Let ρ_ ( _S, R_ ) _denote the correlation between_
_a normalized signal S and future returns R_ = _γα_ + _ϵ. Then:_


_E_ [ _ρ_ ( _S_ _[MC]_ _, R_ )] _> E_ [ _ρ_ ( _S_ _[TV]_ _, R_ )] (6)


_whenever turnover τi exhibits cross-sectional dispersion._


_Proof._ From equations (4) and (5):


Cov( _S_ _[TV]_ _, R_ ) = _kγ ·_ Cov( _ατ_ _[−]_ [1] _, α_ ) = _kγ · E_ [ _α_ [2] _τ_ _[−]_ [1] ]

Var( _S_ _[TV]_ ) = _k_ [2] Var( _ατ_ _[−]_ [1] ) + _σζ_ [2]
Cov( _S_ _[MC]_ _, R_ ) = _kγ ·_ Var( _α_ ) = _kγσα_ [2]
Var( _S_ _[MC]_ ) = _k_ [2] _σα_ [2] [+] _[ σ]_ _ζ_ [2] _[E]_ [[] _[τ]_ [ 2][]]


For _S_ _[MC]_, the signal variance is constant. For _S_ _[TV]_, the covariance term _E_ [ _α_ [2] _τ_ _[−]_ [1] ] is
attenuated by low-turnover stocks and amplified by high-turnover stocks, while the variance
term includes Var( _ατ_ _[−]_ [1] ), which exceeds _σα_ [2] [whenever] _[ τ]_ [ has dispersion (by Jensen’s inequality]
for the convex function 1 _/τ_ ).
Therefore, the signal-to-noise ratio:


Cov [2] ( _S, R_ )
(7)
Var( _S_ )Var( _R_ )


is higher for _S_ _[MC]_ than _S_ _[TV]_ .

#### **3.5 Economic Interpretation**


Why do informed traders scale by market cap? Three mechanisms:


1. **Capacity** : Large firms can absorb large trades without excessive price impact


2. **Capital allocation** : Institutional investors allocate capital based on market cap
weights


3. **Information scale** : A 1% mispricing in a $100B firm represents $1B of value, warranting large absolute positions


In contrast, noise traders respond to liquidity (volume) for mechanical reasons: higher
volume attracts attention, facilitates execution, and signals “safe” trading.


8


### **4 Monte Carlo Validation**

#### **4.1 Simulation Design**

We implement the theoretical DGP with the following specifications:


Table 2: Monte Carlo Simulation Parameters
Parameter Symbol Value
Number of simulations _M_ 1,000
Stocks per simulation _N_ 500
Signal volatility _σα_ 0.05
Noise volatility _σζ_ 3.5
Position scaling _k_ 1.0
Log market cap mean _µ_ log _M_ 20.0
Log market cap std _σ_ log _M_ 2.0
Turnover range           - [0.05%, 1.0%]
Return sensitivity _γ_ 1.0
Idiosyncratic volatility _σϵ_ 0.03


For each of 1,000 simulations, we:


1. Generate 500 stocks with primitives drawn from specified distributions


2. Compute order flow _Di_ per equation (3)


3. Calculate returns _Ri_ = _γαi_ + _ϵi_


4. Normalize by both TV and MC methods


5. Compute correlations _ρ_ _[TV]_ = Corr( _S_ _[TV]_ _, R_ ) and _ρ_ _[MC]_ = Corr( _S_ _[MC]_ _, R_ )

#### **4.2 Main Results**


Table 3: Signal-to-Noise Ratio Comparison (1000 Monte Carlo Simulations)

Normalization Method Mean _ρ_ Std Dev Min / Max
Trading Value ( _S_ ~~_[TV]_~~ ) 0.6022 0.0261 0.5168 / 0.6794
Market Cap ( _S_ _[MC]_ ) 0.7924 0.0168 0.7358 / 0.8430
MC / TV Ratio 1.32 _×_

Paired _t_ -test: _t_ = 231.15, _p <_ 0 _._ 001***


Notes: _ρ_ denotes the correlation between normalized signal and future returns. Market capitalization
normalization achieves 1.32 _×_ higher correlation, indicating superior signal extraction. Paired _t_ -test
strongly rejects the null hypothesis of equal correlations ( _p <_ 0 _._ 001). *** denotes significance at the
1% level.


9


Table 3 presents the central finding: market capitalization normalization achieves mean
correlation of 0.7924 versus 0.6022 for trading value normalization, a 1.32 _×_ advantage. This
difference is statistically significant ( _t_ = 231 _._ 15 _, p <_ 0 _._ 001) and economically substantial.
Moreover, MC normalization exhibits lower standard deviation (0.0168 vs 0.0261), indicating more stable signal extraction across simulations. The minimum correlation for MC
(0.7358) exceeds the mean for TV (0.6022), demonstrating that MC normalization provides
uniformly superior performance.

#### **4.3 Robustness Checks**


Table 4 and Figure 1 report sensitivity analyses across three dimensions:


Table 4: Robustness Checks: Parameter Sensitivity Analysis

Test Scenario _ρTV_ _ρMC_ Ratio
**Panel A: Signal Strength (** _σα_ **)**
_σα_ = 0 _._ 01 0.177 0.138 0.78 _×_
_σα_ = 0 _._ 03 0.488 0.584 1.20 _×_
_σα_ = 0 _._ 05 (baseline) 0.604 0.793 1.31 _×_
_σα_ = 0 _._ 10 0.677 0.938 1.39 _×_
**Panel B: Noise Level (** _σζ_ **)**
_σζ_ = 1 _._ 0 0.607 0.852 1.41 _×_
_σζ_ = 3 _._ 5 (baseline) 0.602 0.792 1.32 _×_
_σζ_ = 7 _._ 0 0.577 0.658 1.14 _×_
**Panel C: Turnover Range**
Narrow (0.1–0.3%) 0.812 0.850 1.05 _×_
Medium (0.05–1%) (baseline) 0.602 0.792 1.32 _×_
Wide (0.01–2%) 0.347 0.667 1.92 _×_


Notes: Each row reports mean correlations from 200 Monte Carlo simulations. Market capitalization
normalization outperforms trading value normalization for moderate to strong signals ( _σα ≥_ 0 _._ 03). At
very weak signals ( _σα_ = 0 _._ 01), noise dominates and neither normalization performs well. The MC
advantage is particularly pronounced with wider turnover ranges (1.97 _×_ ), confirming the heteroskedasticity mitigation effect.


**Panel A** varies signal strength _σα_ . For moderate to strong signals ( _σα ≥_ 0 _._ 03), the MC
advantage ranges from 1.20 _×_ to 1.39 _×_ . At very weak signals ( _σα_ = 0 _._ 01), noise dominates
both normalizations. Stronger signals amplify the matched filter benefit.
**Panel B** varies noise level _σζ_ . Higher noise reduces both correlations but preserves MC’s
advantage. Even with extreme noise ( _σζ_ = 7 _._ 0), MC outperforms TV by 1.14 _×_ .
**Panel C** varies turnover range. This is the most revealing test: wider turnover distribution (greater heteroskedasticity) amplifies MC’s advantage to 1.92 _×_ . Narrow turnover range
reduces the advantage to 1.05 _×_, confirming that heteroskedasticity is the mechanism.
**Panel D** (Figure 1, bottom-center) varies sample size from 100 to 1,000 stocks per
simulation. The MC advantage remains stable at approximately 1.32 _×_ across all sample
sizes, confirming that our findings are not artifacts of sample size.


10


Figure 1: Robustness Checks: Parameter Sensitivity Analysis. The figure displays the stability of the MC normalization advantage across variations in signal strength (top-left), noise
level (top-center), and turnover range (top-right). The bottom row shows the MC/TV performance ratio across all simulation scenarios (bottom-left, where S=signal strength, N=noise
level, T=turnover range), sample size sensitivity (bottom-center), and mean MC advantage
by category (bottom-right).

#### **4.4 Visual Evidence**


Figure 2 shows the distribution of correlations across 1,000 simulations. The MC distribution
is right-shifted and more concentrated, reflecting both higher mean and lower variance.











Figure 2: Distribution of Signal-Return Correlations (1000 Simulations)


Figure 3 presents the mean correlations with 95% confidence intervals. The non-overlapping
intervals underscore the robustness of our finding.


11


Figure 3: Signal-to-Noise Ratio Comparison

### **5 Empirical Analysis**


This section provides comprehensive empirical validation of our matched filter hypothesis using Korean stock market data. We conduct two complementary analyses: (i) _signal_
_structure validation_, testing whether market capitalization normalization better captures the
structural properties of informed trading flow, and (ii) _return prediction analysis_, directly
testing whether _S_ _[MC]_ predicts future returns better than _S_ _[TV]_ .

#### **5.1 Data: Korean Stock Market**


To validate our theoretical predictions using real market data, we analyze institutional order
flow in the Korean stock market. We use comprehensive daily institutional order flow data
from 2020-2024, covering 2,116,122 stock-day observations across 2,570 stocks over 1,231
trading days.
The Korean market provides an ideal testbed for our hypothesis: institutional trading
data is publicly disclosed with high granularity, market structure is comparable to other
developed markets, and turnover exhibits substantial cross-sectional variation (mean 2.6%,
std 10.9%).

#### **5.2 Signal Structure Validation**


Before testing return predictability directly, we first validate that market capitalization normalization better captures the _structural properties_ of informed trading flow. Our theoretical model predicts that informed traders scale positions proportionally to market cap
( _Qinf ∝_ _α · M_ ), implying that the relationship between normalized signals and order flow
magnitude should be more robust for _S_ _[MC]_ than _S_ _[TV]_ .


**5.2.1** **Fama-MacBeth Cross-Sectional Regressions**


We test whether MC normalization better explains cross-sectional variation in informed
trading intensity using the Fama-MacBeth procedure (Fama and MacBeth, 1973). For each


12


trading day _t_, we estimate the cross-sectional regression:


log( _|Di,t|_ + _c_ ) = _β_ 0 + _β_ 1 _Si,t_ + _ϵi,t_ (8)

where _Si,t_ is either _Si,t_ _[MC]_ = _Di,t/Mi,t_ or _Si,t_ _[TV]_ = _Di,t/Vi,t_, and _c_ is a small constant. We
then compute the time-series mean of the daily co _√_ efficients _β_ [¯] 1 and test significance using the
time-series standard error with _t_ = _β_ [¯] 1 _/_ (SE( _β_ 1) _/_ _T_ ), where _T_ = 1 _,_ 231 trading days. This

approach accounts for cross-sectional correlation while avoiding computational challenges
with panel fixed effects on 2.1 million observations.


Table 5: Fama-MacBeth Regression Results: Full Daily Data (2020-2024)


MC Only TV Only Horse Race


_Dependent Variable: Log(Absolute Institutional Flow)_


_S_ _[MC]_ -0.1374***       - -0.0950***
(-16.75) (-14.07)


_S_ _[TV]_       - -0.1325*** -0.0777***
(-12.67) (-7.45)


Average _R_ [2] 0.014944 0.022152 0.028540
Total Observations 2,116,122 2,116,122 2,116,122
Trading Days 1,231 1,231 1,231
Avg Stocks/Day 1,719 1,719 1,719


_Notes_ : Fama-MacBeth procedure: daily cross-sectional regressions averaged over time. **Independent variables are**
**standardized (z-scored) within each trading day** ; coefficients represent the effect of a one standard deviation change
in the normalized signal on log absolute flow. All variables
winsorized at 0.5% and 99.5%. Time-series _t_ -statistics in
parentheses. While TV normalization exhibits a higher average _R_ [2], MC normalization demonstrates stronger statistical
significance (higher _t_ -statistic). In the horse race specification, both signals remain significant, but MC retains a larger
portion of its univariate coefficient. This table tests _signal_
_structure_ (flow magnitude relationships); see Table 8 for return prediction tests. * _p <_ 0 _._ 10, ** _p <_ 0 _._ 05, *** _p <_ 0 _._ 01.


Table 5 presents the results across 2,116,122 stock-day observations. Several findings
emerge:
**Signal robustness vs spurious correlation** : While TV normalization achieves higher
_R_ [2] = 0 _._ 0222 compared to MC’s _R_ [2] = 0 _._ 0149, the horse race reveals MC normalization captures the more robust signal. When both compete in a single regression, MC normalization
remains highly significant ( _t_ = _−_ 14 _._ 07, _p <_ 0 _._ 001) while TV normalization’s significance


13


drops substantially ( _t_ = _−_ 7 _._ 45). This pattern suggests TV’s higher _R_ [2] reflects spurious
correlation with turnover noise rather than genuine signal strength.
**Statistical significance** : Both normalizations exhibit strong statistical significance in
univariate specifications (MC: _t_ = _−_ 16 _._ 75; TV: _t_ = _−_ 12 _._ 67), consistent with 2.1 million
observations providing substantial power. However, MC normalization’s dominance in the
horse race confirms it captures the underlying information signal more reliably.
**Interpreting the negative coefficients** : The negative coefficients require careful interpretation. They indicate that stocks with higher normalized order flow (larger _D/M_ or
_D/V_ ) tend to have _lower_ absolute order flow levels _|D|_ . This is _consistent with_ our theoretical framework: small-cap stocks have relatively larger institutional positions relative to their
market cap (higher _S_ _[MC]_ ), but lower absolute dollar flow. The key finding is not the sign
of the coefficient—which reflects the mechanical inverse relationship between normalization
denominators and absolute flow—but rather that MC normalization captures this structural
relationship more robustly than TV normalization, as evidenced by its dominance in the
horse race specification. The direct test of return prediction is presented in Section 5.3.


**5.2.2** **Market Cap Subsample Analysis**


Table 6 Panel C reports results by market capitalization quintile. MC normalization’s _R_ [2]

advantage is most pronounced for small-cap stocks (MC/TV ratio = 2.38), where turnover
heterogeneity is greatest and our theoretical predictions are strongest. The advantage persists across Q2-Q4 quintiles (ratios 2.11-1.36) but disappears for the largest quintile (Q5,
ratio = 0.93), where liquid markets reduce turnover dispersion and both normalizations
perform comparably.
These patterns align precisely with our theoretical predictions: heteroskedastic turnover
effects are strongest where cross-sectional turnover variation is largest. The near-parity for
large-cap stocks suggests that when markets are sufficiently liquid and turnover is relatively
stable, the choice of normalization becomes less critical.


**5.2.3** **Robustness Checks**


We conduct three additional robustness checks to validate the temporal stability and alternative specifications of our main findings.
**Yearly subperiod analysis** (Table 6 Panel A): We estimate the Fama-MacBeth regressions separately for each year 2020-2024. MC normalization maintains statistical significance
across all years (all _|t| >_ 4), with particularly strong performance in 2020 ( _t_ = _−_ 14 _._ 74). TV
normalization is also significant in most years but exhibits more temporal variation. The
consistent significance of MC across different market conditions (including COVID volatility
in 2020, recovery in 2021-2022, and normalization in 2023-2024) confirms the robustness of
market cap normalization.
**Market regime analysis** (Table 6 Panel B): Following our theoretical framework, we
split the sample into high versus low turnover volatility regimes based on the cross-sectional
standard deviation of turnover. MC normalization performs consistently across both regimes
(high: _t_ = _−_ 11 _._ 69; low: _t_ = _−_ 4 _._ 74), while TV shows stronger performance in the high
volatility regime ( _t_ = _−_ 12 _._ 47) but weaker in low volatility ( _t_ = _−_ 2 _._ 88). This pattern suggests


14


Table 6: Robustness Checks: Temporal Stability and Market Regimes

Test Dimension N _RMC_ [2] _RTV_ [2] Ratio


**Panel A: Yearly Subperiods**
Year 2020 368,055 0.022880 0.027067 0.85 _×_
Year 2021 397,467 0.012482 0.024476 0.51 _×_
Year 2022 413,026 0.017278 0.026797 0.64 _×_
Year 2023 470,731 0.011584 0.018620 0.62 _×_
Year 2024 466,843 0.010400 0.013660 0.76 _×_


**Panel B: Market Regime Analysis**
High Turnover Volatility 383,755 0.016226 0.025519 0.64 _×_
Low Turnover Volatility 458,267 0.016139 0.023967 0.67 _×_


**Panel C: Market Cap Quintiles**
Q1 (Small) 423,225 0.074774 0.031366 2.38 _×_
Q2 423,224 0.047278 0.022444 2.11 _×_
Q3 423,225 0.030865 0.018002 1.71 _×_
Q4 423,223 0.026584 0.019616 1.36 _×_
Q5 (Large) 423,225 0.022061 0.023611 0.93 _×_


Notes: Panel A shows MC normalization maintains consistent statistical significance across all years (2020-2024), despite TV achieving
higher average _R_ [2] . Panel B demonstrates that MC normalization
provides stable performance across different market regimes. Panel
C shows MC normalization is particularly effective for small and
mid-cap stocks where turnover variation is greatest (ratio 2.38 _×_ for
Q1), with the advantage diminishing for large-cap stocks. Ratio =
_RMC_ [2] _[/R]_ _TV_ [2] [.]


MC normalization provides more stable signal extraction regardless of market conditions,
whereas TV normalization’s effectiveness varies with liquidity regimes.
**Pooled OLS specification** : As an alternative to the Fama-MacBeth procedure, we
estimate pooled OLS regressions with stock and time fixed effects. Both MC and TV normalizations remain highly significant individually (MC: _t_ = _−_ 121 _._ 00; TV: _t_ = _−_ 53 _._ 09). In
the horse race specification, MC normalization remains strongly negative ( _t_ = _−_ 109 _._ 96),
while TV normalization _reverses sign_ to positive ( _t_ = +16 _._ 83). This sign reversal suggests
that, conditional on MC normalization, any residual TV signal reflects spurious correlation
with turnover rather than genuine information content. Table 7 presents full results.
Figure 4 visualizes the core empirical findings. The left panel shows that MC normalization achieves superior _R_ [2] for return prediction. The right panel shows that TV normalization
achieves lower turnover correlation through volume scaling, while MC normalization retains
the signal structure. The horse race regression (Table 5) confirms that MC captures a more
robust signal: when both normalizations compete, MC maintains higher statistical significance.


15


Table 7: Pooled OLS with Fixed Efects: Robustness Check

MC Only TV Only Horse Race


_Dependent Variable: Log(Absolute Institutional Flow)_


_S_ _[MC]_ -133.9496***      - -146.4027***
(-121.00) (-109.96)


_S_ _[TV]_      - -0.5161*** 0.1963***
(-53.09) (16.83)


_R_ [2] (within) 0.006872 0.001330 0.007005
Stock Fixed Effects Yes Yes Yes
Time Fixed Effects Yes Yes Yes


Total Observations 2,116,122 2,116,122 2,116,122
Number of Stocks 2,570 2,570 2,570
Number of Days 1,231 1,231 1,231


_Notes_ : Panel regression with stock and time fixed effects implemented via demeaning. Standard errors clustered two-way by stock
and date (conservative adjustment applied). _t_ -statistics in parentheses. **Important** : Unlike Table 5, variables are demeaned but
_not standardized_ —coefficients are in raw units. Since _S_ _[MC]_ = _D/M_
is typically _∼_ 10 _[−]_ [4] in magnitude, the large coefficient ( _−_ 134) reflects this scale; economically, a one standard deviation change in
_S_ _[MC]_ corresponds to approximately _−_ 0 _._ 13 change in log _|D|_, comparable to Table 5. The sign reversal of _S_ _[TV]_ in the horse race
confirms that, conditional on _S_ _[MC]_, the TV signal reflects spurious correlation with turnover rather than genuine information.

        - _p <_ 0 _._ 10, ** _p <_ 0 _._ 05, *** _p <_ 0 _._ 01.

#### **5.3 Return Prediction Analysis**


The signal structure tests above validate that MC normalization better captures the scaling properties of informed trading flow. However, the central claim of our matched filter
hypothesis is that MC normalization should better _predict future returns_ . We now provide
direct evidence using Fama-MacBeth return prediction regressions.


**5.3.1** **Methodology**


For each trading day _t_, we estimate cross-sectional regressions of future returns on current
normalized signals:
_Ri,t_ + _h_ = _β_ 0 + _β_ 1 _Si,t_ + _ϵi,t_ (9)

where _Ri,t_ + _h_ is the return from day _t_ to day _t_ + _h_, and _Si,t_ is either _S_ _[MC]_ or _S_ _[TV]_ (standardized
within each day). We test three return horizons: next-day ( _h_ = 1), weekly ( _h_ = 5), and


16


Figure 4: Empirical Validation Results: Panel A shows the _R_ [2] comparison between normalizations for return prediction. Panel B shows the correlation between each normalization
and turnover. TV normalization achieves lower turnover correlation by dividing by volume,
while MC normalization retains the signal structure. The horse race regression confirms MC
captures a more robust signal component.


monthly ( _h_ = 20).


**5.3.2** **Results**


Table 8 presents strong evidence for the matched filter hypothesis. The key findings are:
**Next-day returns (** _Rt_ +1 **)** : Market capitalization normalization achieves highly significant return predictability ( _t_ = 9 _._ 65, _p <_ 0 _._ 001), while trading value normalization is only
marginally significant ( _t_ = 2 _._ 10, _p_ = 0 _._ 036). The average _R_ [2] for MC (0.29%) is twice
that of TV (0.14%). Critically, in the horse race regression, MC normalization _strengthens_
( _t_ = 10 _._ 99) while TV normalization _reverses sign_ (coefficient becomes negative, _t_ = _−_ 6 _._ 81).
This sign reversal is the empirical signature of our theoretical prediction: TV normalization captures spurious correlation with turnover that reverses once the true signal ( _S_ _[MC]_ ) is
controlled for.
**Weekly returns (** _Rt_ +5 **)** : The pattern persists at the weekly horizon. MC normalization
alone is not significant ( _t_ = 0 _._ 16), but in the horse race it becomes significant ( _t_ = 3 _._ 12) while
TV’s negative coefficient strengthens ( _t_ = _−_ 6 _._ 81). This suggests that at longer horizons, the
offsetting effects in TV normalization obscure genuine predictability that MC normalization
recovers.
**Monthly returns (** _Rt_ +20 **)** : At the monthly horizon, both normalizations show negative coefficients in univariate specifications, likely reflecting mean reversion in order flow.
However, the horse race pattern continues: MC maintains a positive (though insignificant)
coefficient while TV remains strongly negative. This asymmetry confirms that MC better
separates signal from noise across all horizons tested.


**5.3.3** **Economic Interpretation**


The sign reversal of _S_ _[TV]_ in horse race regressions—from positive (univariate) to negative
(controlling for _S_ _[MC]_ )—provides direct empirical support for our matched filter theory. The
intuition is as follows: _S_ _[TV]_ = _D/V_ conflates two effects: (i) the true signal (informed trading
intensity, which correlates positively with returns), and (ii) inverse turnover (which correlates
negatively with returns through liquidity/sentiment channels). When _S_ _[MC]_ is included, it
absorbs the true signal, leaving _S_ _[TV]_ to capture primarily the inverse turnover effect, hence


17


Table 8: Return Prediction Analysis: Fama-MacBeth Regressions


Specification


MC Only TV Only Horse Race


**Panel A: Next-Day Returns (** _Rt_ +1 **)**


_S_ _[MC]_ 0.0005*** 0.0007***
(9.65) (10.99)
_S_ _[TV]_ 0.0001** _−_ 0.0003***
(2.10) ( _−_ 6.813)


Avg. _R_ [2] 0.0029 0.0014 0.0042
Observations 2,114,332 2,114,332 2,114,332


**Panel B: Weekly Returns (** _Rt_ +5 **)**


_S_ _[MC]_ 0.0000 0.0004***
(0.16) (3.12)
_S_ _[TV]_ _−_ 0.0004*** _−_ 0.0006***
( _−_ 5.26) ( _−_ 6.813)


Avg. _R_ [2] 0.0023 0.0014 0.0035
Observations 2,107,216 2,107,216 2,107,216


**Panel C: Monthly Returns (** _Rt_ +20 **)**


_S_ _[MC]_ _−_ 0.0004** 0.0003
( _−_ 2.47) (1.43)
_S_ _[TV]_ _−_ 0.0012*** _−_ 0.0014***
( _−_ 8.84) ( _−_ 8.12)


Avg. _R_ [2] 0.0017 0.0010 0.0028
Observations 2,079,031 2,079,031 2,079,031


_Notes:_ This table reports Fama-MacBeth regression
results for return prediction. Each trading day, we
estimate cross-sectional regressions of future returns
_Ri,t_ + _h_ on normalized signals _Si,t_ . Coefficients are timeseries averages of daily estimates; _t_ -statistics (in parentheses) use Fama-MacBeth standard errors. Independent variables are standardized within each day. The
key finding: in horse race regressions, _S_ _[MC]_ maintains
positive predictive power while _S_ _[TV]_ exhibits sign reversal, consistent with the matched filter hypothesis.
Data: Korean stock market, 2020–2024 (2,570 stocks,
1,231 trading days). ***, **, * denote significance at
1%, 5%, 10%.


18


the sign reversal.
The practical implication is substantial: trading strategies using _S_ _[MC]_ rather than _S_ _[TV]_

would avoid the noise contamination that reduces return predictability. Our Monte Carlo
simulations (Section 4) predicted a 1.32 _×_ improvement in correlation (implying a 1 _._ 32 [2] _≈_
1 _._ 74 _×_ improvement in _R_ [2] ); the empirical _R_ [2] ratio (0.29%/0.14% = 2.07 _×_ ) exceeds this,
suggesting that real-world turnover heterogeneity may be even greater than our baseline
calibration.

### **6 Discussion**

#### **6.1 Reconciling Signal Extraction and Execution Cost**


A major contribution of this paper is the distinction between _Execution Logic_ and _Informa-_
_tion Logic_ :
**Execution Logic (VWAP/POV)** : Trading algorithms target a percentage of volume
( _Q/V_ ) to minimize market impact costs. This is correct for _cost minimization_ because
liquidity ( _V_ ) determines the cost of trading. The Square Root Law implies that impact
costs scale sub-linearly with participation rate.
**Information Logic (Alpha)** : The informed trader’s desired position size ( _Q_ ) is determined by their alpha ( _α_ ) and the firm’s capacity ( _M_ ). The _signal_ is embedded in the
magnitude of the demand relative to capacity, not relative to today’s fleeting liquidity.
Practitioners must decouple these two concepts. Use _V_ to estimate execution cost; use
_M_ to estimate signal strength. Conflating them by normalizing signals by _V_ leads to the
“Participation Rate Fallacy,” where a liquidity drought (low _V_ ) is misinterpreted as a highconviction signal.


_Remark_ 1 (Normalization Guidelines) _._ We emphasize that our critique applies specifically
to _signal extraction_ for alpha generation. Volume normalization remains the appropriate
choice for:


  - **Execution cost estimation** : Market impact scales with participation rate ( _Q/V_ )


  - **Flow toxicity metrics** : VPIN and related measures correctly use volume sampling


  - **Liquidity risk assessment** : Volume captures available liquidity for trade execution


The principle is: _Normalize by Volume for Cost; Normalize by Market Cap for Alpha_ .

#### **6.2 Practical Implications**


Our findings have immediate relevance for:
**High-Frequency Trading** : Algorithms that detect informed flow can improve signal
quality by 30–100% simply by changing normalization. This translates directly to profitability.
**Risk Factor Construction** : Academic studies constructing order flow factors (Chordia
et al., 2002) should reconsider normalization choices, as TV normalization may explain weak
or inconsistent factor performance.


19


**Market Microstructure Empirics** : Tests of information asymmetry, price discovery,
and liquidity provision may suffer from measurement error when using TV-normalized intensity.

#### **6.3 Universality**


While we validate using simulated data calibrated to realistic parameters, the matched filter
principle is _universal_ . Any market where informed traders scale by firm value (not daily
volume) will exhibit this pattern. This includes:


  - Equity markets (US, Europe, Asia)


  - Corporate bond markets (notional outstanding vs daily volume)


  - Cryptocurrency markets (market cap vs 24h volume)

#### **6.4 Limitations and External Validity**


Our empirical validation relies on Korean market data, which offers unique advantages including real-time investor-type classification and high retail participation. However, several
limitations merit acknowledgment:
**US Market Structure** : The US equity market differs substantially from Korea in fragmentation (13+ exchanges, dark pools), algorithmic execution (VWAP/TWAP algorithms
that slice orders to match volume profiles), and data availability (institutional flow must be
inferred from quarterly 13F filings or noisy classification algorithms). While our _theoreti-_
_cal_ results—derived from Jensen’s Inequality—hold universally, the _empirical_ magnitude of
improvement may differ.
**Intraday vs. Daily** : Our analysis focuses on daily order flow. Intraday applications
may require adjustments, as execution algorithms explicitly target volume participation rates
that could mask the underlying cap-scaled signal.
Future research should validate these findings using US institutional trading data, potentially leveraging datasets such as Abel Noser or ANcerno that provide direct observation
of institutional order flow.

#### **6.5 Extensions**


Several extensions merit exploration:
**Nonlinear filters** : Our analysis focuses on linear correlations. Machine learning approaches could exploit higher-order moments.
**Time-varying parameters** : We assume static market caps. Incorporating valuation
changes could refine the matched filter.
**Alternative normalizations** : Free float, enterprise value, or hybrid measures may offer
further improvements.
**Multiple signal sources** : Extending to multiple informed trader types with different
scaling behaviors.


20


### **7 Conclusion**

We have demonstrated that order flow normalization is not a technical detail but a fundamental aspect of signal extraction. Through theoretical modeling, extensive Monte Carlo
simulation, and empirical validation using Korean market data, we establish that market capitalization normalization acts as a matched filter for informed trading signals, consistently
outperforming trading value normalization across parameter specifications.
The mechanism is clear: informed traders scale positions by firm value (market capitalization), while noise traders respond to daily liquidity (trading volume). Normalizing
by trading volume creates heteroskedastic corruption of the true signal—the information
content is multiplied by the inverse turnover ratio, a highly volatile quantity. In contrast,
normalizing by market capitalization preserves the signal while confining turnover effects to
the noise term.
Our Monte Carlo simulations demonstrate a 1.32 _×_ improvement in correlation under
baseline parameters, extending to 1.92 _×_ when turnover heterogeneity is high. Empirical
evidence from the Korean stock market confirms these predictions through direct return
prediction tests: market capitalization normalization achieves highly significant next-day
return predictability ( _t_ = 9 _._ 65) while trading value normalization is only marginally significant ( _t_ = 2 _._ 10). The empirical _R_ [2] ratio (2.07 _×_ ) exceeds the implied Monte Carlo _R_ [2] ratio
(1 _._ 32 [2] _≈_ 1 _._ 74 _×_ ), suggesting real-world turnover heterogeneity may be even greater than our
baseline calibration. The “horse race” regression provides the definitive test: when both
normalizations compete, _S_ _[MC]_ strengthens ( _t_ = 10 _._ 99) while _S_ _[TV]_ exhibits a sign reversal
( _t_ = _−_ 6 _._ 81), confirming it primarily captures liquidity-driven noise rather than fundamental
information.
These findings challenge conventional practices in market microstructure research and
have immediate implications for:


  - **Trading strategies** : Refactoring order imbalance alphas to use market cap normalization could yield 30% or greater Sharpe ratio improvements


  - **Risk factor construction** : Existing order flow factors may suffer from heteroskedastic contamination that our approach eliminates


  - **Empirical methodology** : Tests of information asymmetry and price discovery should
reconsider normalization choices


The simplicity of our prescription—divide by market cap, not trading volume—belies its
substantial impact on signal quality. In the quest for signal in a noisy market, the denominator matters as much as the numerator. Market capitalization is the correct denominator.
Future research should prioritize cross-market validation using US institutional trading
data (e.g., ANcerno or 13F-based measures), explore nonlinear extensions using machine
learning, and integrate time-varying market capitalization dynamics.

### **Disclosure Statement**


The author reports there are no competing interests to declare.


21


### **References**

Yakov Amihud. Illiquidity and stock returns: cross-section and time-series effects. _Jour-_
_nal of Financial Markets_, 5(1):31–56, 2002. ISSN 1386-4181. doi: https://doi.
org/10.1016/S1386-4181(01)00024-6. URL `[https://www.sciencedirect.com/science/](https://www.sciencedirect.com/science/article/pii/S1386418101000246)`
`[article/pii/S1386418101000246](https://www.sciencedirect.com/science/article/pii/S1386418101000246)` .


Snehal Banerjee and Ilan Kremer. Disagreement and learning: Dynamic patterns of
trade. _The Journal of Finance_, 65(4):1269–1302, 2010. doi: https://doi.org/10.1111/j.
1540-6261.2010.01570.x. URL `[https://onlinelibrary.wiley.com/doi/abs/10.1111/](https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1540-6261.2010.01570.x)`
`[j.1540-6261.2010.01570.x](https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1540-6261.2010.01570.x)` .


Alexander Barinov. Turnover: Liquidity or uncertainty? _Management Science_, 60(10):2478–
2495, 2014. doi: 10.1287/mnsc.2014.1913. URL `[https://doi.org/10.1287/mnsc.2014.](https://doi.org/10.1287/mnsc.2014.1913)`
`[1913](https://doi.org/10.1287/mnsc.2014.1913)` .


Alessandro Beber, Michael W. Brandt, and Kenneth A. Kavajecz. What does equity sector
orderflow tell us about the economy? _The Review of Financial Studies_, 24(11):3688–3730,
08 2011. ISSN 0893-9454. doi: 10.1093/rfs/hhr067. URL `[https://doi.org/10.1093/](https://doi.org/10.1093/rfs/hhr067)`
`[rfs/hhr067](https://doi.org/10.1093/rfs/hhr067)` .


John Y. Campbell, Andrew W. Lo, and A. Craig MacKinlay. _The Econometrics of Financial_
_Markets_ . Princeton University Press, Princeton, NJ, 1997.


John Y. Campbell, Tarun Ramadorai, and Allie Schwartz. Caught on tape: Institutional
trading, stock returns, and earnings announcements. _Journal of Financial Economics_,
92(1):66–91, 2009. ISSN 0304-405X. doi: https://doi.org/10.1016/j.jfineco.2008.03.006.
URL `[https://www.sciencedirect.com/science/article/pii/S0304405X09000026](https://www.sciencedirect.com/science/article/pii/S0304405X09000026)` .


Tarun Chordia, Richard Roll, and Avanidhar Subrahmanyam. Order imbalance, liquidity, and market returns. _Journal of Financial Economics_, 65(1):111–130, 2002. ISSN
0304-405X. doi: https://doi.org/10.1016/S0304-405X(02)00136-8. URL `[https://www.](https://www.sciencedirect.com/science/article/pii/S0304405X02001368)`
`[sciencedirect.com/science/article/pii/S0304405X02001368](https://www.sciencedirect.com/science/article/pii/S0304405X02001368)` .


Vinay T. Datar, Narayan Y. Naik, and Robert Radcliffe. Liquidity and stock returns: An
alternative test. _Journal of Financial Markets_, 1(2):203–219, 1998. ISSN 1386-4181. doi:
https://doi.org/10.1016/S1386-4181(97)00004-9. URL `[https://www.sciencedirect.](https://www.sciencedirect.com/science/article/pii/S1386418197000049)`
`[com/science/article/pii/S1386418197000049](https://www.sciencedirect.com/science/article/pii/S1386418197000049)` .


David Easley, Nicholas M. Kiefer, Maureen O’Hara, and Joseph B. Paperman. Liquidity, information, and infrequently traded stocks. _The Journal of Finance_, 51(4):
1405–1436, 1996. doi: https://doi.org/10.1111/j.1540-6261.1996.tb04074.x. URL `[https:](https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1540-6261.1996.tb04074.x)`
`[//onlinelibrary.wiley.com/doi/abs/10.1111/j.1540-6261.1996.tb04074.x](https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1540-6261.1996.tb04074.x)` .


David Easley, Marcos M. L´opez de Prado, and Maureen O’Hara. Flow toxicity and liquidity
in a high-frequency world. _The Review of Financial Studies_, 25(5):1457–1493, 03 2012.
ISSN 0893-9454. doi: 10.1093/rfs/hhs053. URL `[https://doi.org/10.1093/rfs/hhs053](https://doi.org/10.1093/rfs/hhs053)` .


22


Eugene F. Fama and Kenneth R. French. Common risk factors in the returns on stocks
and bonds. _Journal of Financial Economics_, 33(1):3–56, 1993. ISSN 0304-405X. doi:
https://doi.org/10.1016/0304-405X(93)90023-5. URL `[https://www.sciencedirect.](https://www.sciencedirect.com/science/article/pii/0304405X93900235)`
`[com/science/article/pii/0304405X93900235](https://www.sciencedirect.com/science/article/pii/0304405X93900235)` .


Eugene F. Fama and James D. MacBeth. Risk, return, and equilibrium: Empirical tests.
_Journal of Political Economy_, 81(3):607–636, 1973.


Xavier Gabaix, Parameswaran Gopikrishnan, Vasiliki Plerou, and H Eugene Stanley. A
theory of power-law distributions in financial market fluctuations. _Nature_, 423(6937):
267–270, 2003.


Lawrence R. Glosten and Paul R. Milgrom. Bid, ask and transaction prices in a specialist
market with heterogeneously informed traders. _Journal of Financial Economics_, 14(1):71–
100, 1985. ISSN 0304-405X. doi: https://doi.org/10.1016/0304-405X(85)90044-3. URL
`[https://www.sciencedirect.com/science/article/pii/0304405X85900443](https://www.sciencedirect.com/science/article/pii/0304405X85900443)` .


Joel Hasbrouck. Measuring the information content of stock trades. _The Journal of_
_Finance_, 46(1):179–207, 1991. doi: https://doi.org/10.1111/j.1540-6261.1991.tb03749.
x. URL `[https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1540-6261.1991.](https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1540-6261.1991.tb03749.x)`
`[tb03749.x](https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1540-6261.1991.tb03749.x)` .


Albert S. Kyle. Continuous auctions and insider trading. _Econometrica_, 53(6):1315–1335,
1985. ISSN 00129682, 14680262. URL `[http://www.jstor.org/stable/1913210](http://www.jstor.org/stable/1913210)` .


Jonathan Lewellen. Institutional investors and the limits of arbitrage. _Journal of Finan-_
_cial Economics_, 102(1):62–80, 2011. ISSN 0304-405X. doi: https://doi.org/10.1016/
j.jfineco.2011.05.012. URL `[https://www.sciencedirect.com/science/article/pii/](https://www.sciencedirect.com/science/article/pii/S0304405X11001358)`
`[S0304405X11001358](https://www.sciencedirect.com/science/article/pii/S0304405X11001358)` .


Lubos Pastor and Robert F. Stambaugh. Liquidity risk and expected stock returns. _Journal_
_of Political Economy_, 111(3):642–685, 2003.


Nicolo Torre. Barra market impact model handbook. _BARRA Inc., Berkeley_, 208, 1997.


G. Turin. An introduction to matched filters. _IRE Transactions on Information Theory_, 6
(3):311–329, 1960. doi: 10.1109/TIT.1960.1057571.

### **A Mathematical Derivation of Signal-to-Noise Ratios**


This appendix provides the complete mathematical derivation establishing the superiority of
market capitalization normalization ( _S_ _[MC]_ ) over trading value normalization ( _S_ _[TV]_ ) in terms
of signal-to-noise ratio.


23


#### **A.1 Definitions and Setup**

Recall the signal extraction framework from Section 3. Observed order flow is:


_Di_ = _kαiMi_ + _ζiVi_ (10)


where _αi ∼_ _N_ (0 _, σα_ [2] [) is the latent information signal,] _[ ζ][i]_ _[∼]_ _[N]_ [(0] _[, σ]_ _ζ_ [2][) is noise,] _[ M][i]_ [ is market]
capitalization, and _Vi_ = _τiMi_ is trading volume with turnover rate _τi_ .
Returns are generated by:
_Ri_ = _γαi_ + _ϵi_ (11)

where _ϵi ∼_ _N_ (0 _, σϵ_ [2][) is idiosyncratic return noise, independent of] _[ α][i]_ [,] _[ ζ][i]_ [, and] _[ τ][i]_ [.]
The Signal-to-Noise Ratio (SNR) is defined as:


Cov [2] ( _S, R_ )
SNR( _S_ ) = (12)
Var( _S_ ) _·_ Var( _R_ )


Higher SNR implies stronger predictive power of the normalized signal _S_ for future returns
_R_ .

#### A.2 Market Capitalization Normalization ( S [MC] )


The market cap normalized signal is:

_Si_ _[MC]_ = _M_ _[D][i]_ _i_ = _kαi_ + _ζiτi_ (13)


**Covariance with returns:**


Cov( _S_ _[MC]_ _, R_ ) = _E_ [( _kα_ + _ζτ_ )( _γα_ + _ϵ_ )] _−_ _E_ [ _kα_ + _ζτ_ ] _E_ [ _γα_ + _ϵ_ ]
= _E_ [ _kγα_ [2] + _kαϵ_ + _γζτα_ + _ζτϵ_ ]
= _kγE_ [ _α_ [2] ] (by independence)
= _kγσα_ [2] (14)


**Variance of signal:**


Var( _S_ _[MC]_ ) = Var( _kα_ + _ζτ_ )
= _k_ [2] Var( _α_ ) + Var( _ζτ_ ) + 2 _k_ Cov( _α, ζτ_ )
= _k_ [2] _σα_ [2] [+] _[ E]_ [[] _[ζ]_ [2] _[τ]_ [ 2][]] (by independence)
= _k_ [2] _σα_ [2] [+] _[ σ]_ _ζ_ [2] _[E]_ [[] _[τ]_ [ 2][]] (15)



**SNR for** _S_ _[MC]_ **:**


where _σR_ [2] [=] _[ γ]_ [2] _[σ]_ _α_ [2] [+] _[ σ]_ _ϵ_ [2][.]



( _kγσα_ [2] [)][2]
SNR _MC_ = (16)

( _k_ [2] _σα_ [2] [+] _[ σ]_ _ζ_ [2] _[E]_ [[] _[τ]_ [ 2][])] _[ ·][ σ]_ _R_ [2]


24


#### A.3 Trading Value Normalization ( S [TV] )

The trading value normalized signal is:

_Si_ _[TV]_ = _[D]_ _Vi_ _[i]_ = _kαiτi_ _[−]_ [1] + _ζi_ (17)


**Covariance with returns:**


Cov( _S_ _[TV]_ _, R_ ) = _E_ [( _kατ_ _[−]_ [1] + _ζ_ )( _γα_ + _ϵ_ )]
= _kγE_ [ _α_ [2] _τ_ _[−]_ [1] ] (18)


Under the assumption that _α_ and _τ_ are independent:


Cov( _S_ _[TV]_ _, R_ ) = _kγσα_ [2] _[E]_ [[] _[τ][ −]_ [1][]] (19)


**Variance of signal:**


Var( _S_ _[TV]_ ) = _k_ [2] Var( _ατ_ _[−]_ [1] ) + _σζ_ [2]
= _k_ [2][ �] _E_ [ _α_ [2] _τ_ _[−]_ [2] ] _−_ ( _E_ [ _ατ_ _[−]_ [1] ]) [2][�] + _σζ_ [2] (20)


With independence of _α_ and _τ_ :


Var( _S_ _[TV]_ ) = _k_ [2] _σα_ [2] _[E]_ [[] _[τ][ −]_ [2][] +] _[ σ]_ _ζ_ [2] (21)



**SNR for** _S_ _[TV]_ **:**



( _kγσα_ [2] _[E]_ [[] _[τ][ −]_ [1][])][2]
SNR _TV_ = (22)

( _k_ [2] _σα_ [2] _[E]_ [[] _[τ][ −]_ [2][] +] _[ σ]_ _ζ_ [2][)] _[ ·][ σ]_ _R_ [2]


#### **A.4 Comparison of SNR**

To compare SNR _MC_ and SNR _TV_, we examine the ratio:


SNR _MC_ 1 _α_ _[E]_ [[] _[τ][ −]_ [2][] +] _[ σ]_ _ζ_ [2]

SNR _TV_ = ( _E_ [ _τ_ _[−]_ [1] ]) [2] _[·][ k]_ _k_ [2][2] _[σ]_ _σ_ [2] _α_ [2] [+] _[ σ]_ _ζ_ [2] _[E]_ [[] _[τ]_ [ 2][]] (23)


**Key insight (Jensen’s Inequality):** For the convex function _f_ ( _x_ ) = 1 _/x_ :


_E_ [ _τ_ _[−]_ [1] ] _≥_ ( _E_ [ _τ_ ]) _[−]_ [1] (24)


with strict inequality when _τ_ has dispersion.
Similarly, for the convex function _g_ ( _x_ ) = 1 _/x_ [2] :


_E_ [ _τ_ _[−]_ [2] ] _≥_ ( _E_ [ _τ_ ]) _[−]_ [2] (25)


These inequalities imply that the variance term in _S_ _[TV]_ (containing _E_ [ _τ_ _[−]_ [2] ]) is inflated
relative to what would occur with constant turnover. This inflation affects the denominator
of SNR _TV_, reducing it relative to SNR _MC_ .
**Numerical illustration:** Consider turnover uniformly distributed on [0 _._ 0005 _,_ 0 _._ 01] (0.05%
to 1% daily), matching the Monte Carlo simulation parameters in Table 2.


25


  - _E_ [ _τ_ ] = 0 _._ 00525


  - _E_ [ _τ_ [2] ] _≈_ 3 _._ 5 _×_ 10 _[−]_ [5]


  - _E_ [ _τ_ _[−]_ [1] ] _≈_ 315 _._ 3


  - _E_ [ _τ_ _[−]_ [2] ] = 200 _,_ 000


The key observation: _E_ [ _τ_ _[−]_ [2] ] is orders of magnitude larger than ( _E_ [ _τ_ ]) _[−]_ [2] _≈_ 36 _,_ 281,
demonstrating the severe variance inflation in _S_ _[TV]_ .

#### **A.5 Conclusion**


The mathematical analysis confirms that:


1. _S_ _[MC]_ preserves the signal ( _kαi_ ) without distortion


2. _S_ _[TV]_ multiplies the signal by _τi_ _[−]_ [1], introducing variance inflation


3. The variance inflation in _S_ _[TV]_ (from _E_ [ _τ_ _[−]_ [2] ]) exceeds the noise scaling in _S_ _[MC]_ (from
_E_ [ _τ_ [2] ])


4. Therefore, SNR _MC >_ SNR _TV_ whenever turnover exhibits cross-sectional dispersion


This completes the proof that market capitalization normalization is the optimal (matched)
filter for informed trading signals.


26


