## Trading with market resistance and concave price impact

Youssef O. Chahdi [1], Nathan De Carvalho [2], and Gr´egoire Szymanski [3]


1MICS, CentraleSup´elec, `youssef.ouazzani-chahdi@centralesupelec.fr`
2LPSM, Universit´e Paris Cit´e, `decarvalho@lpsm.paris`
3DMATH, Universit´e du Luxembourg, `gregoire.szymanski@uni.lu`


January 7, 2026


**Abstract**


We consider an optimal trading problem under a market impact model with endogenous

market resistance generated by a sophisticated trader who (partially) detects metaorders and

trades against them to exploit price overreactions induced by the order flow. The model fea
tures a concave transient impact driven by a power-law propagator with a resistance term re
sponding to the trader’s rate via a fixed-point equation involving a general resistance function.

We derive a (non)linear stochastic Fredholm equation as the first-order optimality condition

satisfied by optimal trading strategies. Existence and uniqueness of the optimal control are

established when the resistance function is linear, and an existence result is obtained when it is

strictly convex using coercivity and weak lower semicontinuity of the associated profit-and-loss

functional. We also propose an iterative scheme to solve the nonlinear stochastic Fredholm

equation and prove an exponential convergence rate. Numerical experiments confirm this

behavior and illustrate optimal round-trip strategies under “buy” signals with various decay

profiles and different market resistance specifications.


**Keywords:** Optimal trading, market resistance, concave market impact, propagator model,
power-law decay, square root-law, Fredholm equations.


**Mathematics Subject Classification (2020):** 91G08, 46N10, 60H30, 91G80.


**JEL Classification:** C02, C61, C63, G11, G14.

### **1 Introduction**


A central feature of modern financial markets is _market impact_, that is, the empirically observed
positive correlation between the sign of a sizable incoming market order and the subsequent price
change. Market impact plays a crucial role in execution costs, risk management, and market design; see, for instance, Almgren et al. [6], Freyre-Sanders et al. [21], Hey et al. [24], Robert et al.

[34], and Bouchaud et al. [14]. Modeling this phenomenon is particularly relevant when devising
strategies for executing _metaorders_ —large transactions placed by institutional traders and implemented through a sequence of smaller child orders over a given time horizon. The presence of


1


market impact has long been recognized as a fundamental feature of market microstructure, and
understanding its form is essential from both empirical and theoretical perspectives.


Measuring market impact is inherently challenging due to its noisy nature. Statistical studies
therefore tend to focus on the execution of metaorders, which induces a persistent liquidity imbalance and generates price moves that can be identified statistically. However, during the execution
of any given metaorder, numerous other trades occur simultaneously, contributing additional noise.
Careful statistical procedures and averaging over many metaorders help to filter out part of this
noise, allowing some universal properties of market impact to emerge; see, for example, Almgren
et al. [6], Bacry et al. [7], Bershova and Rakhlin [11], and Bucci et al. [15]. Numerous empirical
studies document that prices react mechanically during the execution of a metaorder, exhibiting
a concave dependence on traded volume that peaks at the end of the metaorder—a phenomenon
known as the _square-root law_ —followed by a convex relaxation phase; see Lillo et al. [30], Hopman

[26], Almgren et al. [6], Bershova and Rakhlin [11], Gatheral [23], Moro et al. [31], Bouchaud et al.

[14], Kyle and Obizhaeva [28], and Sato and Kanazawa [35]. This square-root dependence, however, primarily holds for large traded volumes, while the impact of small orders is approximately
linear in volume, as shown in Bucci et al. [15]. To capture this dual behavior, Benzaquen and
Bouchaud [9] propose the market impact model



ˆ _Qt_
_MI_ p _Qt_ q « _cσ_

_V_



˙1{2Fˆ _Qt_

_V_



˙

_,_



where _c_ is a constant of order 1, _σ_ denotes the daily volatility, _V_ the typical daily traded volume, _Qt_
the executed volume of the metaorder at time _t_, and F a monotone function satisfying Fp _x_ q « [?] ~~_x_~~
as _x_ Ñ 0 and Fp _x_ q Ñ _a_ as _x_ Ñ 8 for some _a_ ą 0.


On the one hand, several theoretical frameworks have been developed to rationalize these empirical
findings, ranging from latent order book models, such as those of T´oth et al. [38] and Donier et al.

[18], to equilibrium models with strategic traders; see Gabaix et al. [22]. More recently, the impact
of limit orders has also been investigated, see Chahdi et al. [16]. A notable recent contribution
is due to Durin et al. [20], who introduce a model with informed traders. The key idea is that
certain sophisticated agents can detect the presence of a metaorder and infer its effect on the observed price. Their framework distinguishes between the true price of the asset, which excludes the
market’s overreaction to the metaorder, and the observed price, which incorporates the mechanical
impact of the metaorder. By trading strategically against the detected order flow, informed traders
generate a form of _market resistance_ that alters the shape of the impact curve. Their analysis leads
to two square-root laws of market impact—one in time and one in participation rate—providing a
microstructural foundation for well-established empirical results and offering a refined perspective
on how informed liquidity provision affects price formation.


On the other hand, a substantial body of literature aims to formalize the connection between
reduced-form market impact models _I_ _[X]_ and price features such as signals or volatility, with the
goal of deriving trading strategies _X_ that minimize execution costs. In the seminal work of Almgren
et al. [6], the execution cost of a trading strategy combines temporary and permanent impact terms
that shift the asset price linearly with the total traded volume. The trader’s objective is then to
minimize the expected cost and risk of liquidation over a finite horizon, typically expressed through


2


a mean–variance functional. A key refinement concerns the transient nature of impact, whereby
the observed asset price is modeled as the convolution of past order flow with a decaying kernel
_G_ - a formulation known as the _linear propagator_, introduced in discrete time by Bouchaud et al.

[12]. In continuous time, the impacted price _S_ _[X]_ is written as


ż
_t_
_St_ _[X]_ [“] _[ S]_ [0] [`] _[ I]_ _t_ _[X]_ _[,]_ _It_ _[X]_ :“ _G_ p _t_ ´ _s_ q d _Xs,_ _t_ ě 0 _,_ (1)

0


where _X_ denotes the signed traded volume. The kernel _G_ governs how the impact of past trades
decays over time: an exponential decay `a la Obizhaeva and Wang [33] corresponds to short memory,
whereas power-law kernels, as in the framework of Abi Jaber and Neuman [1], capture long-lasting
effects and are more consistent with empirical propagator estimates; see Bouchaud et al. [13] and
Donier et al. [18]. A central concern for such models is ensuring financial well-posedness, meaning
that the impact model itself cannot be exploited to generate positive profits. Gatheral [23] showed
that this requirement is equivalent to the positive semi-definiteness of the kernel _G_, yielding the
so-called “no-dynamic-arbitrage” condition.


Building on the optimal execution framework with linear price impact, recent works have formulated increasingly general _optimal trading problems_ of the form


„ ż ȷ
_T_
sup E p _αt_ ´ _It_ _[X]_ [q][ d] _[X][t]_ [`] _[ M]_ [p] _[X]_ [q] _,_ (2)
_u_ PA 0


where _α_ captures stochastic signals, _M_ encodes soft constraints and risk-aversion penalties, and
A denotes the set of admissible trading strategies. For instance, Abi Jaber et al. [3] extend the
linear propagator framework to incorporate linear functional constraints (e.g., no-shorting or nobuying constraints, stochastic stop-trading rules), demonstrating that such constraints can be
handled within a non-Markovian continuous-time model while preserving numerical tractability.
To account for the concave nature of price impact, Alfonsi et al. [5] introduce a nonlinear impact
function applied to exponentially decaying kernels, extending the model of Obizhaeva and Wang

[33], and Hey et al. [25] derive explicit optimal inventories in this setting under general price signals. Building on these results, Abi Jaber et al. [4] propose a general nonlinear propagator model
formulated in terms of the trading rate, which naturally encompasses nonlinear impact functions
as well as power-law decay, and develop numerical methods to compute optimal strategies.


The goal of this paper is to study optimal trading strategies in a market impact setting that incorporates market resistance, following the microstructural insights of Durin et al. [20]. Leveraging
the techniques developed in Abi Jaber et al. [4], we first establish theoretical results ensuring
the well-posedness of the problem, and then derive a first-order optimality condition expressed
as a nonlinear stochastic Fredholm equation. This characterization enables the use of numerical
methods based on Nystr¨om approximations and Fredholm operator inversion, through which we
compute optimal trading strategies in practice.


The remainder of the paper is organized as follows. Section 2 introduces market resistance through
a simple game-theoretic model and presents the market impact framework of Durin et al. [20] together with its microstructural foundations. Section 3 formulates the corresponding optimal trading problem, establishes the main existence results, and derives the associated first-order optimality


3


condition as a (non)linear stochastic Fredholm equation. Section 4 then presents the numerical
scheme used to solve this equation and illustrates the resulting optimal round trips in the presence
of stochastic “buy” signals.

### **Notations**


We fix a finite time horizon _T_ ą 0 and a filtered probability space pΩ _,_ F _,_ pF _t_ q _t_ Pr0 _,T_ s _,_ Pq satisfying
the usual conditions. We denote by d _t_ the Lebesgue measure on the Borel _σ_ -algebra Bpr0 _, T_ sq,
and by d _t_ b P the product measure on the _σ_ -algebra Bpr0 _, T_ sq b F. For all _p_ ě 1, we introduce the
standard Banach spaces


" „ ż ȷ      _T_
L _[p]_ :“ _f_ : r0 _, T_ s ˆ Ω Ñ R progressively measurable : E | _ft_ | _[p]_ d _t_ ă 8 _,_

0


and, for _p_ “ 2, we equip L [2] with the inner product


„ ż ȷ
_T_
x _f, g_ y :“ E _ftgt_ d _t_ _,_ _f, g_ P L [2] _,_

0


which makes it a Hilbert space with associated norm } _f_ } :“ ~~a~~ x _f, f_ y. Similarly, we denote by

_L_ _[p]_, _p_ ě 1, the standard Banach spaces with respect to the Lebesgue measure. For _u_ P L [1] and
_t_ P r0 _, T_ s, we denote by E _tu_ the conditional expectation of _u_ with respect to the _σ_ -algebra F _t_ .

### **2 Inception: a sophisticated trader as a market resistance**


**2.1** **A two-player toy model**


Consider a market with a risky asset and two traders, Alice and Bob, observing each other’s
decisions, with the following motivations:


1. Alice wants to trade the risky asset following her market signal _α_,


2. Bob distrusts Alice’s signal and seeks only to profit by trading against her flow; his orders
create a resistance flow that opposes her impact.


Denoting by _u_ _[A]_ _, u_ _[B]_ the respective trading rates of Alice and Bob, assume they both suffer trading
costs linear in the sum of their trading rates _u_ :“ _u_ _[A]_ ` _u_ _[B]_, following the linear propagator model
(1) with instantaneous slippage as in [1]. Formally, we write


_I_ _[u]_ :“ [1]

2 _[u]_ [ `] **[ G]** _[u,]_

şwhere _t_ _I_ _[u]_ is the aggregated market impact from both Alice’s and Bob’s trades, and p **G** _u_ q _t_ :“
0 _[G]_ [p] _[t, s]_ [q] _[u][s]_ [d] _[s]_ [ captures the transient nature of market impact via the kernel] _[ G]_ [. Their respective]
PnL functionals are given by



„ ż
_T_
J _[A]_ p _u_ _[A]_ q :“ E

0



ȷ
` _αt_ _[A]_ [p] _[u][B]_ [q ´] _[ I]_ _t_ _[u][A]_ ˘ _u_ _[A]_ _t_ [d] _[t]_ _,_


4


„ ż
_T_
J _[B]_ p _u_ _[B]_ q :“ E

0



ȷ
` _αt_ _[B]_ [p] _[u][A]_ [q ´] _[ I]_ _t_ _[u][B]_ ˘ _u_ _[B]_ _t_ [d] _[t]_ _,_



where Alice’s and Bob’s respective effective signals _α_ _[A]_ _, α_ _[B]_ are given by



_α_ _[A]_ p _u_ _[B]_ q :“ _α_ ´ [1]




[1] and _α_ _[B]_ p _u_ _[A]_ q :“ ´ [1]

2 _[u][B]_ [ ´] **[ G]** _[u][B][,]_ 2



2 _[u][A]_ [ ´] **[ G]** _[u][A][.]_



The main question is: can we find a couple of strategies p _u_ ˆ _[A]_ _,_ ˆ _u_ _[B]_ q that maximizes J _[A]_ and J _[B]_ respectively?


Applying [2, Proposition 5.1], the first-order conditions for Alice’s and Bob’s trading problems
write respectively


_u_ _[A]_ “ p **id** ´ **B** q [´][1] _a_ _[α][A]_ [p] _[u][B]_ [q] _,_ and _u_ _[B]_ “ p **id** ´ **B** q [´][1] _a_ _[α][B]_ [p] _[u][A]_ [q] _,_


where the operator **B** as well as the processes _a_ _[α][A]_ [p] _[u][B]_ [q], _a_ _[α][B]_ [p] _[u][A]_ [q] are explicitly given by


_a_ _[α]_ _t_ [:][“] _[ α][t]_ [´ x][1] t _t_ ă _._ u _[G]_ [p] _[., t]_ [q] _[,]_ **[ D]** [´] _t_ [1][1] t _t_ ă _._ u [E] _[t]_ [r] _[α][.]_ [sy] _L_ [2] _[,]_ _α_ P L [2]

_B_ p _t, s_ q :“ 1t _s_ ă _t_ upx1t _t_ ă _._ u _G_ p _., t_ q _,_ **D** [´] _t_ [1][1] t _t_ ă _._ u _[G]_ [p] _[., s]_ [qy] _L_ [2][ ´] _[ G]_ [p] _[t, s]_ [qq] _[,]_

**D** _t_ :“ **id** ` **G** _t_ ` p **G** _t_ q [˚] _,_ _Gt_ p _s, r_ q :“ _G_ p _s, r_ q1 _r_ ě _t,_ _t_ P r0 _, T_ s _._


Now injecting the definition of _u_ _[A]_ into that of _u_ _[B]_ yields the following fixed-point equation for
Bob’s trading rate _u_ _[B]_

_u_ _[B]_ “ p **id** ´ **B** q [´][1] _a_ _[α][B]_ [pp] **[id]** [´] **[B]** [q][´][1] _[a][αA]_ [p] _[uB]_ [q][q] _._ (3)


Therefore, if there is a ˆ _u_ _[B]_ that satisfies (3), setting


_u_ ˆ _[A]_ “ p **id** ´ **B** q [´][1] _a_ _[α][A]_ [p] _[u]_ [ˆ] _[B]_ [q]


yields a couple p _u_ ˆ _[A]_ _,_ ˆ _u_ _[B]_ q that maximizes J _[A]_ and J _[B]_ respectively. Finally, denoting by ˆ _r_ _[B]_ :“ ´ _u_ ˆ _[B]_

the resistance induced by Bob’s trades, Alice’s optimal PnL rewrites as follows



„ ż
_T_
J _[A]_ p _u_ ˆ _[A]_ q “ E

0



ȷ

` _α_ ´ [1] ˘ _u_ ˆ _[A]_ _t_ [d] _[t]_ _,_

2 [p] _[u]_ [ˆ] _[A]_ [ ´][ ˆ] _[r][B]_ [q ´] **[ G]** [p] _[u]_ [ˆ] _[A]_ [ ´][ ˆ] _[r][B]_ [q]



p **id** ´ **B** q [´][1] _a_ _[αA]_ [p´] _[rB]_ [ˆ] [q][˘]
_r_ ˆ _[B]_ “ ´p **id** ´ **B** q [´][1] _a_ _[α][B]_ [`] _,_


and this simple two-player game setting indeed motivates the introduction of a market resistance
caused by the presence of an informed trader, and solution to a fixed-point equation.


**2.2** **A general market resistance model**


Starting again from the linear propagator framework (1), consider the following impact kernel
specification
_G_ p _t_ q :“ _κ_ 8 ` _Gλ,ν_ p _t_ q _,_ _t_ ą 0 _,_ (4)


which combines a permanent component proportional to _κ_ 8 ě 0 capturing the trader’s contribution
to the long-term fundamental value of the asset, and a power-law decaying kernel


ˆ 1 ˙
_Gλ,ν_ p _t_ q :“ _λt_ _[ν]_ [´][1] _,_ _λ_ ą 0 _,_ _ν_ P _,_ (5)

2 _[,]_ [ 1]


5


reproducing the transient long-memory price impact of trades empirically observed in order flow,
see Chapter 13.2.1 from [14] and references therein. _G_ is positive semi-definite, which ensures the
absence of dynamic price manipulation and rules out profitable round trips [23]. Although we focus
on specification (4) for concreteness and interpretation, the framework extends naturally to other
admissible kernels, such as completely monotone kernels or sums of exponentials, which have also
been proposed in the literature to capture different impact decay patterns, see for instance [4].


ş _t_
A key implication is that an impact of the form 0 _[G]_ [p] _[t]_ [ ´] _[ s]_ [q][ d] _[X][s]_ [, with] _[ G]_ [ given by (4), overreacts at]
short horizons: for any finite _t_ ą 0, one has _G_ p _t_ q ą lim _s_ Ñ8 _G_ p _s_ q “ _κ_ 8. In economic terms, prices
initially move more than what is justified by the long-run information content of the trader’s order
flow. This transient overshooting creates a temporary mispricing between the observed market
price and the trader’s contribution to the long-term efficient long-term price, which is considered
a temporary price signal denoted by _α_ _[r]_ such that



ż
_t_
_αt_ _[r]_ [:][“]

0



ż
` _G_ p _t_ ´ _s_ q ´ _G_ p8q˘` _us_ ´ _rs_ _[u]_ ˘ d _s_ “ _t_ _Gλ,ν_ p _t_ ´ _s_ q` _us_ ´ _rs_ _[u]_ ˘ d _s._ (6)

0



In classical linear propagator models, _α_ _[r]_ is purely mechanical and is not acted upon. A key
contribution of Durin et al. [20] is to formulate an endogenous correction to such mispricing caused
by the trader’s strategy _u_ by introducing a continuous-time market resistance _r_ _[u]_, generated by
sophisticated traders. These agents partially detect the presence of the trader’s metaorder, infer the
transient component of its impact [37, 39], and trade against it to benefit from _α_ _[r]_ . Their activity
produces an opposing flow that dampens impact dynamically, rather than letting prices passively
relax through the kernel _G_ . In their framework, the pathwise market impact of a metaorder with
ş _t_
execution strategy _u_ at date _t_ ě 0, meaning that _Xt_ “ 0 _[u][s]_ [ d] _[s]_ [, is given by]


ż
_MI_ p _u, t_ q “ _t_ _G_ p _t_ ´ _s_ q` _us_ ´ _rs_ _[u]_ ˘ d _s,_ (7)

0


where _r_ _[u]_ represents the endogenous reaction rate of sophisticated traders. This reaction satisfies
the following fixed-point equation


ˆż ˙
_rt_ _[u]_ [“][ U][p] _[α]_ _t_ _[r]_ [q] _[,]_ _i.e., rt_ _[u]_ [“][ U] _t_ _Gλ,ν_ p _t_ ´ _s_ q` _us_ ´ _rs_ _[u]_ ˘ d _s_ _,_ (8)

0


for some increasing function U : R Ñ R. A natural specification for U can be derived heuristically.
Assume that price impact follows a square-root law, that is, if the sophisticated trader invests an
amount _x_ proportional to this signal _α_ _[r]_, the expected gain is _α_ _[r]_ _x_, while the associated impact
cost is _k_ [?] ~~_x_~~ _x_ for some _k_ ą 0. The expected profit, _α_ _[r]_ _x_ ´ _k_ [?] ~~_x_~~ _x_, is maximized for _x_ “ _k_ [˜] p _α_ _[r]_ q [2]

with _k_ [˜] ą 0, which motivates taking Up _x_ q in (8) proportional to _x_ [2] . This particular choice is not
required in the remainder of the paper.


Importantly, the resistance mechanism is backed by a precise microstructural foundation where
it can be derived from a high-frequency model in which market orders follow self-exciting point
processes and prices are set as conditional expectations of future order flow. When informed agents
partially filter out the metaorder component and trade against the resulting mispricing, the scaling
limit of the model leads exactly to (7)–(8). We refer to Durin et al. [20] for the full derivation.
Economically, _r_ _[u]_ can be interpreted as a stabilizing force. When a metaorder pushes prices above
their efficient level, sophisticated traders increase their activity, absorbing part of the order flow


6


and limiting further price pressure. When the mispricing shrinks, their activity naturally subsides.
The function U governs how aggressively the resistance reacts to perceived mispricing, as illustrated later on in Figure 6.


**2.3** **Properties of the market resistance**


The introduction of a resistance term _r_ _[u]_ satisfying (8) fundamentally alters the shape of market
impact. Assuming a buy strategy _u_ ě 0 with compact support, the market impact _MI_ from (7)
is decomposed into a permanent and a transient components, denoted respectively by _PMI_ and
_TMI_, such that


ż
8



_PMI_ p _u_ q :“ lim
_t_ Ñ8 _[MI]_ [p] _[u, t]_ [q “] _[ κ]_ [8]



0



` _us_ ´ _rs_ _[u]_ ˘ d _s,_



ż
_t_
_TMI_ p _u, t_ q :“ _MI_ p _u, t_ q ´ _PMI_ p _u_ q “



_Gλ,ν_ p _t_ ´ _s_ q` _us_ ´ _rs_ _[u]_ ˘ d _s_ ´ _κ_ 8
0



ż
8


_t_



` _us_ ´ _rs_ _[u]_ ˘ d _s._



As in standard propagator models, impact is concave in time and decays as a power law with
exponent _ν_ ´ 1; see [14, Section 13.4.4] and Figure 1.





(a) Market impact profile





(b) Trading rate _u_ and its resulting endogenous resistance rate _r_ _[u]_


Figure 1: Market impact and trading rates for _ν_ “ 0 _._ 5, _λ_ “ 1, _u_ p _t_ q “ 0 _._ 3 **1** 0ď _t_ ď1, and Up _x_ q “ _x_ [2] .


7


A particularly important implication concerns the dependence of impact on the participation rate.
Consider a normalized execution profile _u_ (i.e., ş08 _[u]_ [p] _[s]_ [q][ d] _[s]_ [ “][ 1) and suppose trading occurs at]
rate _γu_ . In this setting, _γ_ has no unit, and acts as a proxy for the participation rate, which
is _γ_ {p _γ_ ` _V_ q, where _V_ denotes the typical background market volume. Under the power-law
specification Up _x_ q “ _cx_ _[c]_ with _c_ ą 1, Durin et al. [20, Theorem 9] show that market impact satisfies


_MI_ p _γu, t_ q „ _γ_ Ñ8 _γ_ [1][{] _[c]_ _._


Choosing _c_ “ 2 recovers the empirically observed square-root law. In this interpretation, the
square-root scaling is not imposed exogenously but emerges from the interaction between aggressive
execution and endogenous market resistance. Although this theorem is asymptotic and valid for
large participation rates, Figure 2 illustrates that the scaling remains a good approximation even
for moderate values of _γ_ .







Figure 2: Market impact as a function of _γ_ for _ν_ “ 0 _._ 5, _λ_ “ 1, and Up _x_ q “ _x_ [2] . A power-law fit of
the form _MI_ “ 1 _._ 172 ¨ _γ_ [0] _[.]_ [6086] is shown.

### **3 Optimal trading with market resistance**


**3.1** **Problem formulation**


Consider a risky asset whose unaffected price process _S_ is given by


_St_ “ _Pt_ ` _Mt,_ _t_ P r0 _, T_ s _,_ (9)


where _P_ a finite variation process valued in L [2] and _M_ is a centered square-integrable martingale.
We consider an agent with an initial holding _X_ 0 P R of this asset controlling his trading rate _u_ P L [2]

of his inventory _X_ _[u]_ such that


ż
_t_
_Xt_ _[u]_ [:][“] _[ X]_ [0] [`] _us_ d _s,_ _t_ P r0 _, T_ s _._ (10)

0


In particular,
sup Er| _Xt_ _[u]_ [|][2][s ă 8] _[.]_ (11)
_t_ Pr0 _,T_ s


8


Furthermore, trading the asset at the rate _u_ impacts the unaffected price _S_ such that the effective
trading price _S_ _[u]_ becomes
_S_ _[u]_ :“ _S_ ` _I_ _[u]_ _,_ (12)


where the price impact model _I_ _[u]_ is specified as follows

_It_ _[u]_ [:][“] _[γ]_ _t_ P r0 _, T_ s _._ (13)

2 _[u][t]_ [ ` p] **[H]** [ `] **[ G]** [qp] _[u]_ [ ´] _[ r][u]_ [q] _[t][,]_


Here, **H** and **G** are two operators on L [2] modeling the permanent and transient market impacts,
respectively, while _γ_ ě 0 denotes, from this point onward, the (constant) slippage cost intensity.
As motivated in Section 2, _r_ _[u]_ denotes the _market’s reaction_ or _resistance_ to the trading strategy _u_,
capturing the nonlinear nature of price impact as it solves the following nonlinear Volterra equation


_rt_ _[u]_ [“][ U] ` **G** p _u_ ´ _r_ _[u]_ q _t_ ˘ _,_ _t_ P r0 _, T_ s _,_ (14)


where the U is called _the resistance function_ . In order to ensure the well-posedness of the price
impact model (13)–(14), we make the following assumptions on the operators **H**, **G** and on the
resistance function U.


**Definition 3.1.** _A Volterra kernel G_ : r0 _, T_ s [2] Ñ R _is said to be admissible if_


ż
_t_



_CG_ :“ sup
_t_ Pr0 _,T_ s



| _G_ p _t, s_ q| [2] d _s_ ă 8 _._ (15)
0



_Any admissible kernel G induces a unique linear and bounded integral operator_ **G** : L [2] ÞÑ L [2]



_defined by_



ż
_t_
p **G** _u_ q _t_ :“ _G_ p _t, s_ q _us_ d _s,_ _t_ P r0 _, T_ s _,_ _u_ P L [2] _,_

0



_such that, by Cauchy-Schwarz’s inequality,_


} **G** _u_ } [2] ď _TCG_ } _u_ } [2] _,_ _u_ P L [2] _._ (16)


_As a consequence of Fubini’s theorem and the tower property of the conditional expectation, the_
_unique linear and bounded adjoint operator_ **G** [˚] : L [2] Ñ L [2] _of_ **G** _is explicitly given by_


ż
_T_
p **G** [˚] _u_ q _t_ :“ _G_ p _s, t_ qE _t_ r _us_ sd _s,_ _t_ P r0 _, T_ s _,_ _u_ P L [2] _._

_t_


_The boundedness of_ **G** [˚] _is ensured by conditional Jensen’s inequality and Fubini’s theorem such_
_that_
} **G** [˚] _u_ } [2] ď _TCG_ } _u_ } [2] _,_ _u_ P L [2] _,_ (17)


_see for example [19, Chapter 6, Section 2]._


**Assumption A.** _The operator_ **G** _is an admissible convolution operator: there exists an admissible_
_kernel function G_ : r0 _,_ 8q Ñ R _such that for each u_ P L [2] _and each t_ P r0 _, T_ s _, we have_


ż
_t_
**G** _ut_ “ _G_ p _t_ ´ _s_ q _us_ d _s._

0


9


_We also assume G is continuous on_ p0 _,_ 8q _, completely monotone (see Definition B.1), and L_ [2]

_integrable on_ r0 _, T_ s _and we write_


ż
_T_
} _G_ } [2] _L_ [2] pr0 _,T_ sq [“] _G_ p _s_ q [2] d _s._

0


_Finally, we assume that G satisfies the following continuity assumption_


ż
8



lim
_t_ Ñ _t_ 0



| _G_ p _t_ 0 ´ _s_ q ´ _G_ p _t_ ´ _s_ q| d _s_ Ñ 0 _._
0



**Assumption B.** _There exists a nonnegative constant κ_ 8 _such that for each u_ P L [2] _and each_
_t_ P r0 _, T_ s _,_ ż

_t_



**H** _ut_ “ _κ_ 8



_us_ d _s._ (18)
0



**Assumption C.** _The function_ U _is L-Lipschitz continuous with_ Up0q “ 0 _and satisfies_


Up _x_ q
lim “ _δ_ ě 0 _._
| _x_ |Ñ8 _x_


**Remark 1.** _Assumption C implies that_ U _is asymptotically close to linear. In particular, it includes_
_the linear case, the bounded case and all cases of interest discussed in Section 3.3. Moreover, the_
_assumption that_ Up0q “ 0 _is not essential but is considered to simplify the computations._


Given any trading strategy _u_ P L [2], the following lemma ensures that the resistance fixed-point
equation (14) admits a unique solution _r_ _[u]_ P L [2] under a linear growth assumption on U.


**Lemma 3.2.** _Let u_ P L [2] _._ _Suppose that Assumptions A and B hold and that_ U _is Lipschitz_
_continuous, then there exists a unique solution r_ _[u]_ P L [2] _to_ (14) _. Moreover, the mapping u_ ÞÑ _r_ _[u]_ _is_
_Lipschitz continuous on_ L [2] _._


_Proof._ See Appendix D.1.


Lemma 3.2 guarantees that the price impact _I_ _[u]_ from (13) as well as the execution price p _St_ _[u]_ [q] _t_ Pr0 _,T_ s
from (12) are well-defined L [2] processes, for every _u_ P L [2] . We are now in place to introduce the
agent’s Profit and Loss (PnL) functional



„ ż
_T_
Jp _u_ q :“ E ´



2




_[ϱ]_ _T_ [q][2] ȷ _,_ _u_ P L [2] _,_ (19)

2 [p] _[X]_ _[u]_



_St_ _[u][u][t]_ [d] _[t]_ [ `] _[ X]_ _T_ _[u][S][T]_ [´] _[ϕ]_
0 2



ż
_T_



p _Xt_ _[u]_ [q][2][d] _[t]_ [ ´] _[ϱ]_
0 2



where the first term represents the profit and loss induced by the trading rate _u_, the second one
values the terminal inventory against the terminal unaffected price [3, Remark 2.1], the third one
encodes risk aversion with weight _ϕ_ ě 0, and the last one penalizes the terminal inventory with
weight _ϱ_ ě 0. Note that J is indeed well-defined under Assumptions B, A, C and (11). Our
objective is to find trading strategies ˆ _u_ P L [2] that maximize the performance functional J such that


Jp _u_ ˆq “ sup (20)
_u_ PL [2][ J][p] _[u]_ [q] _[.]_

Inserting the definitions of the final inventory _XT_ _[u]_ [from (10) and the effective price] _[ S][u]_ [ from (12)]
into J from (19), while using the tower property of the conditional expectation, allows us to rewrite
the functional J in the standard form (2) such that


„ ż ȷ
_T_
Jp _u_ q “ E p _αt_ ´ _It_ _[u]_ [q] _[u][t]_ [d] _[t]_ [ `] _[ M]_ [p] _[X]_ _[u]_ [q] ` _X_ 0Er _ST_ s _,_ _u_ P L [2] _,_ (21)

0


10


where _α_ is the alpha-signal from the drift of the fundamental asset price _S_, defined by


_αt_ “ E _t_ r _ST_ ´ _St_ s “ E _t_ r _PT_ ´ _Pt_ s _,_ _t_ P r0 _, T_ s _,_ (22)



and



_M_ p _X_ _[u]_ q :“ ´ _[ϕ]_

2



ż
_T_



p _Xt_ _[u]_ [q][2][d] _[t]_ [ ´] _[ϱ]_
0 2



_T_ [q][2] _[,]_
2 [p] _[X]_ _[u]_



in a similar way to Abi Jaber et al. [3, 4] and De Carvalho [17].


**Remark 2.** _A natural question concerns the choice of the window length T_ _. In a real-time trading_
_setup, how should this model be applied, and what value of T is appropriate?_
_In practice, trading firms typically rely on statistical alpha signals computed over short horizons._
_For example, suppose an agent trades every 10 minutes using a 10-minute alpha on a given stock._
_Solving the associated optimal trading problem requires, in our framework, a discrete iterative_
_scheme that takes as input a known trajectory of the buy/sell signal. This assumption is somewhat_
_unrealistic, since the agent only observes a single alpha value every 10 minutes rather than a_
_continuous signal._
_How, then, can this framework be used with a single discrete alpha observation? One approach is_
_to solve a sequence of optimisation problems, each over a 10-minute window (or, more generally,_
_at the rebalancing frequency of the strategy). Within each window, one may reconstruct a discrete_
_trajectory for the signal—either by recomputing the statistical alpha on smaller subwindows, or_
_by treating the observed alpha as constant over these subintervals—and then apply the numerical_
_scheme described in Section 4. This yields a practical real-time implementation consistent with the_
_statistical nature of alpha signals._



**Reformulation with operators on** L [2] **.** To better analyze the problem, we recast it in operator
formulation. First, note that in view of Lemma 3.2, we know that there exists an operator **R** :
L [2] Ñ L [2] such that _r_ _[u]_ “ **R** p _u_ q _, u_ P L [2] . Using this notation, the market impact _It_ _[u]_ [can be rewritten]
as
_It_ _[u]_ [“] _[γ]_ `p **H** ` **G** q ˝ p **I** ´ **R** q _u_ ˘ _t_ _[,]_ _t_ P r0 _, T_ s

2 _[u][t]_ [ `]

where **I** stands for the identity operator in L [2] such that **I** _ut_ “ _ut_ for every _u_ P L [2] and _t_ P r0 _, T_ s. To
use the same operator notations, we also write **X** _u_ “ _X_ _[u]_ which defines an operator in L [2] . Thus,
the gain functional (21) becomes



`p **H** ` **G** q ˝ p **I** ´ **R** q _u_ ˘
2 _[u][t]_ [ `]



_t_ _[,]_ _t_ P r0 _, T_ s



Jp _u_ q “ x _u, α_ y ´ _[γ]_




_[γ]_ _[ϕ]_

2 _[∥][u][∥]_ [2][ ´ x] _[u,]_ [ p] **[H]** [ `] **[ G]** [q ˝ p] **[I]** [ ´] **[ R]** [q] _[u]_ [y ´] 2




_[ϕ]_ _[ϱ]_

2 _[∥]_ **[X]** _[u][∥]_ [2][ ´] 2



_T_ [s `] _[ X]_ [0][E][r] _[S][T]_ [s] _[.]_ (23)
2 [E][rp] **[X]** _[u]_ [q][2]



All these operators act on L [2] . However, we can also see them as operator on _L_ [2] . In the following,
we consider either of each representation depending of the context.


**3.2** **The linear case**


In this section, we assume U to be linear. We focus on this case for two reasons. First, the operator
**R** becomes linear, which renders the analysis of J straightforward: J becomes a quadratic form,
and the existence and uniqueness of a maximzer follows from the positive semi-definiteness of the
operator p **H** ` **G** q ˝ p **I** ´ **R** q. Second, the linear case serves as a building block for the proofs in the
general setting. We now formalize the main results of this section in the following statement.


11


**Theorem 3.3.** _Suppose that_ Up _x_ q “ _ax for some a_ ě 0 _for every x_ P R _._ _Suppose also that_
_Assumptions A and B hold. Then the functional_ ´J _is γ-convex, coercive and therefore_ J _admits_
_a unique maximizer_ p _u characterised by_


_γu_ p ` p **H** ` **G** q ˝ p **I** ` _a_ **G** q [´][1] _u_ p ` p **H** [˚] ` **G** [˚] q ˝ p **I** ` _a_ **G** [˚] q [´][1] _u_ p ` **H** _ϕ,ϱu_ p ` **H** [˚] _ϕ,ϱ_ _[u]_ [p][ “] _[ α,]_ (24)


_where_ **H** _ϕ,ϱ is the integral operator associated to the kernel_


_Hϕ,ϱ_ p _t, s_ q :“ ` _ϕ_ p _T_ ´ _t_ q ` _ϱ_ ˘ 1 t _t_ ą _s_ u _,_ _s, t_ P r0 _, T_ s _._ (25)


The proof is postponed to Appendix E.


**3.3** **The general case**


We now aim to extend the results of Section 3.2 to the nonlinear case of U, relying only on Assumption C. To do this, we first show that J is Fr´echet differentiable (in the sense of Definition B.7) and
we compute its derivative, which allows to identify a first-order condition to be satisfied by any
critical point of J. The main difficulty in this step lies in the nonlinearity of _r_ _[u]_ . We then study
the coercivity of J, which ensures that an extremum must exist.


**Lemma 3.4.** _Suppose that_ U _is differentiable and Lipschitz continuous. Then the operator_ **R** _is_
_Fr´echet differentiable in_ L [2] _. Moreover, for u, h in_ L [2] _, the directional derivative of_ **R** _at u in the_
_direction h is the_ L [2] _-process y_ “ _D_ **R** p _u_ qp _h_ q _solution of the Volterra equation_


_yt_ “ U [1][`] **G** p _u_ ´ _r_ _[u]_ q _t_ ˘ **G** p _h_ ´ _y_ q _t,_ _t_ P r0 _, T_ s _._


_In other words, we have_


ˆ ` ˘ [¯] ˙´1 ` ˘ [¯]
_D_ **R** p _u_ q “ **I** ` U [1][´] **G** _u_ ´ **R** p _u_ q **G** U [1][´] **G** _u_ ´ **R** p _u_ q **G**


ˆ ` ˘ [¯] ˙´1
“ **I** ´ **I** ` U [1][´] **G** _u_ ´ **R** p _u_ q **G** _._


_Proof._ See Appendix D.2.


Therefore Lemma 3.4 ensures that J is also Fr´echet differentiable on L [2] . Similar computations
to [4, Lemma 4.2] ensure that the Gˆateaux derivative of J is given by


_∇_ Jp _u_ q “ _α_ ´ _X_ 0` _ϕ_ p _T_ ´ _._ q ` _ϱ_ ˘ ´ _γu_ ´ p **H** ` **G** q ˝ p **I** ´ **R** qp _u_ q


´` ˘ ` ˘ [¯][˚]
´ **H** ` **G** ˝ **I** ´ _D_ **R** p _u_ q _u_ ´ **H** _ϕ,ϱu_ ´ **H** [˚] _ϕ,ϱ_ _[u,]_ (26)


where **H** [˚] _ϕ,ϱ_ [is defined in (25). We then directly get the following result.]


**Theorem 3.5.** _Any local extrema u of_ J _must satisfy_


` ˘ ´` ˘ ` ˘ [¯][˚]
_α_ ´ _X_ 0 _ϕ_ p _T_ ´ _._ q` _ϱ_ ´ _γu_ ´p **H** ` **G** q˝p **I** ´ **R** qp _u_ q´ **H** ` **G** ˝ **I** ´ _D_ **R** p _u_ q _u_ ´p **H** _ϕ,ϱ_ ` **H** [˚] _ϕ,ϱ_ [q] _[u]_ [ “][ 0] _[.]_


_In other words, if u is a local extrema of_ J _, then it must satisfy the following nonlinear stochastic_
_Fredholm system equation_

# _γu_ ` p **H** ` **G** q _u_ ` p **H** _ϕ,ϱ_ ` **H** [˚] _ϕ,ϱ_ [q] _[u]_ [ ´] **[ A]** [p] _[u]_ [q “] _[ α]_ [ ´] _[ X]_ [0] ` _ϕ_ p _T_ ´ _._ q ` _ϱ_ ˘ _,_

(27)
_r_ _[u]_ “ **R** p _u_ q _,_


12


_where we introduce the following nonlinear operator_ **A** : L [2] Ñ L [2] _such that_


´` ` ˘˚ [¯]
**A** p _u_ q :“ p **H** ` **G** q ˝ **R** p _u_ q ´ **I** ` p **M** _[u]_ ˝ **G** q [˚][˘][´][1] ˝ **H** ` **G** _u,_ _u_ P L [2] _,_ (28)


_with_ **M** _[u]_ _the multiplication operator defined by_



**M** _[u]_ _vt_ :“ U [1][´] **G** ` _u_ ´ **R** p _u_ q˘ _t_



¯
_vt,_ _t_ P r0 _, T_ s _,_ _v, u_ P L [2] _._



We now establish the existence of an optimal control.


**Theorem 3.6.** _Suppose that Assumptions A, B and C hold and suppose in addition that_ Ω _is_
_countable or finite and that κ_ 8 ` _γ_ ą 0 _, then there exists a global maximizer_ p _u_ P L [2] _of the_
_functional_ J _._

### **4 Numerical scheme and application to optimal round-trips**


In this section, we introduce an iterative numerical scheme for constructing _M_ P N [˚] sample trajectories of a discrete-time approximation of the critical points ˆ _u,_ ˆ _r_ _[u]_ P L [2] satisfying the First-Order
Condition (FOC) (27). We establish a theoretical convergence result for this scheme and illustrate
its output through an example of optimal round-trip strategies in the presence of stochastic “buy”
signals with various decay rates, as well as through a qualitative analysis of the influence of the
resistance function’s convexity on optimal trading. We defer to Appendix A the proof of the convergence result, together with additional illustrations of the qualitative effects of impact decay and
permanent impact intensity on the resulting strategies.


In what follows, we fix a uniform time-grid T _N_ :“ t _[iT]_ _N_ _[, i]_ [ P t][0] _[, . . ., N]_ [uu][, with] _[ N]_ [ P][ N][˚][, and we use]

the notation **A** p _u_ q “ **A** p _u, r_ _[u]_ q in order to explicitly refer to the dependence of **A** from (28) on both
_u_ and _r_ _[u]_, which will be constructed separately in practice.


**4.1** **Approximation of operators**


**Nystr¨om approximation of Volterra integral operators.** Given a deterministic Volterra
kernel _G_ : R Ñ R, the integral operator **G** : L [2] Ñ L [2] and its dual operator **G** [˚] are numerically
approximated on T _N_ by left-rectangles, while integrating the kernels in the same spirit as [1, 3, 4, 32]
such that



_i_ ÿ´1

_MG_ p _i, j_ qE _tiutj_ _,_ _ti_ P T _N_ _,_ _u_ P L [2] _,_
_j_ “0



p **G** _u_ q _ti_ «


where we define



_i_ ÿ´1

_LG_ p _i, j_ q _utj_ _,_ p **G** [˚] _u_ q _ti_ «
_j_ “0



ˆ ż
_tj_ `1
_LG_ :“ _G_ p _ti, s_ qd _s_ 1t _j_ ď _i_ u

_tj_



ˆ ż
_tj_ `1
_,_ _MG_ :“
_i,j_ Pt0 _,...,N_ ´1u _tj_



_G_ p _s, ti_ qd _s_ 1t _j_ ě _i_ u
_tj_



˙



˙


_._
_i,j_ Pt0 _,...,N_ ´1u



**Numerical approximation of the nonlinear operator A from** (28) **.** Given _u_ P L [2], let
_r_ _[u]_ P L [2] be the unique solution to the fixed-point equation in (27). Then, the first term of **A** p _u_ q
in (28), i.e.,
p **H** ` **G** q _r_ _[u]_


13


is linear in _r_ _[u]_ and can be readily approximated via the Nystr¨om technique, while it remains to
estimate the nonlinear term given by

´`
**I** ` p **M** _[u]_ ˝ **G** q [˚][˘][´][1] ˝ p **H** ` **G** q [˚][¯] p _u_ q _._ (29)


To achieve this, we set


_f_ :“ ` **I** ` p **M** _[u]_ ˝ **G** q [˚][˘][´][1] ˝ p **H** ` **G** q [˚] _u_

ðñ _f_ ` p **M** _[u]_ ˝ **G** q [˚] _f_ “ p **H** ` **G** q [˚] _u_



ż _T_ ” ˘
ðñ _ft_ ` _G_ p _s, t_ qE _t_ U [1][´`] **G** p _u_ ´ _r_ _[u]_ q

_t_



_s_



¯ ı ż _T_
_fs_ d _s_ “

_t_



` ˘
_H_ p _s, t_ q ` _G_ p _s, t_ q E _tus_ d _s,_ _t_ P r0 _, T_ s (30)



where the explicit expressions of the dual operators are obtained by stochastic Fubini and the
tower property, and are well defined since **M** _[u]_ ˝ **G** and p **H** ` **G** q are both linear and bounded (since
U [1] is bounded), see [19, Chapter 6, Section 2]. Given _u_ P L [2] and observing that _fT_ “ 0, we can
solve (30) by a backward iterative scheme on the subdivision T _N_ as follows:


  - _ftN_ “ 0,


  - for _p_ P t _N_ ´ 1 _,_ ¨ ¨ ¨ _,_ 0u, since _ftp_ and _utp_ are F _tp_ -measurable, then a left-rectangle approximation of the integrals in (30) yields



ˆ

` ˘´1
_ftp_ “ 1 ` _MG_ p _p, p_ q _wt_ _[u]_ _p_ _MG_ ` _H_ p _p, p_ q _utp_ `



_N_ ÿ´1

_MG_ ` _H_ p _p, k_ qE _tputk_ _._
_k_ “ _p_ `1



_._ ´



_N_ ÿ´1 ˙

_MG_ p _p, k_ qE _tp_ r _wt_ _[u]_ _k_ _[f][t]_ _k_ [s] _,_ (31)
_k_ “ _p_ `1



where we defined
_w_ _[u]_ :“ U [1][`] **G** p _u_ ´ _r_ _[u]_ q˘ _,_


and the conditional expectations pE _tp_ r _wt_ _[u]_ _k_ _[f][t]_ _k_ [sq] _[N]_ [´][1][ě] _[k]_ [ą] _[p]_ [ě][0] _[,]_ [ p][E] _[t]_ _p_ _[u][t]_ _k_ [q] _[N]_ [´][1][ě] _[k]_ [ą] _[p]_ [ě][0] [can be esti-]
mated by least-squares Monte Carlo similarly as in [3, Section 3.3] or [4, Section 3.1].


**Remark 3** (Sanity check of the approximation of **A** ) **.** _The supremum L_ [2] _error E_ _[bf]_ _associated to_
_the backward Fredholm equation_ (30) _is given by_



_t_ [´] `p **H** ` **G** q [˚] _u_ ˘



ȷ˙
_t_ ˇˇ2d _t_ p _ω_ q _,_



_E_ _[bf]_ p _f_ q :“ sup
_ω_ PΩ



ˆ ż
_T_


0



ˇˇ _ft_ ` `p **M** _[u]_ ˝ **G** q [˚] _f_ ˘



_can be estimated numerically on a uniform time grid with step_ ∆ _as_


_EN,M_ _[bf]_ [p] _[f]_ [q][ :][“] sup _EN,M_ _[bf]_ [p] _[f]_ [qp] _[ω][m]_ [q] (32)
_m_ Pt1 _,...,M_ u


_where_



_EN,M_ _[bf]_ [p] _[f]_ [qp] _[ω][m]_ [q][ :][“][ ∆]



_N_ ÿ´1


_p_ “0



ˇˇˇˇ _ftp_ p _ωm_ q ` _MG_ p _p, p_ q _wtup_ [p] _[ω][m]_ [q] _[f][t]_ _p_ [p] _[ω][m]_ [q]



`



_N_ ÿ´1

_MG_ p _p, k_ qE _tp_ r _wt_ _[u]_ _k_ _[f][t]_ _k_ [sp] _[ω][m]_ [q ´] _[ M][G]_ [`] _[H]_ [p] _[p, p]_ [q] _[u][t]_ _p_ [p] _[ω][m]_ [q]
_k_ “ _p_ `1


14


_N_ ÿ´1



2
_._



´



ÿ´

_MG_ ` _H_ p _p, k_ qE _tputk_ p _ωm_ qˇˇˇˇ
_k_ “ _p_ `1



_In practice EN,M_ _[bf]_ [p] _[f]_ [q] _[ from]_ [ (32)] _[ is way below machine precision, see the right plot in Figure 5.]_


**4.2** **Iterative numerical scheme**


**Criterion of convergence.** For any given _u, r_ _[u]_ P L [2], we define the joint supremum _L_ [2] errors
of the FOC (27) by



_t_ [´] ` **A** p _u, r_ _[u]_ q˘



_t_



_E_ [1] p _u, r_ _[u]_ q :“ sup
_ω_ PΩ



ˆ ż
_T_


0



` ˘
ˇˇˇ _γut_ ` p **H** ` **G** ` **H** _ϕ,ϱ_ ` **H** [˚] _ϕ,ϱ_ [q] _[u]_



´ ` ˘ [¯ˇ] 2 ˙
´ _αt_ ´ _X_ 0 _ϕ_ p _T_ ´ _t_ q ` _ϱ_ ˇˇ d _t_ p _ω_ q _,_



_t_



_E_ [2] p _u, r_ _[u]_ q :“ sup
_ω_ PΩ



ˆ ż
_T_


0



_u_ ´` ˘
ˇˇˇ _rt_ [´][ U] **G** p _u_ ´ _r_ _[u]_ q



¯ˇˇˇ2d _t_ ˙p _ω_ q _,_



which, over a _N_ -steps time grid and _M_ sample trajectories, are approximated numerically by


_EN,M_ [1] [p] _[u][N]_ _[, r][N]_ [q][ :][“] sup _EN,M_ [1] [p] _[u][N]_ _[, r][N]_ [qp] _[ω][m]_ [q] _[,]_ (33)
_m_ Pt1 _,...,M_ u


where



ˇˇˇˇ _γuNti_ [p] _[ω][m]_ [q `]


_N_ ÿ´1



_i_ ÿ´1

_LG_ ` _H_ ` _Hϕ,ϱ_ p _i, j_ q _u_ _[N]_ _tj_ [p] _[ω][m]_ [q `] _[ M][H]_ _ϕ,ϱ_ [p] _[i, i]_ [q] _[u][N]_ _ti_
_j_ “0


_i_ ÿ´1



_EN,M_ [1] [p] _[u][N]_ _[, r][N]_ [qp] _[ω][m]_ [q][ :][“][∆]



_N_ ÿ´1


_i_ “0



_LG_ ` _H_ p _i, j_ q _rt_ _[N]_ _j_ [p] _[ω][m]_ [q `] _[ f]_ _t_ _[ N]_ _i_ [p] _[ω][m]_ [q]
_j_ “0



`



_MHϕ,ϱ_ p _i, j_ qE _tiu_ _[N]_ _tj_ [p] _[ω][m]_ [q ´]
_j_ “ _i_ `1



2

´ _αti_ p _ωm_ q ` _X_ 0p _ϕ_ p _T_ ´ _ti_ q ` _ϱ_ qˇˇˇˇ _,_



with _ft_ _[N]_ _i_ [is given by (31), and]


_EN,M_ [2] [p] _[u][N]_ _[, r][N]_ [q][ :][“] sup _EN,M_ [2] [p] _[u][N]_ _[, r][N]_ [qp] _[ω][m]_ [q] _[,]_ (34)
_m_ Pt1 _,...,M_ u


where



ˆ
ˇˇˇˇ _rtNi_ [p] _[ω][m]_ [q ´][ U] _i_ ÿ´1



ÿ´ ` ˘ [˙ˇ]

_LG_ p _i, j_ q _u_ _[N]_ _tj_ [p] _[ω][m]_ [q ´] _[ r]_ _t_ _[N]_ _j_ [p] _[ω][m]_ [q] ˇˇˇ
_j_ “0



2
_._



_EN,M_ [2] [p] _[u][N]_ _[, r][N]_ [qp] _[ω][m]_ [q][ :][“][ ∆]



_N_ ÿ´1


_i_ “0



In what follows, we drop the upper-script _N_ from _u_ _[N]_ _, r_ _[N]_ for ease of reading. We then aim to construct a sequence of such discrete-time approximation of p _u, r_ _[u]_ q which we denote by p _u_ [r] _[n]_ [s] _, r_ [r] _[n]_ [s] q _n_ ě0 “
p _u_ [r] _[n]_ [s] p _N, M_ q _, r_ [r] _[n]_ [s] p _N, M_ qq _n_ ě0 such that


_EN,M_ [1] _[,]_ [2] ` _u_ [r] _[n]_ [s] p _N, M_ q _, r_ [r] _[n]_ [s] p _N, M_ q˘ ÝÑ
_n_ Ñ8 [0] _[.]_


15


**Scheme definition.** Fix _ϵ_ ą 0.


  - Initialize p _u_ [r][0][s] _, r_ [r][0][s] q ” 0.


  - While _EN,M_ [1] [p] _[u]_ [r] _[n]_ [s] _[, r]_ [r] _[n]_ [s][q ą] _[ ϵ]_ [, do:]


**–** Update _u_ [r] _[n]_ [s] by solving (27) while computing the nonlinear operator **A** using _u_ [r] _[n]_ [´][1][s] _, r_ [r] _[n]_ [´][1][s] :


_γu_ [r] _[n]_ [s] ` p **H** ` **G** ` **H** _ϕ,ϱ_ ` **H** [˚] _ϕ,ϱ_ [q] _[u]_ [r] _[n]_ [s][ “] _[ α]_ [ ´] _[ X]_ [0] ` _ϕ_ p _T_ ´ _ti_ q ` _ϱ_ ˘ ` **A** p _u_ [r] _[n]_ [´][1][s] _, r_ [r] _[n]_ [´][1][s] q _,_ (35)


which can be numerically solved as detailed in [3, Section 3.2].


**–** Update the market resistance _r_ [r] _[n]_ [s] “ _r_ [r] _[n,]_ [8s] as the limit of the sequence p _r_ [r] _[n,p]_ [s] q _p_ ě0 solving
the fixed-point equation from (27) via Picard iterations over _p_ ě 0 until _EN,M_ [2] [p] _[u]_ [r] _[n]_ [s] _[, r]_ [r] _[n,p]_ [s][q]
is smaller than _ϵ_ : # _r_ [r] _[n,p]_ [`][1][s] “ U` **G** p _u_ [r] _[n]_ [s] ´ _r_ [r] _[n,p]_ [s] q˘ _,_

(36)
_r_ [r] _[n,]_ [0][s] :“ _r_ [r] _[n]_ [´][1] _[,]_ [0][s] _._


**–** Increment _n_ to _n_ ` 1.


**Theoretical convergence of the iterative scheme.** In the following, we state a result on the
theoretical rate of convergence of the iterative scheme if _T_ is sufficiently small or, equivalently, if
_γ_ is sufficiently large, in the same spirit as [4, Proposition 2.14].


**Theorem 4.1** (Exponential convergence of the iterative scheme) **.** _Assume the resistance function_
U _is Lipchitz-continuous with constant L_ ą 0 _, with bounded derivative_ U [1] ă _C, for some positive_
_constant C. Fix two admissible kernels H, G, as well as the trading horizon T_ ą 0 _and the slippage_
_costs parameter γ_ ą 0 _such that_



~~a~~
1 ą



_TCG_ maxp _L, C_ q _,_ (37)



_γ_ ą _C_ [˜] :“ ~~a~~ _TCH_ ` _G_



ˆ ?
_TCG_ 1
_L_ `
1 ´ _L_ ~~[?]~~ _TCG_ 1 ´ _C_ ~~[?]~~ _TCG_



˙

_,_ (38)



_where CH_ ` _G and CG are respectively the constants associated to the kernels H_ ` _G and G defined_
_by_ (15) _. Assume the existence of_ p _u,_ ˆ ˆ _r_ q _satisfying the first-order-condition_ (27) _, and denote by_
p _u_ [r] _[n]_ [s] _, r_ [r] _[n]_ [s] q _n_ ě0 _the sequence of controls obtained by the iterative scheme_ (35) _–_ (36) _, then_


lim _in_ L [2] _,_
_n_ Ñ8 _[u]_ [r] _[n]_ [s][ “][ ˆ] _[u]_


_and the convergence rate is bounded by_



_u_ r _n_ s ´ ˆ _u_ ď ˆ r _C_
��� ��� _γ_



˙ _n_
_∥u_ ˆ _∥,_ _n_ P N _._ (39)



_As a consequence,_ p _u,_ ˆ ˆ _r_ q _is the unique solution to the FOC_ (27) _._


_Proof._ See Appendix A.1.


**Remark 4** (Stochastic gradient descent) **.** _Starting from u_ [r][0][s] “ 0 _, consider a stochastic gradient_
_iterative scheme of the form_


_u_ [r] _[n]_ [s] “ _u_ [r] _[n]_ [´][1][s] ` _ηn∇_ Jp _u_ [r] _[n]_ [´][1][s] q _,_ _n_ ě 1 _,_


16


_where_ p _ηn_ q _is a sequence of learning steps and ∇_ J _is given by_ (26) _. Although appearing to be a_
_promising candidate to construct critical points satisfying the first order optimality condition_ (27)
_without having to invert any Fredholm equation, we observed in practice that such scheme converges_
_slower than the iterative scheme_ (35) _–_ (36) _and does not converge at all in the regime γ_ Ñ 0 _._


**4.3** **Optimal round-trips in presence of “buy” signals**


**Impact model specification.** Given fixed constants _δ_ ą 0 and _c_ ě 1, we introduce the resistance function U _δ,c_ : R Ñ R as


U _δ,c_ p _x_ q :“ _sign_ p _x_ q| _x_ | _[c]_ 1t| _x_ |ď _δ_ u ` ` _cδ_ _[c]_ [´][1] _x_ ´ _sign_ p _x_ q _δ_ _[c]_ p _c_ ´ 1q˘1t| _x_ |ą _δ_ u _,_ _x_ P R _,_ (40)


and its derivative is


U [1] _δ,c_ [p] _[x]_ [q][ :][“] _[ c]_ [|] _[x]_ [|] _[c]_ [´][1][1] t| _x_ |ď _δ_ u [`] _[ cδ][c]_ [´][1][1] t| _x_ |ą _δ_ u _[,]_ _x_ P R _._ (41)


The parameter _c_ ě 1 governs the degree of convexity, encompassing in particular the linear ( _c_ “ 1)
and quadratic ( _c_ “ 2) resistance functions. We also note that, for _c_ “ 2, the specification (40)
coincides with a modified Huber loss [27], in which the sign is flipped for negative arguments
so that market impact indeed moves the unaffected price unfavorably when executing large sell
orders. A finite value for _δ_ ă 8 yields an asymptotic linear growth of the resistance function
as in Assumption C, and guarantees Lemma 3.4 and Theorem 4.1 are applicable. Although _δ_
might be a desirable tunable regularizing model parameter, we do not need to explicitly specify
it in practice when considering a finite number of bounded sample signal trajectories (as in the
following numerical examples), and therefore _δ_ may remain implicit such that only the convex term
_sign_ p¨q| ¨ | _[c]_ 1t|¨|ď _δ_ u in (40) is effective.

































Figure 3: Resistance function specification (40) and its derivative (41) for various values of _c_, while
fixing _δ_ “ 1 _._ 2.


Unless stated otherwise, the parameters of the resistance function are set as follows:


  - _c_ “ 2 for the convexity of the resistance function; this corresponds to what we refer to as the
_Quadratic Market Resistance_ (QMR) model, asymptotically consistent with the square-root
law in participation rate as shown in [20, Theorem 9];


17


  - _δ_ ă 8 is left implicit, since we consider bounded sample signal trajectories.


As motivated in Section 2, we specify a power-law decay kernel _Gλ,ν_ to capture the transient nature
of market impact. Therefore, unless stated otherwise, the parameters of the price impact model
in (13) are set as follows:


  - _γ_ “ 0 _._ 2 for the intensity of slippage costs;


  - _λ_ “ 0 _._ 467 and _ν_ “ 0 _._ 614 for the transient impact decay (borrowed from [4], Figure 7);


  - _κ_ 8 “ 1 for the permanent impact intensity.


**Soft constraints specification.** The trader has the possibility to penalize his running inventory
as well as the final inventory level via the hyper-parameters _ϕ_ and _ϱ_ respectively introduced in (19).
Unless stated otherwise, we set:


  - _ϕ_ “ 0, i.e., no penalty on the running inventory, since it is obvious that an increasing value
of _ϕ_ shrinks the optimal inventory toward 0;


  - _ϱ_ “ 5 _e_ 2 " 1 to enforce a zero final inventory.


**Signals and least-squares Monte Carlo specification.** We specify an Ornstein-Uhlenbeck
(OU) drift-like price signal _µ_ and set _P_ :“ ş _µt_ d _t_ where _P_ is given in the unaffected price process (9).
We have
d _µt_ “ p _η_ ´ _κµt_ qd _t_ ` _σ_ d _Wt,_ _µ_ 0 P R _._ (42)


The alpha-signal _α_ from (22) is then explicitly given by



„ ż
_T_



_t_ P r0 _, T_ s _._ (43)
_κ_ [p] _[T]_ [ ´] _[ t]_ [q] _[,]_



˙ 1 ´ _e_ ´ _κ_ p _T_ ´ _t_ q



_αt_ :“ E _t_



ȷ ˆ
_µr_ d _r_ “ _µt_ ´ _[η]_
_t_ _κ_



_κ_



p ´ q ` _[η]_

_κ_ _κ_



Unless stated otherwise, we set:


  - _η_ “ 10, for the long-term mean;


  - _κ_ “ 1 for the mean-reversion rate;


  - Either _σ_ “ 1 or _σ_ “ 0 for the signal noise level, see Remark 5;


  - _µ_ 0 “ 1 for the initial state value of the OU drift-signal.



In the case of stochastic OU drift-signals, i.e., _σ_ “ 1, we need to apply a least-squares Monte Carlo
to approximate the nonlinear stochastic operator (29) via (31) as explained in Section 4.1. In what
follows, we apply Ridge regressions on 2000 signal sample trajectories with penalty 1 _e_ ´ 5 to a
basis expansion of all Laguerre polynomials up to degree two of the following family of features

ˆ ż ż ˙
¨ ¨
_α,_ _αs_ d _s,_ _e_ [´] _[κ]_ [p¨´] _[s]_ [q] _αs_ d _s_ _,_



ż

¨ ¨

_αs_ d _s,_
0 0



˙
_e_ [´] _[κ]_ [p¨´] _[s]_ [q] _αs_ d _s_ _,_
0



and refer the interested reader to [3, Section 3.3] and [4, Section 3.1 and Appendix A] for more
details. Finally, the number of time steps is set to _N_ “ 100.


**Remark 5.** _Setting the signal volatility to zero yields a deterministic optimal trading problem,_
_leading to the same qualitative conclusions as those obtained from the sample means of the optimal_
_quantities, while improving visual clarity in practice and avoiding the error propagation inherent_
_to the least-squares Monte Carlo estimation procedure._


18


**Optimal round-trips with the QMR model for various signal decays.** We specify three
stochastic nonnegative “buy” signals of the form (43) and vary the signal’s mean-reversion _κ_ P
t0 _._ 1 _,_ 1 _,_ 10u from (42), as illustrated in the top-left plot in Figure 4.


On the one hand, Figure 4 displays the sample averages and the associated 95% normal confidence
intervals of the main optimal quantities of interest associated to the optimal round-trip strategies:
optimal trading rates, inventories and resistance rates, as well as the resulting price distortions
and running trading costs. We also display 5 sample trajectories out of the 2000 ones used for the
least-squares Monte Carlo. The slower the signal decay, the more aggressive the trading strategy
becomes, and the greater the resulting market resistance, price distortion, and running trading
costs. Also, note that the resulting trading strategies do not feature any model round-trip model
arbitrage as all the sample running trading costs trajectories remain non-negative throughout the
trading horizon.


On the other hand, Figure 5 illustrates the exponential convergence of the iterative scheme through
iterations: the faster the signal decays, the faster the scheme converges. Note that the convergence rate depends on all the impact model’s parameters as suggested by inequality (38) from
Theorem 4.1. In particular, we observe that the smaller _γ_, the slower the convergence – until
numerical instability appears – which is consistent with the regularizing effect of slippage costs
already described in [4, Section 3.5].


19


Figure 4: Optimal round-trips for three stochastic “buy” signals with different signal decays _κ_
from (42). For each quantity, the shaded regions represent their normal 95% confidence intervals
estimated from the optimal 2000 sample trajectories, the empty dot markers denote the corresponding sample means, and we also display 5 sample trajectories.


20


Figure 5: Convergence of the numerical scheme (35)–(36) for three stochastic “buy” signals with
different signal decays _κ_ from (42): the left-hand plot displays the error _EN,M_ [1] [of the FOC defined]
in (33) while the right-hand plot shows the numerical error _EN,M_ _[bf]_ [of the backward scheme (31)]
defined in (32) as a function of the iteration step of the scheme. Note that the numerical error
_EN,M_ [2] [, defined in from (34), and due to Picard iterations when computing the resistance function]
is set to be lower than 1 _e_ ´ 16 at each iteration.


**Optimal round-trips for different convexity parameters.** For the remaining numerical results, including those reported in Appendix A.2, we set the signal noise level to zero, that is,
_σ_ “ 0 in (42), and run the iterative scheme on a single deterministic signal trajectory. All other
parameters are kept fixed as in Section 4.3, unless stated otherwise; see Remark 5.


Furthermore, in all subsequent numerical experiments, the convergence errors _EN,M_ [1] [in (33),] _[ E]_ _N,M_ [2]
in (34), and _EN,M_ [bf] [in (32) are found to be below 10][´][11][, 10][´][16][, and 10][´][31][, respectively, after 100]
iterations of the numerical scheme (35)–(36).


Figure 6 illustrates the qualitative effect of the convexity parameter _c_ ě 1 of the resistance function
U _M,c_ from (40): in this case, the higher the value of _c_, the more aggressive the optimal trading
strategy, and the longer the optimal resistance rate lingers near zero when the trader changes his
trading direction, which is consistent with the shapes of U _δ,c, c_ P t1 _,_ 2 _,_ 3 _,_ 4u depicted in Figure 3.
Therefore, the convexity captures how easily the market resistance reacts to the trader’s strategy,
and can be interpreted as a proxy of the ability of a sophisticated trader to detect the executed
volume. Compared to the linear propagator model shown in red (i.e., the case U ” 0), introducing
a market resistance leads to less aggressive trading, which is consistent with the interpretation of
market resistance as a proxy for sophisticated traders who benefit from the trader’s metaorder’s
impact and thereby erode part of the trader’s alpha.


21


Figure 6: Optimal round-trips in absence of resistance pU ” 0q and with different convexity
parameters _c_ P t1 _,_ 2 _,_ 3 _,_ 4u used in U _δ,c_ from (40).

### **References**


[1] Eduardo Abi Jaber and Eyal Neuman. Optimal liquidation with signals: the general propagator case. Available at SSRN 4264823, 2022.


[2] Eduardo Abi Jaber, Eyal Neuman, and Moritz Voß. Equilibrium in functional stochastic
games with mean-field interaction. arXiv preprint arXiv:2306.05433, 2023.


[3] Eduardo Abi Jaber, Nathan De Carvalho, and Huyˆen Pham. Trading with propagators


22


and constraints: applications to optimal execution and battery storage. arXiv preprint
arXiv:2409.12098, 2024.


[4] Eduardo Abi Jaber, Alessandro Bondi, Nathan De Carvalho, Eyal Neuman, and Sturmius
Tuschmann. Fredholm approach to nonlinear propagator models. Available at SSRN 5167824,
2025.


[5] Aur´elien Alfonsi, Antje Fruth, and Alexander Schied. Optimal execution strategies in limit
order books with general shape functions. Quantitative fnance, 10(2):143–157, 2010.


[6] Robert Almgren, Chee Thum, Emmanuel Hauptmann, and Hong Li. Direct estimation of
equity market impact. Risk, 18(7):58–62, 2005.


[7] Emmanuel Bacry, Adrian Iuga, Matthieu Lasnier, and Charles-Albert Lehalle. Market impacts
and the life cycle of investors orders. Market Microstructure and Liquidity, 1(02):1550009,
2015.


[8] Heinz H. Bauschke and Patrick L. Combettes. Convex analysis and monotone operator theory

in Hilbert spaces. Springer, 2017.


[9] Michael Benzaquen and Jean-Philippe Bouchaud. Market impact with multi-timescale liquidity. Quantitative Finance, 18(11):1781–1790, 2018.


[10] Serge Bernstein. Sur les fonctions absolument monotones. Acta Mathematica, 52:1–66, 1929.
doi: 10.1007/BF02592629.


[11] Nataliya Bershova and Dmitry Rakhlin. The non-linear market impact of large trades: Evidence from buy-side order flow. Quantitative fnance, 13(11):1759–1778, 2013.


[12] Jean-Philippe Bouchaud, Yuval Gefen, Marc Potters, and Matthieu Wyart. Fluctuations and
response in financial markets: the subtle nature of random price changes. Quantitative fnance,
4(2):176, 2003.


[13] Jean-Philippe Bouchaud, J. Doyne Farmer, and Fabrizio Lillo. How markets slowly digest
changes in supply and demand, 2008. URL `[https://arxiv.org/abs/0809.0822](https://arxiv.org/abs/0809.0822)` .


[14] Jean-Philippe Bouchaud, Julius Bonart, Jonathan Donier, and Martin Gould. Trades, quotes

and prices: fnancial markets under the microscope. Cambridge University Press, 2018.


[15] Fr´ed´eric Bucci, Michael Benzaquen, Fabrizio Lillo, and Jean-Philippe Bouchaud. Crossover
from linear to square-root market impact. Physical review letters, 122(10):108302, 2019.


[16] Youssef O. Chahdi, Mathieu Rosenbaum, and Gr´egoire Szymanski. A theory of passive market
impact. arXiv preprint arXiv:2412.07461, 2024.


[17] Nathan De Carvalho. Lifting Energy Markets: From Volatility Modeling to Optimal Trading.
Phd thesis, Ecole doctorale de Sciences Math´ematiques de Paris Centre (ED 386), Paris, May [´]
2025. Laboratoire de Probabilit´es, Statistique et Mod´elisation (LPSM). Supervisors: Eduardo
Abi Jaber and Huyˆen Pham.


23


[18] Jonathan Donier, Julius Bonart, Iacopo Mastromatteo, and Jean-Philippe Bouchaud. A fully
consistent, minimal model for non-linear market impact. Quantitative fnance, 15(7):1109–
1121, 2015.


[19] Nelson Dunford and Jacob T. Schwartz. Linear operators, part 1: general theory, volume 10.
John Wiley & Sons, 1988.


[20] Bruno Durin, Mathieu Rosenbaum, and Gr´egoire Szymanski. The two square root laws of market impact and the role of sophisticated market participants. arXiv preprint arXiv:2311.18283,
2023.


[21] Andrew Freyre-Sanders, Renate Guobuzaite, and Kevin Byrne. A review of trading cost
models: Reducing transaction costs. The Journal of Investing, 13(3):93–115, 2004.


[22] Xavier Gabaix, Parameswaran Gopikrishnan, Vasiliki Plerou, and H Eugene Stanley. Institutional investors and stock market volatility. The Quarterly Journal of Economics, 121(2):
461–504, 2006.


[23] Jim Gatheral. No-dynamic-arbitrage and market impact. Quantitative fnance, 10(7):749–759,
2010.


[24] Natascha Hey, Jean-Philippe Bouchaud, Iacopo Mastromatteo, Johannes Muhle-Karbe, and
Kevin Webster. The Cost of Misspecifying Price Impact. arXiv preprint arXiv:2306.00599,
2023.


[25] Natascha Hey, Iacopo Mastromatteo, Johannes Muhle-Karbe, and Kevin Webster. Trading
with concave price impact and impact decay—theory and evidence. Operations Research, 73
(3):1230–1247, 2025.


[26] Carl Hopman. Essays on the relation between stock price movements and orders. PhD thesis,
Massachusetts Institute of Technology, 2003.


[27] Peter J Huber. Robust estimation of a location parameter. In Breakthroughs in statistics:

Methodology and distribution, pages 492–518. Springer, 1992.


[28] Albert S Kyle and Anna A Obizhaeva. Large bets and stock market crashes. Review of
Finance, 2023.


[29] Peter D. Lax. Functional analysis. John Wiley & Sons, 2014.


[30] Fabrizio Lillo, J Doyne Farmer, and Rosario N Mantegna. Master curve for price-impact
function. Nature, 421(6919):129–130, 2003.


[31] Moro, Esteban and Vicente, Javier and Moyano, Luis G and Gerig, Austin and Farmer, J
Doyne and Vaglica, Gabriella and Lillo, Fabrizio and Mantegna, Rosario N. Market impact
and trading profile of hidden orders in stock markets. Physical Review E, 80(6):066102, 2009.


[32] EJ Nystr¨om. Uber die Praktische Aufl¨osung von Integralgleichungen mit Anwendungen auf [¨]
Randwertaufgaben. Acta Mathematica, 54:185–204, 1930.


[33] Anna A Obizhaeva and Jiang Wang. Optimal trading strategy and supply/demand dynamics.

Journal of Financial markets, 16(1):1–32, 2013.


24


[34] Engle Robert, Ferstenberg Robert, and Russell Jeffrey. Measuring and modeling execution
cost and risk. The Journal of Portfolio Management, 38(2):14–28, 2012.


[35] Yuki Sato and Kiyoshi Kanazawa. Does the square-root price impact law belong to the strict
universal scalings?: quantitative support by a complete survey of the Tokyo stock exchange
market. arXiv preprint arXiv:2411.13965, 2024.


[36] Michael Struwe. Variational Methods: Applications to Nonlinear Partial Diferential
Equations and Hamiltonian Systems, volume 991. Springer, 2000.


[37] Bence T´oth, Fabrizio Lillo, and J Doyne Farmer. Segmentation algorithm for non-stationary
compound poisson processes: With an application to inventory time series of market members
in a financial market. The European Physical Journal B, 78:235–243, 2010.


[38] Bence T´oth, Yves Lemperiere, Cyril Deremble, Joachim De Lataillade, Julien Kockelkoren,
and Jean-Philippe Bouchaud. Anomalous price impact and the critical nature of liquidity in
financial markets. Physical Review X, 1(2):021006, 2011.


[39] Gabriella Vaglica, Fabrizio Lillo, Esteban Moro, and Rosario N Mantegna. Scaling laws of
strategic behavior and size heterogeneity in agent dynamics. Physical Review E, 77(3):036110,
2008.

### **A Complement to numerical results**


**A.1** **Proof of Theorem 4.1**


Fix _n_ P N [˚] . Subtracting the FOC (27) satisfied by p _u,_ ˆ ˆ _r_ q to the scheme equations (35)–(36) defining
p _u_ [r] _[n]_ [s] _, r_ [r] _[n]_ [s] q yields

#
_γ_ p _u_ ˆ ´ _u_ [r] _[n]_ [s] q ` p **H** ` **G** ` **H** _ϕ,ϱ_ ` **H** [˚] _ϕ,ϱ_ [qp] _[u]_ [ˆ][ ´] _[ u]_ [r] _[n]_ [s][q “] **[ A]** [p] _[u,]_ [ˆ] [ ˆ] _[r]_ [q ´] **[ A]** [p] _[u]_ [r] _[n]_ [´][1][s] _[, r]_ [r] _[n]_ [´][1][s][q] _[,]_

` ˘ ` ˘ (44)
_r_ ˆ ´ _r_ [r] _[n]_ [´][1][s] “ U **G** p _u_ ˆ ´ ˆ _r_ q ´ U **G** p _u_ [r] _[n]_ [´][1][s] ´ _r_ [r] _[n]_ [´][1][s] q _._


On the one hand, take the inner product of the second equation from (44) against the process
_r_ ˆ ´ _r_ [r] _[n]_ [´][1][s] such that

2 ` ˘ ` ˘
_r_ ˆ ´ _r_ r _n_ ´1s “ xU **G** p _u_ ˆ ´ ˆ _r_ q ´ U **G** p _u_ [r] _[n]_ [´][1][s] ´ _r_ [r] _[n]_ [´][1][s] q _,_ ˆ _r_ ´ _r_ [r] _[n]_ [´][1][s] y
��� ���

ď U` **G** p _u_ ˆ ´ ˆ _r_ q˘ ´ U` **G** p _u_ [r] _[n]_ [´][1][s] ´ _r_ [r] _[n]_ [´][1][s] q˘ [�] _r_ ˆ ´ _r_ r _n_ ´1s
��� ����� ���

ď _L_ **G** p _u_ ˆ ´ _u_ r _n_ ´1sq ` **G** p _r_ r _n_ ´1s ´ ˆ _r_ q _r_ ˆ ´ _r_ r _n_ ´1s
��� ������ ���



_TCG_ _u_ ˆ ´ _u_ r _n_ ´1s _r_ ˆ ´ _r_ r _n_ ´1s ` _L_ ~~a~~
��� ������ ���



~~a~~
ď _L_



_TCG_ - ~~�~~ _r_ ˆ ´ _r_ r _n_ ´1s 2

  - ���



where the respective inequalities are derived by applying Cauchy-Schwartz, and by using the
Lipchitz-continuity of U, the triangular inequality, and the upper bound (16). Therefore, using (37), we deduce
_r_ ˆ ´ _r_ r _n_ ´1s ď _L_ [?] _TCG_ _u_ ˆ ´ _u_ r _n_ ´1s _._ (45)
��� ��� 1 ´ _L_ ~~[?]~~ _TCG_ ��� ���


25


On the other hand, take the inner product of the first equation from (44) with the process (ˆ _u_ ´ _u_ [r] _[n]_ [s] q
such that


2
_γ_ ��� _u_ ˆ ´ _u_ r _n_ s��� “ ´xp **H** ` **G** ` **H** _ϕ,ϱ_ ` **H** [˚] _ϕ,ϱ_ [qp] _[u]_ [ˆ][ ´] _[ u]_ [r] _[n]_ [s][q] _[,]_ [ ˆ] _[u]_ [ ´] _[ u]_ [r] _[n]_ [s][y]

` x **A** p _u,_ ˆ ˆ _r_ q ´ **A** p _u_ [r] _[n]_ [´][1][s] _, r_ [r] _[n]_ [´][1][s] q _,_ ˆ _u_ ´ _u_ [r] _[n]_ [s] y


ď **A** p _u,_ ˆ ˆ _r_ q ´ **A** p _u_ r _n_ ´1s _, r_ r _n_ ´1sq _u_ ˆ ´ _u_ r _n_ s _,_
��� ������ ���


where we used the positive semi-definite property of p **H** ` **G** ` **H** _ϕ,ϱ_ ` **H** [˚] _ϕ,ϱ_ [q][, as well as the Cauchy-]
Schwartz inequality. Therefore, we have


_γ_ _u_ ˆ ´ _u_ r _n_ s ď **A** p _u,_ ˆ ˆ _r_ q ´ **A** p _u_ r _n_ ´1s _, r_ r _n_ ´1sq
��� ��� ��� ���

“ ˇˇˇˇˇˇp **H** ` **G** qp _r_ ˆ ´ _r_ r _n_ ´1sq ` ` **Id** ` p **M** _[u]_ [r] _[n]_ [´][1][s] ˝ **G** q [˚][˘][´][1][`] p **H** ` **G** q [˚] _u_ [r] _[n]_ [´][1][s][˘]


` ˘ [ˇ]
´ **Id** ` p **M** _[u]_ [ˆ] ˝ **G** q [˚][˘][´][1][`] p **H** ` **G** q [˚] _u_ ˆ ˇˇˇˇˇ (46)



where we set



ď ~~a~~ _TCH_ ` _G_ - ~~�~~ - _r_ ˆ ´ _r_ r _n_ ´1s��� ` ��� _f_ r _n_ ´1s ´ ˆ _f_ ��� _,_ (47)


_f_ [r] _[n]_ [´][1][s] :“ ` **Id** ` p **M** _[u]_ [r] _[n]_ [´][1][s] ˝ **G** q [˚][˘][´][1][`] p **H** ` **G** q [˚] _u_ [r] _[n]_ [´][1][s][˘] _,_

_f_ ˆ :“ ` **Id** ` p **M** _[u]_ [ˆ] ˝ **G** q [˚][˘][´][1][`] p **H** ` **G** q [˚] _u_ ˆ˘ _._



Note that we have equivalently


_f_ [r] _[n]_ [´][1][s] ` p **M** _[u]_ [r] _[n]_ [´][1][s] ˝ **G** q [˚] _f_ [r] _[n]_ [´][1][s] :“ p **H** ` **G** q [˚] _u_ [r] _[n]_ [´][1][s] _,_ (48)
_f_ ˆ ` p **M** _[u]_ [ˆ] ˝ **G** q [˚] _f_ ˆ :“ p **H** ` **G** q [˚] _u._ ˆ (49)


Therefore, subtracting (49) to (48), and taking the inner product with _f_ [r] _[n]_ [´][1][s] ´ _f_ [ˆ] yields

2
��� _f_ r _n_ ´1s ´ ˆ _f_ ��� “ xp **H** ` **G** q [˚] p _u_ [r] _[n]_ [´][1][s] ´ ˆ _u_ q _, f_ [r] _[n]_ [´][1][s] ´ _f_ [ˆ] y ´ xp **M** _[u]_ [r] _[n]_ [´][1][s] ˝ **G** q [˚] _f_ [r] _[n]_ [´][1][s] ´ p **M** _[u]_ [ˆ] ˝ **G** q [˚][ ˆ] _f, f_ [r] _[n]_ [´][1][s] ´ _f_ [ˆ] y

ď ���p **H** ` **G** q˚p _u_ r _n_ ´1s ´ ˆ _u_ q������ _f_ r _n_ ´1s ´ ˆ _f_ ��� ` _C_ ��� **G** p _f_ ˆ ´ _f_ r _n_ ´1sq������ _f_ r _n_ ´1s ´ ˆ _f_ ���



_TCH_ ` _G_ - ~~�~~ - _u_ r _n_ ´1s ´ ˆ _u_ ��� ` _C_ ~~a~~



~~a~~
ď



_TCG_ - ~~�~~ _f_ ˆ ´ _f_ r _n_ ´1s _,_

  - ���



where the inequalities are respectively obtained by applying Cauchy-Schwartz, and using the
boundedness of U [1] and the bounds (16)–(17). Thus, using (37), we obtain


~~a~~



_f_ r _n_ ´1s ´ ˆ _f_ ď
��� ���



_TCH_ ` _G_
1 ´ _C_ ~~[?]~~ _TCG_



��� _u_ r _n_ ´1s ´ ˆ _u_ ��� _._ (50)



Finally, injecting (50) and (45) into (47) readily leads to



_u_ ˆ ´ _u_ r _n_ s ď _C_ ˜
��� ��� _γ_



��� _u_ r _n_ ´1s ´ ˆ _u_ ��� _,_



where _C_ [˜] is given by (38) such that p�� _u_ ˆ ´ _u_ r _n_ s��q _n_ is sub-geometric with common ratio _Cγ_ ˜ [and]

therefore converges to zero at exponential rate given by (39).


26


**A.2** **Qualitative effects of impact decay and permanent impact**


Figure 7 illustrates the qualitative effect of the impact decay parameter _ν_ P p [1] 2 _[,]_ [ 1][q][ of the power-law]

kernel _Gλ,ν_ from (5): the larger _ν_ is, the faster the decay becomes, and consequently the more
aggressive the resulting optimal trades are.


Finally, Figure 8 illustrates the qualitative effect of the _κ_ 8 P t0 _._ 5 _,_ 1 _,_ 1 _._ 5u from the permanent
impact kernel _H_ from (18): the smaller _κ_ 8 is, the smaller the permanent impact becomes, and
consequently the more aggressive the resulting optimal trades are.



















Figure 7: Optimal round-trips with different impact decay parameters _ν_ P t0 _._ 5 _,_ 0 _._ 614 _,_ 0 _._ 7 _,_ 0 _._ 8 _,_ 0 _._ 9u
used in the power-law kernel _Gλ,ν_ from (5).


27


Figure 8: Optimal round-trips with different permanent impact parameters _κ_ 8 P t0 _._ 5 _,_ 1 _,_ 1 _._ 5u used
in the permanent impact kernel _H_ from (18).

### **B Mathematical tools**


**B.1** **Completely monotone functions**


**Definition B.1** (Completely monotone function) **.** _A function G_ : p0 _,_ 8q Ñ R _is said to be com-_
_pletely monotone if G_ P _C_ [8] p0 _,_ 8q _and_


p´1q _[n]_ _G_ [p] _[n]_ [q] p _t_ q ě 0 _,_ @ _t_ ą 0 _,_ @ _n_ ě 0 _._


28


_If, in addition, G admits a (finite) right limit at_ 0 _, we extend it to_ r0 _,_ 8q _by setting G_ p0q :“
lim _t_ Ñ0` _G_ p _t_ q _._


Completely monotone functions are, in particular, nonnegative, nonincreasing, and convex on
p0 _,_ 8q. We refer to Bernstein [10] for further properties and historical background.


**Example B.2.** _On_ r0 _,_ 8q _, the following functions are completely monotone:_


  - _Exponentials: for any λ_ ě 0 _, t_ ÞÑ _e_ [´] _[λt]_ _._


  - _Finite or countable sums (or mixtures) of exponentials with nonnegative weights:_


ÿ
_G_ p _t_ q “ _ake_ [´] _[λ][k][t]_ _,_ _ak_ ě 0 _, λk_ ě 0 _,_

_k_ ě1


_whenever the series converges (e.g. pointwise for all t_ ě 0 _)._


  - _Power laws: for any α_ ą 0 _and any b_ ě 0 _, t_ ÞÑ p _b_ ` _t_ q [´] _[α]_ _._


The key structural result is that completely monotone functions are exactly Laplace transforms of
positive measures.


**Theorem B.3** (Bernstein-Widder representation) **.** _Let G_ : p0 _,_ 8q Ñ r0 _,_ 8q _be completely mono-_
_tone. Then there exists a (unique) σ-finite Borel measure µ on_ r0 _,_ 8q _such that_


ż
_G_ p _t_ q “ _e_ [´] _[λt]_ _µ_ pd _λ_ q _,_ _t_ ą 0 _._ (51)

r0 _,_ 8q


_If moreover G_ p0`q ă 8 _, then µ is a finite measure and µ_ pr0 _,_ 8qq “ _G_ p0`q _, so that_ (51) _holds for_
_all t_ ě 0 _by defining G_ p0q :“ _G_ p0`q _._


_Proof._ See Theorem 3 in [29].


**B.2** **Operators in** L [2] **and in** _L_ [2]


**Definition B.4.** _We say that an operator_ **A** _on L_ [2] _is non-anticipative if for all_ 0 ď _t_ ď _T and all_
_u, v in L_ [2] _, we have_
_u_ 1 r0 _,t_ s “ _v_ 1 r0 _,t_ s ñ **A** _u_ p _t_ q “ **A** _v_ p _t_ q _._


Non-anticipative operators on _L_ [2] play a special role because they naturally induce operators on
L [2] .


**Lemma B.5.** _Suppose that_ **A** _is a non-anticipative operator on L_ [2] _such that there exists C_ ą 0
_such that_
_∥_ **A** _u∥L_ 2 ď _C∥u∥L_ 2 _._


_For each u_ P L [2] _, we define_
**B** p _u_ qp _ω, t_ q “ **A** p _u_ p _ω,_ ¨qqp _t_ q _._


_Then_ **B** _defines an operator on_ L [2] _such that_


_∥_ **B** _u∥_ L2 ď _C∥u∥_ L2 _._


_In that case, we write_ **B** “ **A** [p] _._


29


**Lemma B.6.** _Suppose that_ **B** _is an operator on_ L [2] _for which there exists C_ ą 0 _such that_


_∥_ **B** _u∥_ L2 ď _C∥u∥_ L2


_and suppose that if u is a deterministic process, then_ **B** _u is also deterministic. Then for each_
_u_ P _L_ [2] _, we define_
**A** _u_ p _t_ q “ **B** _u_ p _t_ q _._


_Then_ **A** _defines an non-anticipative operator on L_ [2] _such that_


_∥_ **A** _u∥L_ 2 ď _C∥u∥L_ 2 _._


_In that case, we write_ **A** “ **B** [q] _. Moreover, we have_ **B** [pq] “ **B** _._


**B.3** **Fr´echet differentiability**


**Definition B.7.** _Let E and F be two Banach spaces and V be an open subset of E. An application_
_f_ : _V_ Ñ _F is said to be Fr´echet differentiable at u_ P _V if there exists a linear application Df_ p _u_ q :
_E_ Ñ _F such that the following limit holds_


lim _∥f_ p _u_ ` _h_ q ´ _f_ p _u_ q ´ _Df_ p _u_ qp _h_ q _∥F_ “ 0 _._
_∥h∥E_ Ñ0 _∥h∥E_


**Theorem B.8** (Implicit function theorem) **.** _Let X, Y, Z be Banach spaces. Let the mapping f_ :
_X_ ˆ _Y_ Ñ _Z be continuously Fr´echet differentiable in the sense of Definition B.7. Then if_ p _x_ 0 _, y_ 0q P
_X_ ˆ _Y satisfies f_ p _x_ 0 _, y_ 0q “ 0 _and if y_ ÞÑ _Df_ p _x_ 0 _, y_ 0qp0 _, y_ q _is a Banach space isomorphism from Y_
_onto Z, then there exist neighborhoods U of x_ 0 _and V of y_ 0 _and a Fr´echet differentiable function_
_g_ : _U_ Ñ _V such that f_ p _x, g_ p _x_ qq “ 0 _and f_ p _x, y_ q “ 0 _if and only if y_ “ _g_ p _x_ q _, for all_ p _x, y_ q P _U_ ˆ _V ._

### **C Study of a nonlinear Volterra equation**


**C.1** **Definition and main results.**


In this section, we are interested in the following nonlinear Volterra equation.


**Definition C.1.** _Let k_ : r0 _,_ 8q Ñ r0 _,_ 8q _be a locally integrable function such that for any t_ 0 ą 0 _,_
_we have_ ż

8



lim
_t_ Ñ _t_ 0



| _k_ p _t_ 0 ´ _s_ q ´ _k_ p _t_ ´ _s_ q| d _s_ Ñ 0 _._
0



_For T_ ą 0 _, we consider f_ : r0 _, T_ s Ñ R _and g_ : R Ñ R _. We write_ p _Ek,f,g_ q _the Volterra integral_
_Equation given by_



ż
_t_
_x_ p _t_ q `



_k_ p _t_ ´ _s_ q _g_ ` _x_ p _s_ q˘ d _s_ “ _f_ p _t_ q
0



_where x_ : r0 _, T_ s Ñ R _._


We first state the following existence and uniqueness result.


30


**Theorem C.2.** _Suppose that g is Lipschitz continuous and let T_ ą 0 _. Then, for every locally_
_bounded function f on_ r0 _, T_ s _, there exists a unique solution to_ p _Ek,f,g_ q _. Moreover, there exists a_
_constant CT_ ą 0 _, depending only on the Lipschitz constant of g, on T_ _, and on the kernel k, such_
_that for any two bounded functions f_ 1 _and f_ 2 _on_ r0 _, T_ s _, if x_ 1 _and x_ 2 _denote the corresponding_
_solutions to_ p _Ek,f_ 1 _,g_ q _and_ p _Ek,f_ 2 _,g_ q _, respectively, then we have_


_∥x_ 1 ´ _x_ 2 _∥_ 8 ď _CT ∥f_ 1 ´ _f_ 2 _∥_ 8 _._ (52)


For a given Lipschitz continuous function _g_, Theorem C.2 implies that there exists an operator
**S** _T_ : _L_ [8] pr0 _, T_ sq Ñ _L_ [8] pr0 _, T_ sq such that for every locally bounded function _f_ on r0 _, T_ s, _x_ “ **S** _T f_ is
the unique solution of p _Ek,f,g_ q. By Theorem C.2, we already know that this functional is Lipschitz
continuous in _L_ [8] pr0 _, T_ sq. This means that there exists _cT_ ą 0 such that


_cT ∥x_ 1 ´ _x_ 2 _∥L_ 8 ď �� **S** ´ _T_ 1 _[x]_ [1][ ´] **[ S]** _T_ [´][2] _[x]_ [2] �� _L_ [8] _[.]_


**C.2** **Proof of Theorem C.2**



Let _g_ be a Lipschitz continuous function, _L_ its Lipschitz constant and let _ε_ ą 0 be small enough
so that ż
_ε_



_k_ p _s_ q d _s_ ď [1]
0 2



2 _L_ _[.]_



The proof is split in two parts. First, we prove Theorem C.2 on r0 _, ε_ s. Then, we show that if
Theorem C.2 is true on r0 _, T_ s, then it also holds on r0 _, T_ ` _ε_ s. Since R is Archimedian, we can
then conclude by induction.



**Step 1.** We define



ż
T0 _x_ p _t_ q “ _t_ _k_ p _t_ ´ _s_ q _g_ ` _x_ p _s_ q˘ d _s_

0



for any function _x_ in _L_ [8] pr0 _, ε_ sq and all 0 ď _t_ ď _ε_ . This defines an operator T0 on _L_ [8] pr0 _, ε_ sq.
Moreover, for all bounded functions _x_ 0 and _x_ 1 on r0 _, ε_ s, we have



ż
_t_
|T0 _x_ 1p _t_ q ´ T0 _x_ 2p _t_ q| ď



_k_ p _t_ ´ _s_ q| _g_ ` _x_ 1p _s_ q˘ ´ _g_ ` _x_ 2p _s_ q˘| d _s_
0



ż
_t_
ď _L_

0


ż
_ε_
ď _L_



_k_ p _t_ ´ _s_ q| _x_ 1p _s_ q ´ _x_ 2p _s_ q| d _s_
0



_k_ p _s_ q d _s∥x_ 1 ´ _x_ 2 _∥_ 8
0



ď [1]

2 _[∥][x]_ [1][ ´] _[ x]_ [2] _[∥]_ [8] _[.]_



Thus, if _f_ is a bounded function on r0 _, ε_ s, the operator T [r] 0 defined on _L_ [8] pr0 _, ε_ sq by


r
T0 _x_ p _t_ q :“ _f_ p _t_ q ´ T0 _x_ p _t_ q


is a contraction of _L_ [8] pr0 _, ε_ sq and therefore admits a unique fixed point _x_ P _L_ [8] pr0 _, ε_ sq, which is
also a solution of p _Ek,f,g_ q on r0 _, ε_ s. This ensures that _I_ ` T0 is invertible, where _I_ stands here for
the identity operator on _L_ [8] pr0 _, ε_ sq, and therefore that _x_ “ p _I_ ` T0q [´][1] _f_ .


31


We now prove that p _I_ `T0q [´][1] is 2-Lipschitz continuous, which implies (52) with _T_ “ _ε_ . We consider
_f_ 1 _, f_ 2 two bounded functions on r0 _, ε_ s and we write _x_ 1 “ p _I_ ` T0q [´][1] _f_ 1 and _x_ 2 “ p _I_ ` T0q [´][1] _f_ 2. We
then have


_∥f_ 1 ´ _f_ 2 _∥_ 8 “ _∥_ p _I_ ` T0q _x_ 1 ´ p _I_ ` T0q _x_ 2 _∥_ 8
ě _∥x_ 1 ´ _x_ 2 _∥_ 8 ´ _∥_ T0 _x_ 1 ´ T0 _x_ 2 _∥_ 8 _._


We then obtain


_∥x_ 1 ´ _x_ 2 _∥_ 8 ď _∥f_ 1 ´ _f_ 2 _∥_ 8 ` _∥_ T0 _x_ 1 ´ T0 _x_ 2 _∥_ 8

ď _∥f_ 1 ´ _f_ 2 _∥_ 8 ` [1]

2 _[∥][x]_ [1][ ´] _[ x]_ [2] _[∥]_ [8] _[,]_


and thus
_∥x_ 1 ´ _x_ 2 _∥_ 8 ď 2 _∥f_ 1 ´ _f_ 2 _∥_ 8


which concludes the proof of the first step.


**Step 2.** We now assume the result holds on r0 _, T_ s and want to extend it on r0 _, T_ ` _ε_ s. To this
end, we introduce the operator T acting on _L_ [8] pr _T, T_ ` _ε_ sq functions as follows


ż
T _x_ p _t_ q “ _t_ _k_ p _t_ ´ _s_ q _g_ ` _x_ p _s_ q˘ d _s,_ _T_ ď _t_ ď _T_ ` _ε._

_T_

Proceeding as previously, this operator in 2 [1] [-Lipschitz and][ p] _[I]_ [ `][ T][q][´][1][ is invertible, where] _[ I]_ [ stands]

here for the identity operator on _L_ [8] pr _T, T_ ` _ε_ sq. Moreover, we can also prove that p _I_ ` Tq [´][1] is
2-Lipschitz continuous on _L_ [8] pr _T, T_ ` _ε_ sq.
Now, let _f_ be a bounded function on r0 _, T_ ` _ε_ s. By assumption, we know that p _Ek,f,g_ q admits a
solution _xT_ on r0 _, T_ s. Consider _f_ [r] P _L_ [8] pr _T, T_ ` _ε_ sq defined by


ż
_T_ ` ˘

r
_f_ p _t_ q “ _f_ p _t_ q ´ _k_ p _t_ ´ _s_ q _g_ _xT_ p _s_ q d _s,_ _T_ ď _t_ ď _T_ ` _ε._

0


Setting r _x_ “ p _I_ ` Tq [´][1][ r] _f_, we have for all _T_ ď _t_ ď _T_ ` _ε_



ż
_t_
_x_ rp _t_ q `



ż

_t_ _k_ p _t_ ´ _s_ q _g_ ` _x_ p _s_ q˘ d _s_ “ _f_ p _t_ q ´ _T_

_T_ 0



_k_ p _t_ ´ _s_ q _g_ ` _xT_ p _s_ q˘ d _s._
0



ş _T_
Since _xT_ is a solution of p _Ek,f,g_ q on r0 _, T_ s, we have that _f_ p _T_ q ´ 0 _[k]_ [p] _[T]_ [ ´] _[ s]_ [q] _[g]_ [p] _[x][T]_ [ p] _[s]_ [qq][ d] _[s]_ [ “] _[ x][T]_ [ p] _[T]_ [q] _[.]_
We can then define without ambiguity



_x_ p _t_ q “



#
_xT_ p _t_ q if _t_ ď _T,_


_x_ rp _t_ q if _t_ ě _T_



which is a continuous function and is, by construction, a solution of p _Ek,f,g_ q on r0 _, T_ ` _ε_ s.
It remains to prove (52). Consider _f_ 1 _, f_ 2 two bounded functions on r0 _, T_ ` _ε_ s and let _x_ 1 and _x_ 2 be
the solutions of p _Ek,f_ 1 _,g_ q and p _Ek,f_ 2 _,g_ q respectively. Therefore, restricting the solutions on r0 _, T_ s,
we know from the initial assumption that there exists a positive constant _CT_ such that


sup | _x_ 1p _t_ q ´ _x_ 2p _t_ q| ď _CT_ sup | _f_ 1p _t_ q ´ _f_ 2p _t_ q| _._
_t_ ď _T_ _t_ ď _T_


32


Now, we define _f_ [r] 1 and _f_ [r] 2 for _t_ P r _T, T_ ` _ε_ s by



so that



ż
_T_ ` ˘

r
_f_ 1p _t_ q “ _f_ 1p _t_ q ´ _k_ p _t_ ´ _s_ q _g_ _x_ 1p _s_ q d _s,_

0


ż
_T_ ` ˘

r
_f_ 2p _t_ q “ _f_ 2p _t_ q ´ _k_ p _t_ ´ _s_ q _g_ _x_ 2p _s_ q d _s_

0


p _x_ 1p _t_ qq _T_ ď _t_ ď _T_ ` _ε_ “ p _I_ ` Tq [´][1][ r] _f_ 1 _,_

p _x_ 2p _t_ qq _T_ ď _t_ ď _T_ ` _ε_ “ p _I_ ` Tq [´][1][ r] _f_ 2 _._



We then conclude using that p _I_ ` Tq [´][1] is 2-Lipschitz and that



| _f_ [r] 1p _t_ q ´ _f_ [r] 2p _t_ q| ď | _f_ 1p _t_ q ´ _f_ 2p _t_ q| ` ˇˇˇˇ


ď | _f_ 1p _t_ q ´ _f_ 2p _t_ q| ` ˇˇˇˇ



ż
_T_



ż

_T_ _k_ p _t_ ´ _s_ q _g_ ` _x_ 1p _s_ q˘d _s_ ´ _T_

0 0


ż

_T_ _k_ p _t_ ´ _s_ q _g_ ` _x_ 1p _s_ q˘ d _s_ ´ _T_

0 0



ż
_T_



_k_ p _t_ ´ _s_ q _g_ ` _x_ 2p _s_ q˘d _s_ ˇˇˇˇ
0

_T_ _k_ p _t_ ´ _s_ q _g_ ` _x_ 2p _s_ q˘d _s_ ˇˇˇˇ

0



ż
_T_

_k_ p _t_ ´ _s_ qd _s_ ˇˇˇˇ
0



ď _∥f_ 1 ´ _f_ 2 _∥_ 8 ` _L∥x_ 1 ´ _x_ 2 _∥_ 8



ˇˇˇˇ



ď _∥f_ 1 ´ _f_ 2 _∥_ 8



ˆ ż ˙
_T_
1 ` _L_ _k_ p _t_ ´ _s_ qd _s_ _._

0


### D Properties of the market resistance r [u]

**D.1** **Proof of Lemma 3.2**


We first state the following lemma which follows directly from Theorem C.2.


**Lemma D.1.** _Suppose that_ U _is Lipschitz continuous with linear growth. For each T_ ě 0 _, there_
_exists an operator_ **R** _T_ : Cpr0 _, T_ sq Ñ Cpr0 _, T_ sq _such that for each f_ : r0 _, T_ s Ñ R _, the function_
_r_ p _s_ q “ p **R** _T f_ qp _s_ q _is the unique solution of_


ˆ ż ˙
_t_
_r_ p _t_ q “ U _f_ p _t_ q ´ _G_ p _t_ ´ _s_ q _r_ p _s_ qd _s_ _._ (53)

0


_Moreover,_ **R** _T is Lipschitz continuous on_ Cpr0 _, t_ sq _and its Lipschitz constant depends only on G,_
_T and on the Lipschitz constant of_ U _._


ş _t_
_Proof._ First note that if _r_ is a solution of (53), then _x_ p _t_ q “ _f_ p _t_ q ´ 0 _[G]_ [p] _[t]_ [ ´] _[ s]_ [q] _[r]_ [p] _[s]_ [q][d] _[s]_ [ is solution]
of p _Ek,f,_ Uq. Therefore Theorem C.2 ensures that the solution of (53) is unique. Moreover, if _x_ is
a solution of p _Ek,f,_ Uq, then _r_ p _t_ q “ Up _x_ p _t_ qq is clearly a solution of (53). This ensures that we can
define an operator **R** _T_ : Cpr0 _, T_ sq Ñ Cpr0 _, T_ sq as prescribed in Lemma D.1. The Lipschitz property
of **R** _T_ follows directly from (52).


To use this result, note that since _u_ P L [2], the function _u._ p _ω_ q is in _L_ [2] for almost all _ω_ P Ω. Fix now
_ω_ P Ωsuch that it is the case. Then we know that _f_ p _ω_ q “ **G** _u_ p _ω_ q is a continuous function and
thus using Lemma D.1, we can define _r_ _[u]_ p _ω_ q “ **R** _T f_ p _ω_ q which is solution of



_rt_ _[u]_ [p] _[ω]_ [q “][ U] ´ **G** ` _u_ p _ω_ q ´ _r_ _[u]_ p _ω_ q˘


33



_t_



¯
_._


Since this is done for almost all _ω_, this allows us to build a stochastic process _r_ _[u]_ . Note that by
construction, this process is almost surely continuous. Moreover, it is also adapted, seeing that for
each _t_ P r0 _, T_ s, we have ` _rs_ _[u]_ [p] _[ω]_ [q] ˘0ď _s_ ď _t_ [“] **[ R]** _[t][f]_ [p] _[ω]_ [q “] **[ R]** _[t]_ **[G]** _[u]_ [p] _[ω]_ [q]

and **R** _t_ **G** _u_ p _ω_ q is F _t_ -measurable because p _us_ q _s_ ď _t_ is F _t_ -measurable and **G** is non-anticipative. Thus
_r_ _[u]_ is adapted and continuous, and therefore it is progressively measurable.
It remains to prove that this process belongs to L [2] . First, note that **R** _T_ 0 “ 0 because Up0q “ 0.
Then, the Lipschitz property of **R** _T_ ensures that


sup | _rt_ _[u]_ [| ď] _[ C]_ [ sup] | **G** _ut_ |
_t_ ď _T_ _t_ ď _T_


for some constant _C_ depending only on the Lipschitz constant of U, _T_ and on _G_ . Using Young’s
convolution inequality, we obtain


sup | **G** _ut_ | ď _∥G∥L_ 2pr0 _,T_ sq _∥u∥L_ 2pr0 _,T_ sq _._
_t_ ď _T_


and therefore ” ı
E _∥r_ _[u]_ _∥_ [2] _L_ [2] ď _C_ [2] _T_ _∥G∥_ [2] _L_ [2] pr0 _,T_ sq [E][r] _[∥][u][∥]_ _L_ [2] [2][s]


which is finite because _G_ P _L_ [2] pr0 _, T_ sq and Er _∥u∥_ [2] _L_ [2][s ă 8][ as] _[ u]_ [ P][ L][2][.]


**D.2** **Proof of Lemma 3.4**


The proof of Lemma 3.4 is based on the implicit function theorem recalled in Theorem B.8. We
apply this to study the Fr´echet differentiability of _u_ ÞÑ _r_ _[u]_ . For each _u_ P L [2], recall Lemma 3.2
yields the existence and uniqueness of _r_ _[u]_ P L [2] such that



_rt_ _[u]_ [“][ U] ´` **G** 2p _u_ ´ _r_ _[u]_ q˘



_t_



¯
_,_



defining unambiguously the operator **R** such that _r_ _[u]_ “ **R** p _u_ q. Let us introduce the operator
**T** : L [2] ˆ L [2] Ñ L [2] by **T** p _u, r_ q :“ _r_ ´ U` **G** p _u_ ´ _r_ q˘ _,_ _u, r_ P L [2] _,_


so that we always have
**T** ` _u,_ **R** p _u_ q˘ “ 0 _,_ _u_ P L [2] _._ (54)


We want to apply the implicit function theorem to the operator **T** to get the Fr´echet differentiability of **R** . First we need to check that **T** is Fr´echet differentiable, which is the case, since U is
differentiable, by composition of Fr´echet differentiable functions. Moreover, explicit computations
show that
_D_ **T** p _u, r_ qp _s, v_ q “ _v_ ´ U [1] p **G** p _u_ ´ _r_ qq **G** p _s_ ´ _v_ q _,_ _s, v_ P L [2] _._


Finally, when _u_ is fixed in L [2], then


` ˘ ` ˘ [¯]
_v_ ÞÑ _D_ **T** _u,_ **R** p _u_ q p0 _, v_ q “ _v_ ` U [1][´] **G** _u_ ´ **R** p _u_ q **G** _v_


which is a Banach space isomorphism from L [2] onto L [2] . Concretely, we check that for each process
_w_ P L [2], there exists a process _y_ P L [2] such that


_y_ ` U [1] p **G** p _u_ ´ _r_ _[u]_ qq **G** _y_ “ _w._ (55)


34


The existence and uniqueness of a stochastic process _v_ satisfying (55) is guaranteed by the following
lemma.


**Lemma D.2.** _For each T_ ě 0 _, there exists a continuous operator_ **Y** _T_ : Cpr0 _, T_ sq ˆ _L_ [2] pr0 _, T_ sq Ñ
_L_ [2] pr0 _, T_ sq _such that for each continuous function f on_ r0 _, T_ s _and each g in L_ [2] pr0 _, T_ sq _, y_ p _t_ q “
**Y** _T_ p _f, g_ qp _t_ q _is solution of_
_y_ p _t_ q ` _f_ p _t_ q **G** _y_ p _t_ q “ _g_ p _t_ q _._ (56)


_Moreover, the solution y of_ (56) _is unique and there exists a deterministic function ψ_ : r0 _,_ 8q Ñ
r0 _,_ 8q _such that we have_
_∥y∥L_ 2pr0 _,T_ sq ď _ψ_ p _∥f_ _∥L_ 8q _∥g∥L_ 2pr0 _,T_ sq _._ (57)


Note that P-almost all _ω_, the function _f_ p _t_ q “ U [1] p **G** p _u_ ´ _r_ _[u]_ qp _ω, t_ qq is continuous on r0 _, T_ s, bounded
by }U} _L_ 8, and _g_ “ _w_ p _ω, ._ q is well in _L_ [2] pr0 _, T_ sq. Therefore, the stochastic process _v_ defined on
r0 _, T_ s by



_v_ p _ω, t_ q “ **Y** _T_



ˆ ˙

` ˘ [¯]
U [1][´] **G** _u_ p _ω,_ ¨q ´ **R** p _u_ qp _ω,_ ¨q _, w_ p _ω,_ ¨q p _t_ q



is the unique solution of (57) for the specified function _f_ and _g_ . Furthermore, for each _t_, _v_ p¨ _, t_ q
is measurable as the composition of measurable mappings. Using the same arguments as in Section D.1, we see that the stochastic process _v_ p _ω,_ ¨q is adapted. In fact, for each 0 ď _t_ ď _T_, we
have ` ˘ ˆ´ ˘ [¯] ` ˘ ˙
_v_ p _ω, s_ q [“] **[ Y]** _[t]_ U [1][`] **G** _u_ p _ω, s_ q ´ **GR** p _u_ qp _ω, s_ q _[,]_ _w_ p _ω, s_ q



` _w_ p _ω, s_ q˘
0ď _s_ ď _t_ _[,]_



0ď _s_ ď _t_



˙



0ď _s_ ď _t_ [“] **[ Y]** _[t]_



ˆ´ ˘ [¯]
U [1][`] **G** _u_ p _ω, s_ q ´ **GR** p _u_ qp _ω, s_ q



by uniqueness of the solution of (56). The right-hand side of this identity is F _t_ -measurable because
**G** _u_, **GR** p _u_ q and _w_ are adapted, and because **Y** _t_ is a continuous application. This means that the
left hand side is also F _t_ -measurable, and in particular _v_ p _ω, t_ q is F _t_ -measurable, implicating that _v_
is adapted, Moreover, since it is continuous almost surely by construction, it is also progressively
measurable. Using (57), we know that


_∥v∥L_ 2 ď _ψ_ p��U1�� _L_ [8][q] _[∥][w][∥][L]_ [2]


almost surely, and since U [1] is deterministic and bounded we get


_∥v∥_ L2 ď _ψ_ p��U1�� _L_ [8][q] _[∥][w][∥]_ [L][2]


which ensures that _v_ P L [2] . Finally, the implicit function theorem from Theorem B.8 applies, which
shows that **R** is Fr´echet differentiable. It remains to explicitly compute _D_ **R** to conclude the proof
of Lemma 3.4. Differentiating (54), we see that _D_ **R** must satisfy


_D_ T` _u,_ **R** p _u_ q˘` _v, D_ **R** p _v_ q˘ “ 0 _,_


and therefore
_D_ **R** p _u_ qp _v_ q “ U [1][´] **G** ` _u_ ´ **R** p _u_ q˘ [¯] **G** ` _v_ ´ _D_ **R** p _u_ qp _v_ q˘ _._


Finally, we have


ˆ ` ˘ [¯] ˙´1 ` ˘ [¯]
_D_ **R** p _u_ q “ **I** ` U [1][´] **G** _u_ ´ **R** p _u_ q **G** U [1][´] **G** _u_ ´ **R** p _u_ q **G**


ˆ ` ˘ [¯] ˙´1
“ **I** ´ **I** ` U [1][´] **G** _u_ ´ **R** p _u_ q **G** _._


35


**D.3** **Poof of Lemma D.2**


The proof of Lemma D.2 is split into two parts. In the first part, we fix a continuous function _f_
on r0 _, T_ s and prove that (56) admits a solution _y_ for each continuous function _g_ on r0 _, T_ s and that
the mapping _g_ ÞÑ _y_ is Lispchitz continuous with a Lipschitz constant that only depends on _∥f_ _∥L_ 8.
In the second part of the proof, we show this can be used to conclude that the mapping **Y** _T_ is
continuous.



**Step 1.** Suppose that _f_ is a continuous function on r0 _, T_ s. We introduce _ε_ ą 0 small enough so
that ż



ż
_ε_
_∥f_ _∥L_ 2



2 _[.]_



_G_ p _s_ q d _s_ ď [1]
0 2



Similarly to the proof of Theorem C.2, we can prove that the equation (56) can be solved uniquely
on r0 _, ε_ s. Moreover, the mapping **V** _ε_ _[f]_ [defined such that for each continuous function] _[ g]_ [,] _[ y]_ [ “] **[ V]** _ε_ _[f]_ _[g]_
is the unique solution of C.2, is 2-Lipschitz continuous on _L_ [2] pr0 _, ε_ sq. Following again the proof of
Theorem C.2, we see that we can then extend this solution to a solution on r0 _, T_ s. Furthermore,
if we define **V** _t_ _[f]_ [as] **[ V]** _ε_ _[f]_ [on] _[ L]_ [2][pr][0] _[, t]_ [sq][ instead of] _[ L]_ [2][pr][0] _[, ε]_ [sq][, we see that] **[ V]** _t_ _[f]_ [is] _[ L][t]_ [-Lipschitz continuous]
on _L_ [2] pr0 _, t_ sq for some _Lt_ ą 0. Repeating the computations of the proof of Theorem C.2, we can
check that for each 0 ď _t_ ď _T_ ´ _ε_, we have



ˆ

_Lt_ ` _ε_ ď 2 1 ` _∥f_ _∥_ 8



ż
_T_

_G_ p _s_ qd _sLt_
0



˙

_._



By induction, we deduce that



_LT_ ď 2



ÿ _n_

_b_ _[k]_

_k_ “0



ş _T_
where _b_ “ 2 _∥f_ _∥_ 8 0 _[G]_ [p] _[s]_ [q][d] _[s]_ [ and] _[ n]_ [ “][ t] _[T]_ [{] _[ε]_ [u][. Therefore, we deduce that there exists an increasing]
function _ψ_ such that **V** _T_ _[f]_ [is] _[ ψ]_ [p] _[∥][f]_ _[∥]_ 8 [q][-Lipschitz continuous. In particular, we obtain that for each]
continuous function _g_, we have
��� **V** _Tf_ _[g]_ ��� _L_ [2] pr0 _,T_ sq [ď] _[ ψ]_ [p] _[∥][f]_ _[∥][L]_ [8][pr][0] _[,T]_ [ sq][q] _[∥][g][∥][L]_ [2][pr][0] _[,T]_ [ sq]


because **V** _T_ _[f]_ [p][0][q “][ 0, which proves (57).]


**Step 2.** Using the results of the first step, we see that we can always take


**Y** _T_ p _f, g_ q “ **V** _T_ _[f]_ _[g.]_


It remains to prove that this application is continuous. To do this, we prove that for _M_ ą 0,
**Y** _T_ is Lipschitz-continuous on BCpr0 _,T_ sqp0 _, M_ q ˆ B _L_ 2pr0 _,T_ sqp0 _, M_ q where B _E_ p _x, ϵ_ q denotes the ball
in _E_ centered in _x_ with radius _ϵ_ . From the first step, we know that if _f_ P BCpr0 _,T_ sqp0 _, M_ q, the
application _g_ ÞÑ **Y** _T_ p _f, g_ q is _ψ_ p _M_ q-Lipschitz continuous. Now let _f_ 1 and _f_ 2 be two continuous
functions bounded by _M_ and let _g_ P _L_ [2] pr0 _, T_ sq with _∥g∥L_ 2pr0 _,T_ sq ď _M_ . We write _yi_ “ **Y** _T_ p _fi, g_ q.
By definition, we have for all 0 ď _t_ ď _T_


_y_ 2p _t_ q ` _f_ 2p _t_ q **G** _y_ 2p _t_ q “ _g_ p _t_ q


36


which is equivalent to


_y_ 2p _t_ q ` _f_ 1p _t_ q **G** _y_ 2p _t_ q “ _g_ p _t_ q ´ p _f_ 2p _t_ q ´ _f_ 1p _t_ qq **G** _y_ 2p _t_ q _._


Therefore, we have
_y_ 2 “ **Y** _T_ p _f_ 1 _, g_ ´ p _f_ 2 ´ _f_ 1q **G** _y_ 2q _._


This implies in particular that


_∥y_ 2 ´ _y_ 1 _∥L_ 2pr0 _,T_ sq ď _∥_ **Y** _T_ p _f_ 1 _, g_ ´ p _f_ 2 ´ _f_ 1q **G** _y_ 2q ´ **Y** _T_ p _f_ 1 _, g_ q _∥L_ 2pr0 _,T_ sq
ď _ψ_ p _M_ q _∥_ p _f_ 2 ´ _f_ 1q **G** _y_ 2q _∥L_ 2pr0 _,T_ sq
ď _ψ_ p _M_ q _∥f_ 2 ´ _f_ 1 _∥L_ 8pr0 _,T_ sq _∥_ **G** _∥L_ 2pr0 _,T_ sq _∥y_ 2 _∥L_ 2pr0 _,T_ sq _._


Therefore, we have that


_∥_ **Y** _T_ p _f_ 2 _, g_ q ´ **Y** _T_ p _f_ 1 _, g_ q _∥L_ 2pr0 _,T_ sq ď _C∥f_ 2 ´ _f_ 1 _∥L_ 8pr0 _,T_ sq


with _C_ “ _Mψ_ p _M_ q _∥_ **G** _∥L_ 2pr0 _,T_ sq and thus _f_ ÞÑ **Y** _T_ p _f, g_ q is also Lipschitz continuous on BCpr0 _,T_ sqp0 _, M_ q.
Since both coordinates are Lipschitz on bounded sets, we deduce that **Y** _T_ is jointly continuous on
Cpr0 _, T_ sq ˆ _L_ [2] pr0 _, T_ sq, which completes the proof.

### **E Proof of Theorem 3.3**


First, using the linearity of U, Equation (14) rewrites


_r_ _[u]_ ` _a_ **G** _r_ _[u]_ “ _a_ **G** _u_


and therefore
_r_ _[u]_ “ **R** p _u_ q “ _a_ p **I** ` _a_ **G** q [´][1] **G** _u._


Note that the invertibility of **I** ` _a_ **G** is guaranteed by the existence and uniqueness of _r_ _[u]_ from
Lemma 3.2, or alternatively by a direct application of Theorem C.2. Now, algebraic computations
ensure that
**I** ´ **R** “ **I** ´ _a_ p **I** ` _a_ **G** q [´][1] **G** “ p **I** ` _a_ **G** q [´][1] _,_


so that the gain functional (23) rewrites



Jp _u_ q “ x _u, α_ y ´ _[γ]_




_[ϕ]_ _[ϱ]_

2 _[∥]_ **[X]** _[u][∥]_ [2][ ´] 2



_T_ [s `] _[ X]_ [0][E][r] _[S][T]_ [s] _[.]_
2 [E][rp] **[X]** _[u]_ [q][2]




_[γ]_ _[ϕ]_

2 [}] _[u]_ [}][2][ ´ x] _[u,]_ [ p] **[H]** [ `] **[ G]** [q ˝ p] **[I]** [ `] _[ a]_ **[G]** [q][´][1] _[u]_ [y ´] 2



Coercivity of the gain functional readily follows from the positive semi-definiteness of the operator
p **H** ` **G** q ˝ p **I** ` _a_ **G** q [´][1], which is guaranteed hereafter by Lemma E.1. Moreover, to prove the
_γ_ ´strong convexity of ´J, we prove equivalently the convexity of the functional


r
Jp _u_ q :“ ´Jp _u_ q ´ _[γ]_ _u_ P L [2] _,_

2 _[∥][u][∥]_ [2] _[,]_


see Bauschke and Combettes [8, Proposition 10.8]. By straightforward calculus, J is Gˆateaux
differentiable at any _u_ P L [2], with Gˆateaux gradient


_∇_ Jp _u_ q “ _α_ ´ _γu_ ´ `p **H** ` **G** q ˝ p **I** ` _a_ **G** q [´][1] ` p **H** [˚] ` **G** [˚] q ˝ p **I** ` _a_ **G** [˚] q [´][1][˘] _u_ ´ p **H** _ϕ,ϱ_ ` **H** [˚] _ϕ,ϱ_ [q] _[u.]_


37


Therefore


_∇_ J [r] p _u_ q “ ´ _α_ ` `p **H** ` **G** q ˝ p **I** ` _a_ **G** q [´][1] ` p **H** [˚] ` **G** [˚] q ˝ p **I** ` _a_ **G** [˚] q [´][1][˘] _u_ ` p **H** _ϕ,ϱ_ ` **H** [˚] _ϕ,ϱ_ [q] _[u,]_ _u_ P L [2] _._


By Bauschke and Combettes [8, Proposition 17.10], it is sufficient to show the monotonicity of _∇_ J [r]
to prove the convexity of J [r], i.e.,


x _u_ ´ _v, ∇_ J [r] p _u_ q ´ _∇_ J [r] p _v_ qy ě 0 _,_ _u, v_ P L [2] _._ (58)


By linearity, property (58) is equivalent to the positive semi-definiteness of the operators **H** _ϕ,ϱ_
and p **H** ` **G** q ˝ p **I** ` _a_ **G** q [´][1] which are proven in Abi Jaber et al. [4, Lemma 4.3] and Lemma E.1
respectively. Consequently, Abi Jaber et al. [4, Theorem 4.1 (ii)] yields the existence and uniqueness
of the optimal trading strategy ˆ _u_ satisfying (20) and the first-order condition _∇_ Jp _u_ ˆq “ 0 stated
in (24). Finally, to complete the argument, we prove the following lemma.


**Lemma E.1.** _The operator_ p **H** ` **G** q ˝ p **I** ´ **R** q _is positive semi-definite, i.e.,_


x _u,_ p **H** ` **G** q ˝ p **I** ´ **R** q _u_ y ě 0 _,_ _u_ P L [2] _._


_Proof._ Fix _u_ P L [2] . Since **I** ´ **R** “ p **I** ` _a_ **G** q [´][1], we denote _v_ “ p **I** ` _a_ **G** q [´][1] _u_ and we prove that


xp **I** ` _a_ **G** q _v,_ p **H** ` **G** q _v_ y ě 0 _._


Expanding the inner product gives


xp **I** ` _a_ **G** q _v,_ p **H** ` **G** q _v_ y “ x _v,_ _**H**_ _v_ y ` x _v,_ _**G**_ _v_ y ` _a∥_ _**G**_ _v∥_ [2] _L_ [2] pr0 _,T_ sq [`] _[ a]_ [x] _**[G]**_ _[v,]_ _**[ H]**_ _[v]_ [y] _[.]_


By the positive semi-definite property of _**H**_ and _**G**_, the first three terms are nonnegative. It
remains then to show that
x _**H**_ _v,_ _**G**_ _v_ y “ x _**V**_ _v, v_ y ě 0 (59)


where
_**V**_ :“ _**G**_ [˚] ˝ _**H**_ _._


We first prove (59) holds for when _G_ is an exponential kernel, and extend the result to all admissible
kernels as specified in Assumption A.


**Exponential kernel case.** Let _λ_ ą 0 and assume that _G_ “ _Gλ_ given by


_Gλ_ p _t_ q :“ _e_ [´] _[λt]_ _,_ _t_ ě 0 _._ (60)


Applying Fubini, we obtain for any _u_ P _L_ [2] pr0 _, T_ sq



ż
_t_
_**V**_ _u_ p _t_ q “ p _**G**_ [˚] ˝ _**H**_ _u_ qp _t_ q “

0



ż
_T_

8

_λ_ _[u]_ [p] _[r]_ [q][d] _[r]_ [ `]



_t_



ż
_T_

8

_λ_ _[e]_ [´] _[λ]_ [p] _[r]_ [´] _[t]_ [q] _[u]_ [p] _[r]_ [q][d] _[r]_ [ ´]



0



_κ_ 8

_λ_ _[e]_ [´] _[λ]_ [p] _[T]_ [ ´] _[t]_ [q] _[u]_ [p] _[r]_ [q][d] _[r]_



_κ_ 8



_κ_ 8



“ _[κ]_ [8]

_λ_



` **1** _u_ p _t_ q ` _**G**_ [˚] _u_ p _t_ q ´ _e_ [´] _[λ]_ [p] _[T]_ [ ´] _[t]_ [q] **1** _u_ p _T_ q˘



ş _t_
where **1** is the operator given by **1** _u_ p _t_ q “ 0 _[u]_ [p] _[s]_ [q][d] _[s]_ [ for every] _[ u]_ [ P] _[ L]_ [2][pr][0] _[, T]_ [sq][ and 0][ ď] _[ t]_ [ ď] _[ T]_ [. We]
then have



˙
_e_ _[λt]_ _u_ p _t_ qd _t_
0



x _**V**_ _v, v_ y “ _[κ]_ [8]

_λ_



ˆ ż
_T_
x **1** _v, v_ y ` x _**G**_ [˚] _v, v_ y ´ _e_ [´] _[λT]_



ż

_T_ _T_

_u_ p _t_ qd _t_
0 0



38


ˆ ż
_T_
x **1** _v, v_ y ` x _**G**_ _v, v_ y ´ _e_ [´] _[λT]_



˙
_e_ _[λt]_ _u_ p _t_ qd _t_ _._
0



“ _[κ]_ [8]

_λ_



“ _[κ]_ [8]



ż

_T_ _T_

_u_ p _t_ qd _t_
0 0



We define



ż
_t_
_y_ p _t_ q :“ _**G**_ _v_ p _t_ q “



ż

_t_ _t_

_e_ [´] _[λ]_ [p] _[t]_ [´] _[s]_ [q] _v_ p _s_ qd _s_ and _z_ p _t_ q :“ **1** _v_ p _t_ q “
0 0



_v_ p _s_ qd _s,_
0



so that _y_ [1] ` _λy_ “ _v_ and _z_ [1] “ _v_ . We then write



˙

_y_ p _t_ q _v_ p _t_ qd _t_ ´ _z_ p _T_ q _y_ p _T_ q _._
0



x _**V**_ _v, v_ y “ _[κ]_ [8]

_λ_



ˆ ż
_T_



ż

_T_ _T_

_z_ p _t_ q _v_ p _t_ qd _t_ `
0 0



Furthermore, we have



ż
_T_



ż

_T_ _T_

_z_ p _t_ q _v_ p _t_ qd _t_ “
0 0


ż

_T_ _T_

_y_ p _t_ q _v_ p _t_ qd _t_ “
0 0



_z_ p _t_ q _z_ [1] p _t_ qd _t_ “ [1]
0 2



_y_ p _t_ q [2] d _t_ “ [1]
0 2



2 _[z]_ [p] _[T]_ [q][2] _[,]_



ż
_T_



ż

_T_ _T_

_y_ [1] p _t_ q _y_ p _t_ qd _t_ ` _λ_
0 0



ż
_T_

[1]

2 _[y]_ [p] _[T]_ [q][2][ `] _[ λ]_



_y_ p _t_ q [2] d _t._
0



Combining these identities, we get



ż
_T_

[1]

2 _[y]_ [p] _[T]_ [q][2][ `] _[ λ]_



˙
_y_ p _t_ q [2] d _t_ ´ _z_ p _T_ q _y_ p _T_ q
0



x _**V**_ _v, v_ y “ _[κ]_ [8]

_λ_



ˆ 1



1 [1]

2 _[z]_ [p] _[T]_ [q][2][ `] 2



“ _[κ]_ [8]

2 _λ_



ż ˙
ˆ` ˘2 _T_
_z_ p _T_ q ´ _y_ p _T_ q ` 2 _λ_ _y_ p _t_ q [2] d _t_ ě 0

0



which proves (59) when _G_ “ _Gλ_ .


**Proof in the general case.** First recall that since _G_ is a completely monotone kernel in _L_ [2],
there exists a _σ_ -finite measure _µ_ such that


ż
8
_G_ p _t_ q “ _e_ [´] _[λt]_ _µ_ pd _λ_ q _,_ _t_ ě 0 _,_

0


see Theorem B.3. When _µ_ is finite, we can apply Fubini’s theorem which ensures that



ż
_t_
p _**G**_ _v_ qp _t_ q “

0



˙ ż

8 8

_e_ [´] _[λs]_ _µ_ pd _λ_ q _v_ p _t_ ´ _s_ qd _s_ “
0 0



p _**G**_ _λv_ qp _t_ q _µ_ pd _λ_ q _,_
0



ˆ ż 8



where _**G**_ _λ_ is the operator whose kernel is given by (60). Applying Fubini’s theorem again gives


ż
8
x _**H**_ _v,_ _**G**_ _v_ y “ x _**H**_ _v,_ _**G**_ _λv_ y _µ_ pd _λ_ q _._

0


We’ve already proved that x _**H**_ _v,_ _**G**_ _λv_ y ě 0 for all _λ_ ą 0 and therefore (59) holds.


When _µ_ is infinite, we first consider p _An_ q _n_ an increasing sequence of subsets on r0 _,_ 8q such that
_An_ Ñ r0 _,_ 8q and _µ_ p _An_ q ă 8. We then set _µn_ “ _µ_ 1 _An_ and


ż
8
_G_ [p] _[n]_ [q] p _t_ q “ _e_ [´] _[tλ]_ _µn_ pd _λ_ q _._

0


39


This kernel is an approximation of _G_ . In fact, we have


0 ď _G_ [p] _[n]_ [q] p _t_ q ď _G_ p _t_ q and lim
_n_ Ñ8 _[G]_ [p] _[n]_ [q][p] _[t]_ [q “] _[ G]_ [p] _[t]_ [q]


for all _t_ ě 0. Since _G_ is in _L_ [2], the dominated convergence theorem applies and we have

ż
_T_ ` ˘2

_G_ [p] _[n]_ [q] p _s_ q ´ _G_ p _s_ q d _s_ Ñ 0 _._ (61)

0


Moreover, _G_ [p] _[n]_ [q] is a completely monotone kernel and in _L_ [2] because it is bounded by _G_ . Thus, as
we have already proved, we know that x _**H**_ _v,_ _**G**_ [p] _[n]_ [q] _v_ y ě 0 where _**G**_ [p] _[n]_ [q] is the convolution operator
associated with _G_ [p] _[n]_ [q] . To conclude, it remains to show that _**G**_ [p] _**[n]**_ [q] _v_ Ñ _**G**_ _v_ in _L_ [2] pr0 _, T_ sq. In fact, we
have

ż
2 _T_
��� _**G**_ p _**n**_ q _v_ ´ _**G**_ _v_ ��� “ |p _**G**_ [p] _**[n]**_ [q] _v_ ´ _**G**_ _v_ qp _t_ q| [2] d _t_

0



ż
_T_
“

0



2
d _t_



ˇˇˇˇ



ż
_t_



_v_ p _t_ ´ _s_ q` _G_ [p] _[n]_ [q] p _s_ q ´ _G_ p _s_ q˘d _s_ ˇˇˇˇ
0



ż
_T_
ď _T_ _∥u∥_ [2]

0



` ˘2
_G_ [p] _[n]_ [q] p _s_ q ´ _G_ p _s_ q d _s_



which converges to 0 by (61).

### **F Proof of Theorem 3.6**


**F.1** **Outline of the proof**


Since L [2] is a Hilbert space, an application of Struwe [36, Theorem 1.2, Chapter 1] ensures the
existence of a maximizer of J provided ´J is coercive and weakly lower semi-continuous. Therefore,
we can conclude using the following two lemmas.


**Lemma F.1.** _Suppose that_ Ω _is countable or finite and that Assumptions B, A and C hold. Then_
J _is weakly continuous in L_ [2] _._


**Lemma F.2.** _Suppose that κ_ 8 ` _γ_ ą 0 _and that Assumptions B, A and C hold. Then_ ´J _is_
_coercive in L_ [2] _._


The proof of these two lemmas is deferred to Sections F.4 and F.3. They rely on the properties of
the operator **B** defined on L [2] by


**B** _u_ p _t_ q “ U` **G** _u_ p _t_ q˘ _,_ _t_ ě 0 _._


The properties of this operator are studied in Section F.2.


**F.2** **Properties of the operator B**


**Lemma F.3.** _We have_ **I** ´ **R** “ p **I** ` **B** q [´][1] _. Moreover, there exists c_ ą 0 _such that_


_c_ [´][1] _∥u∥_ ď ��p **I** ` **B** q´1�� ď _c∥u∥._ (62)


40


_Proof._ Note that for all _u_ P L [2], _w_ “ p **I** ´ **R** q _u_ satisfies


_w_ p _t_ q “ _u_ p _t_ q ´ _r_ _[u]_ p _t_ q “ _u_ p _t_ q ´ U` **G** _w_ p _t_ q˘


and thus _u_ “ p **I** ` **B** q _w_ . Moreover, adapting the results of Appendix C, we see that for each _u_, the
equation
_w_ p _t_ q ` U` **G** _w_ p _t_ q˘ “ _u_ p _t_ q


admits a unique solution in L [2] . This ensures that **I** ` **B** is invertible and thus **I** ´ **R** “ p **I** ` **B** q [´][1] .


To prove (62), we use the fact that both **I** ` **B** and p **I** ` **B** q [´][1] are Lipschitz, which follows readily
from the fact that **B** is Lipschitz continuous because both U and **G** are Lipschitz continuous and
from the fact that **R** is Lipschitz continuous.


Note that the operator **B** satisfies the assumptions of Lemma B.6: it is defined through a deterministic relation and thus can naturally extend to a non-anticipative operator **B** [q] in _L_ [2] . The same
holds for **R** and we also have
**I** ´ **R** [q] “ p **I** ` **B** [q] q [´][1] _._


The properties of **B** [q] are studied below.


**Lemma F.4.** _The operator_ **B** [q] _is weakly continuous in L_ [2] _._


_Proof._ Let _xn_ á _x_ . Since **G** 1 is a convolution operator, it is also compact and therefore, we know
that **G** 1 _xn_ Ñ **G** 1 _x_ . Then since U is Lipschitz continuous, we deduce that **B** [q] _xn_ Ñ **B** [q] _x_ which implies
that **B** [q] _xn_ á **B** [q] _x_ .


**Lemma F.5.** _The operator_ p **I** ` **B** [q] q [´][1] _is weakly continuous in L_ [2] _._


_Proof._ We consider _yn_ á _y_ and we define


_xn_ “ p **I** ` **B** [q] q [´][1] _yn_ and _x_ “ p **I** ` **B** [q] q [´][1] _y_


so that
_yn_ “ _xn_ ` **B** [q] _xn_ and _y_ “ _x_ ` **B** [q] _x._


We want to prove that _xn_ á _x_ . The proof is done in two steps: first we show that the sequence
p _xn_ q lies in a weak compact set, and then show that if _xnk_ á _x_ [1] for some _nk_, then we must have
_x_ [1] “ _x_ .


**Step 1:** p _xn_ q **lies in a weak compact set.** We start by showing that p _xn_ q _n_ is bounded in _L_ [2] .
As a start, we define
_rn_ “ _yn_ ´ _xn_ “ _yn_ ´ p **I** ` **B** [q] q [´][1] _yn_ “ **R** p _yn_ q _._


We know from Lemma 3.2 that **R** is Lipschitz continuous, and therefore there exists _C_ ą 0 such
that
_∥rn∥_ ď _C∥yn∥._


Therefore, we have
_∥xn∥_ “ _∥yn_ ´ _rn∥_ ď p _C_ ` 1q _∥yn∥._


41


But p _yn_ q _n_ is a bounded sequence in _L_ [2] because it is weakly convergent and therefore p _xn_ q _n_ is
bounded. This implies in turn that p _xn_ q _n_ lies in a weak compact set because every bounded and
closed set in a Hilbert space is weakly relatively compact.


**Step 2: Identification of the weak accumulation point of** p _xn_ q _n_ **.** Consider a weakly convergent subsequence of p _xn_ q, that we still write p _xn_ q for conciseness. We denote by _x_ [1] its limit and
we prove that _x_ [1] “ _x_ . By weak continuity of **B** [q], we know that


**B** q _xn_ á q **B** _x_ [1]


and thus
_yn_ “ _xn_ ` **B** [q] _xn_ á _x_ [1] ` **B** [q] _x_ [1] _._


By uniqueness of the limit, we have _y_ “ _x_ [1] ` **B** [q] _x_ [1] which implies that _x_ [1] “ p **I** ` **B** [q] q [´][1] _y_ “ _x_ .


**F.3** **Proof of Lemma F.1**


From (23), we know that



´Jp _u_ q “ ´x _u, α_ y ` _[γ]_




_[γ]_ _[ϕ]_

2 _[∥][u][∥]_ [2][ ` x] _[u,]_ [ p] **[H]** [ `] **[ G]** [q ˝ p] **[I]** [ ´] **[ R]** [q] _[u]_ [y `] 2




_[ϕ]_ _[ϱ]_

2 _[∥]_ **[X]** _[u][∥]_ [2][ `] 2



_T_ [s ´] _[ X]_ [0][E][r] _[S][T]_ [s] _[.]_
2 [E][rp] **[X]** _[u]_ [q][2]



Following Abi Jaber et al. [4, Lemma 6.2], we know that _u_ ÞÑ ´x _u, α_ y ` _[γ]_ 2 _[∥][u][∥]_ [2][ and] _[ u]_ [ ÞÑ] _[ ϕ][∥]_ **[X]** _[u][∥]_ [2][ `]

_ϱ_ Erp **X** _u_ q [2] _T_ [s][ are weakly lower semi-continuous. It remains to study] _[ u]_ [ ÞÑ x] _[u,]_ [ p] **[H]** [ `] **[ G]** [q ˝ p] **[I]** [ ´] **[ R]** [q] _[u]_ [y][.]
Lemma F.3 ensures that p **H** ` **G** q ˝ p **I** ´ **R** q “ p **H** ` **G** q ˝ p **I** ` **B** q [´][1] . This is done in two steps:


  - **Step 1.** We first study p **H** [q] ` **G** [q] q˝p **I** ` **B** [q] q [´][1] in _L_ [2] and we show that _u_ ÞÑ x _u,_ p **H** [q] ` **G** [q] q˝p **I** ´ **R** [q] q _u_ y
is weakly semi-continuous in _L_ [2] .


  - **Step 2.** We then show that weak lower semi-continuity extends to L [2] using crucially that
Ωis finite or countable.


**Proof of Step 1.** Recall first that although the operators **H** [q], **G** [q] and **B** [q] are defined on L [2], they can
be seen as operator in _L_ [2] because all these operators are defined through deterministic relations.
We are now ready to prove that _u_ ÞÑ xp **H** [q] ` **G** [q] q˝p [q] **I** ` **B** [q] q [´][1] _u, u_ y is weakly continuous in _L_ [2] . Consider
_un_ á _u_ . We want to prove that


xp **H** [q] ` **G** [q] q ˝ p [q] **I** ` **B** [q] q [´][1] _un, un_ y Ñ xp **H** [q] ` **G** [q] q ˝ p [q] **I** ` **B** [q] q [´][1] _u, u_ y _._


We have
|xp **H** [q] ` **G** [q] q ˝ p [q] **I** ` **B** [q] q [´][1] _un, un_ y ´ xp **H** [q] ` **G** [q] q ˝ p [q] **I** ` **B** [q] q [´][1] _u, u_ y| ď I ` II


where


I “ |xp **H** [q] ` **G** [q] q ˝ p [q] **I** ` **B** [q] q [´][1] _un_ ´ p **H** [q] ` **G** [q] q ˝ p [q] **I** ` **B** [q] q [´][1] _u, un_ y|

II “ |xp **H** [q] ` **G** [q] q ˝ p [q] **I** ` **B** [q] q [´][1] _u, un_ ´ _u_ y| _._


Clearly II Ñ 0 because _un_ á _u_ and p **H** [q] ` **G** [q] q ˝ p [q] **I** ` **B** [q] q [´][1] _u_ is in _L_ [2] . Moreover, using the weak
continuity of p [q] **I** ` **B** [q] q [´][1], we have


p [q] **I** ` **B** [q] q [´][1] _un_ á p [q] **I** ` **B** [q] q [´][1] _u._


42


Seeing that **H** [q] ` **G** [q] is a compact operator because it is a convolution operator, we deduce that


p **H** [q] ` **G** [q] q ˝ p [q] **I** ` **B** [q] q [´][1] _un_ Ñ p **H** [q] ` **G** [q] q ˝ p [q] **I** ` **B** [q] q [´][1] _u._


In addition, p _un_ q _n_ is bounded because it is weakly convergent, and thus


_I_ ď ���p **H** q ` q **G** q ˝ pq **I** ` q **B** q´1 _un_ ´ p **H** q ` q **G** q ˝ pq **I** ` q **B** q´1 _u_ ��� _∥un∥_ Ñ 0 _._


**Proof of Step 2.** We now prove that the weak lower semi-continuity extends to L [2] . Consider
p _un_ q _n_ a sequence of L [2] processes converging weakly to _u_ . Following the proof of Abi Jaber et al.

[4, Lemma 6.2], we see that the for P-almost all _ω_, we have


_un_ p _ω,_ ¨q á _u_ p _ω,_ ¨q in _L_ [2] _._


Therefore, applying the results of Step 1, we have, for P-almost all _ω_


xp **H** [q] ` **G** [q] q ˝ p [q] **I** ` **B** [q] q [´][1] _un_ p _ω,_ ¨q _, un_ p _ω,_ ¨qy _L_ 2pr0 _,T_ sq Ñ xp **H** [q] ` **G** [q] q ˝ p [q] **I** ` **B** [q] q [´][1] _u_ p _ω,_ ¨q _, u_ p _ω,_ ¨qy _L_ 2pr0 _,T_ sq


as _n_ Ñ 8. Using Fatou’s Lemma, we get


lim inf _n_ Ñ8 [E][rxp] **[H]** [ q] [`] **[G]** [ q] [q˝p][q] **[I]** [`] **[B]** [q] [q][´][1] _[u][n]_ [p] _[ω,]_ [ ¨q] _[, u][n]_ [p] _[ω,]_ [ ¨qy] _[L]_ [2][pr][0] _[,T]_ [ sq][s ě][ E][rxp] **[H]** [ q] [`] **[G]** [ q] [q˝p][q] **[I]** [`] **[B]** [q] [q][´][1] _[u]_ [p] _[ω,]_ [ ¨q] _[, u]_ [p] _[ω,]_ [ ¨qy] _[L]_ [2][pr][0] _[,T]_ [ sq][s] _[.]_


Using the definition of the scalar product in L [2], we deduce that


lim inf
_n_ Ñ8 [xp] **[H]** [ `] **[ G]** [q ˝ p] **[I]** [ `] **[ B]** [q][´][1] _[u][n][, u][n]_ [y][L][2][pr][0] _[,T]_ [ sq][ ě xp] **[H]** [ `] **[ G]** [q ˝ p] **[I]** [ `] **[ B]** [q][´][1] _[u, u]_ [y][L][2][pr][0] _[,T]_ [ sq] _[,]_


which exactly entails the weak lower semi-continuity of _u_ ÞÑ x _u,_ p **H** ` **G** q ˝ p **I** ´ **R** q _u_ y.


**F.4** **Proof of Lemma F.2**


From (23), we know that




_[γ]_ _[ϕ]_

2 _[∥][u][∥]_ [2][ ` x] _[u,]_ [ p] **[H]** [ `] **[ G]** [q ˝ p] **[I]** [ `] **[ B]** [q][´][1] _[u]_ [y `] 2



_T_ [s `] _[ X]_ [0][E][r] _[S][T]_ [s]
2 [E][rp] **[X]** _[u]_ [q][2]



´Jp _u_ q “ ´x _u, α_ y ` _[γ]_



ě ´x _u, α_ y ` _[γ]_




_[ϕ]_ _[ϱ]_

2 _[∥]_ **[X]** _[u][∥]_ [2][ `] 2



2 _[∥][u][∥]_ [2][ ` x] _[u,]_ [ p] **[H]** [ `] **[ G]** [q ˝ p] **[I]** [ `] **[ B]** [q][´][1] _[u]_ [y `] _[ X]_ [0][E][r] _[S][T]_ [ s] _[.]_



To prove the coercivity of ´J, we first show the following bound.


**Lemma F.6.** _For each ϵ_ ą 0 _, there exists b_ ą 0 _such that_


x _u,_ p **H** ` **G** q ˝ p **I** ` **B** q [´][1] _u_ y ě _b_ ` ´ _κ_ 8 ¯ _∥u∥_ [2] _._

2 [´] _[ ϵ]_


_Proof of Lemma F.6._ We fix _u_ P L [2] and define _v_ “ p **I** ` **B** q [´][1] _u_ so that


x _u,_ p **H** ` **G** q ˝ p **I** ` **B** q [´][1] _u_ y “ x _v_ ` **B** _v,_ p **H** ` **G** q _v_ y “ xp **H** ` **G** q _v, v_ y ` xp **H** ` **G** q _v,_ **B** _v_ y _._


We then define _U_ [r] p _x_ q “ _U_ p _x_ q ´ _δx_ where _δ_ is defined in Assumption C. Then _U_ [r] is a Lipschitz
continuous function and

r
_U_ p _x_ q

Ñ 0
_x_


43


when _x_ Ñ 8. This implies in particular that for all _ϵ_ ą 0, there exists _c_ ą 0 such that | _U_ [r] p _x_ q| ď
_c_ ` _ϵ_ | _x_ | for all _x_ P R. We now define the operator


**B** r _w_ “ r _U_ p **G** _w_ q


so that **B** “ **B** [r] ` _δ_ **G** . We then write


x _u,_ p **H** ` **G** q ˝ p **I** ` **B** q [´][1] _u_ y “ xp **H** ` **G** q _v, v_ y ` _δ_ xp **H** ` **G** q _v,_ **G** _v_ y ` xp **H** ` **G** q _v,_ **B** [r] _v_ y

“ x **H** _v, v_ y ` x **G** _v, v_ y ` _δ_ x **H** _v,_ **G** _v_ y ` _δ∥_ **G** _v∥_ [2] ` xp **H** ` **G** q _v,_ **B** [r] _v_ y _._


Using the specification of **H** in Assumption B, we have that

x **H** _v, v_ y “ _[κ]_ [8]

2 _[∥][v][∥]_ [2] _[.]_


Using (59) and the fact that **G** is semi-definite positive, we deduce that


x _u,_ p **H** ` **G** q ˝ p **I** ` **B** q [´][1] _u_ y ě _[κ]_ [8]

2 _[∥][v][∥]_ [2][ ` xp] **[H]** [ `] **[ G]** [q] _[v,]_ [ r] **[B]** _[v]_ [y] _[.]_


For the last term, we have


„ ż ȷ
_T_
|xp **H** ` **G** q _v,_ **B** [r] _v_ y| ď E |p **H** ` **G** q _v_ p _t_ q **B** [r] _v_ p _t_ q|d _t_

0



„ ż
_T_
ď _c_ E

0


„ ż
_T_
ď _c_ E



ȷ „ ż

_T_ _T_

|p **H** ` **G** q _v_ p _t_ q|d _t_ ` _ϵ_ E
0 0

_T_ ȷ ” [ż] _T_

p **H** ` **G** q| _v_ |p _t_ qd _t_ ` _ϵ_ E
0 0



ȷ

|p **H** ` **G** q _v_ p _t_ q **G** [r] _v_ p _t_ q|d _t_
0

_T_ ı

p **H** ` **G** q| _v_ |p _t_ q **G** [r] | _v_ |p _t_ q d _t_
0



From the continuity properties of **H** and **G**, we deduce that there exists _c_ 1 _, c_ 2 ą 0 such that


|xp **H** ` **G** q _v,_ **B** [r] _v_ y| ď _c_ 1 _∥v∥_ ` _c_ 2 _ϵ∥v∥_ [2]


and therefore x _u,_ p **H** ` **G** q ˝ p **I** ` **B** q [´][1] _u_ y ě ´ _κ_ 8 ¯ _∥v∥_ [2] ´ _c_ 1 _∥v∥._

2 [´] _[ c]_ [2] _[ϵ]_


We conclude using (62).


It remains to show how Lemma F.6 implies Lemma F.2. Using that _u_ and _α_ are both in L [2], then
for each _ϵ_ ą 0, there exists _b_ ą 0 such that


´ _κ_ 8 ` _γ_ ¯
´Jp _u_ q ě _b_ ` ´ _ϵ_ _∥u∥_ [2] _._

2


We can conclude whenever _κ_ 8 ` _γ_ ą 0 by taking 0 ă _ϵ_ ă _κ_ 8 ` _γ_ .


44


