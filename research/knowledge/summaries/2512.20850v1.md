# Implicit Numerical Scheme for the Hamilton–Jacobi–Bellman Quasi-Variational Inequality in the Optimal Market-Making Problem with Alpha Signal

#### Alexey Meteykin

Lomonosov Moscow State University, Vega Institute Foundation, Moscow, Russia


**Abstract:** We address the problem of combined stochastic and impulse control
for a market maker operating in a limit order book. The problem is formulated as
a Hamilton–Jacobi–Bellman quasi-variational inequality (HJBQVI). We propose
an implicit time-discretization scheme coupled with a policy iteration algorithm.
This approach removes time-step restrictions typical of explicit methods and
ensures unconditional stability. Convergence to the unique viscosity solution is
established by verifying monotonicity, stability, and consistency conditions and
applying the comparison principle.


**Keywords:** Hamilton–Jacobi–Bellman equation, combined stochastic and impulse control, implicit numerical scheme, policy iteration, viscosity solution.


1


### **1 Introduction**

Optimal control problems play an important role in modern financial mathematics. One
such problem is the optimal market making problem in a limit order book, which naturally
arises in high-frequency trading on electronic exchanges.
A market maker, as a market participant, can submit two types of orders:


  - Limit order — an instruction to buy or sell an asset at a given or more favorable
price. Such an order is posted to the limit order book and is executed when it
matches an opposite market order.


  - Market order — an instruction to immediately buy or sell an asset at the best available price in the limit order book. Market orders enable rapid position adjustments
but are executed at less favorable prices compared to limit orders.


The market maker provides liquidity to the market by placing limit buy and sell orders,
and, when necessary, uses market orders to manage risk. The profit of the market maker
arises from the spread between the buy and sell prices. The main source of risk is the
potential loss in inventory value due to adverse price movements, known as inventory risk.
To mitigate this risk, the market maker aims to maintain a near-zero inventory position.
Classical market making models, such as [1] and [6], assume that price dynamics contain no predictable components and that the market maker has no predictive information
about future price movements. In [5], this classical setup is extended by introducing an
alpha signal, a stochastic process representing the predictable component of price dynamics. This generalization allows for the possibility of extracting additional profit from
predictable price trends.
In [5], the authors formulate the market making problem with an alpha signal, derived
from the information contained in the flow of market orders, as a combined stochastic
and impulse control problem. They show that the optimal market making strategy satisfies a Hamilton–Jacobi–Bellman Quasi-Variational Inequality (HJBQVI), which is solved
numerically using an explicit time discretization scheme. However, the explicit scheme
imposes natural restrictions on the time step due to stability constraints, which in turn
increase the computational cost of the numerical solution.
In this paper, we propose an alternative numerical approach to solving the above
HJBQVI. The main idea of the proposed method is to use an implicit time discretization
scheme combined with a policy iteration algorithm. The implicit scheme is unconditionally
stable and therefore eliminates restrictions on the time step size, while the policy iteration
algorithm efficiently solves the discrete equation at each time step.
We establish convergence of the proposed implicit numerical scheme to the unique
viscosity solution of the HJBQVI by applying the general framework developed in [4].
Specifically, we verify the conditions of monotonicity, stability, and consistency, as well
as the validity of the comparison principle for the original equation. The convergence of
the policy iteration algorithm is justified using the results of [2], which provide sufficient
conditions for convergence in terms of diagonal dominance of the associated matrices and
the connectivity properties of the graph induced by the impulse control component.

### **2 Model**


Let (Ω _, F,_ **F** _,_ P) be a stochastic basis, where the filtration **F** = _{Ft}t∈_ [0 _,T_ ] is generated by
the processes _W_, _M_ [¯] [a], and _M_ [¯] [b] introduced below. The market maker operates over the
interval [0 _, T_ ] with a fixed trading horizon _T >_ 0.


2


The midprice in the order book is defined as the average of the best bid and best ask
prices. Let the midprice _S_ = ( _St_ ) _t≥_ 0 of the asset evolve as


_dSt_ = _σ_ ( _dJt_ _[↑]_ _[−]_ _[dJ]_ _t_ _[↓]_ [)] _[,]_


where _σ >_ 0 denotes the minimum price increment (tick size) in the order book. Here _J_ _[↑]_

and _J_ _[↓]_ are doubly stochastic Poisson processes with intensities


_µ_ _[↑]_ _t_ [=] _[ α]_ _t_ [+] [+] _[ θ]_ and _µ_ _[↓]_ _t_ [=] _[ α]_ _t_ _[−]_ [+] _[ θ,]_


where _θ >_ 0 is a constant and _α_ = ( _αt_ ) _t≥_ 0 is a process, referred to as the alpha signal
and capturing information about the directional component of price dynamics, will be
specified below.
The market maker may submit both limit and market orders, all having unit size.
The control for limit sell orders is an **F** -predictable process _l_ [a] = ( _lt_ [a][)] _[t][∈]_ [[0] _[,T]_ []] [with values]
in _{_ 0 _,_ 1 _}_ . A limit sell order is posted at time _t_ if _lt_ [a] [= 1][ and is not posted otherwise. Limit]
sell orders are placed at the best ask price _St_ + ∆, where ∆ _≥_ 0 represents half of the
bid–ask spread. Analogously, the process _l_ [b] = ( _lt_ [b][)] _[t][∈]_ [[0] _[,T]_ []] [controls limit buy orders, which]
are placed at the best bid price _St −_ ∆.
Let _N_ [a] = ( _Nt_ [a][)] _[t][≥]_ [0] [and] _[ N]_ [ b][ = (] _[N]_ _t_ [ b][)] _[t][≥]_ [0] [denote the counting processes for executed limit]
sell and buy orders of the market maker, respectively.
A limit sell (buy) order posted by the market maker is assumed to be executed with
probability one whenever a market buy (sell) order arrives in the market.
The control governing market orders is specified by a double sequence


_ζ_ = ( _τ_ 1 _, τ_ 2 _, . . ._ ; _z_ 1 _, z_ 2 _, . . ._ ) _,_


where 0 _≤_ _τ_ 1 _≤_ _τ_ 2 _≤· · ·_ are **F** -stopping times, and _z_ 1 _, z_ 2 _, . . . ∈{_ 1 _, −_ 1 _}_ are impulses
corresponding to these times. At time _τi_, the market maker submits a market buy order
if _zi_ = 1, and a market sell order if _zi_ = _−_ 1. Market buy orders are executed at _St_ +Υ, and
market sell orders at _St −_ Υ, where Υ = ∆+ _ε_ denotes the total cost of taking liquidity,
with _ε >_ 0 being the market order fee. Let _M_ [a] = ( _Mt_ [a][)] _[t][≥]_ [0] [and] _[ M]_ [ b][ = (] _[M]_ _t_ [ b][)] _[t][≥]_ [0] [denote the]
counting processes for the market maker’s buy and sell market orders, respectively.
Other participants also submit market orders. Let _M_ [¯] [a] = ( _M_ [¯] _t_ [a][)] _[t][≥]_ [0] [denote the Poisson]
process counting external market buy orders with intensity _λ_ [a], and _M_ [¯] [b] = ( _M_ [¯] _t_ [b][)] _[t][≥]_ [0] [the]
Poisson process counting external market sell orders with intensity _λ_ [b] .
The alpha signal _α_ = ( _αt_ ) _t≥_ 0 evolves as an Ornstein–Uhlenbeck process between jump
times of the processes _M_ [¯] _t_ [a] _[, M]_ _t_ [ a] _[,]_ [ ¯] _Mt_ [b] _[, M]_ _t_ [ b][:]


_dαt_ = _−kαtdt_ + _ρdWt_ + _γ_ [a] ( _dM_ [¯] _t_ [a] [+] _[ dM]_ _t_ [ a][)] _[ −]_ _[γ]_ [b][(] _[d]_ _M_ [ ¯] _t_ [b] [+] _[ dM]_ _t_ [ b][)] _[,]_ _α_ 0 = 0 _,_


where _W_ = ( _Wt_ ) _t≥_ 0 is a Brownian motion, and _k, ρ, γ_ [a] _, γ_ [b] _>_ 0 are constants. Each market
buy order arrival increases _αt_ by _γ_ [a], while each market sell order decreases it by _γ_ [b] . Thus,
the alpha signal reflects the imbalance between buy and sell market order flows.
We denote the market maker’s control by _ν_ = ( _l_ [a] _, l_ [b] _, ζ_ ).
The controlled inventory process _Q_ _[ν]_ = ( _Q_ _[ν]_ _t_ [)] _[t][≥]_ [0] [is given by the relation]

_Q_ _[ν]_ _t_ [=] _[ N]_ [ b] _[ −]_ _[N]_ [ a][ +] _[ M]_ [ a] _t_ _[−]_ _[M]_ [ b] _t_ [;]


the controlled cash process _X_ _[ν]_ = ( _Xt_ _[ν]_ [)] _[t][≥]_ [0] [evolves as]


_dXt_ _[ν]_ [= (] _[S][t]_ [+ ∆)] _[dN]_ _t_ [ a] _[−]_ [(] _[S][t]_ _[−]_ [∆)] _[dN]_ _t_ [ b] _[−]_ [(] _[S][t]_ [+ Υ)] _[dM]_ _t_ [ a] [+ (] _[S][t]_ _[−]_ [Υ)] _[dM]_ _t_ [ b] _[.]_


3


The set of admissible controls _A_ includes all _ν_ = ( _l_ [a] _, l_ [b] _, ζ_ ) such that the inventory
remains bounded, that is _Q_ _[ν]_ _t_ _[∈]_ [[] _[−][Q, Q]_ []][ for all] _[ t][ ∈]_ [[0] _[, T]_ []][ for some integer] _[ Q >]_ [ 0][, and the]
impulse control _ζ_ does not trigger simultaneous buy and sell market orders.
We define the state process _Y_ _[ν]_ = �( _Xt_ _[ν][, S][t][, α][t][, Q]_ _t_ _[ν]_ [)]  - _t∈_ [0 _,T_ ] [, and use the shorthand]

_y_ = ( _x, s, α, q_ ). The performance is measured by the functional



�� _T_             _J_ _[ν]_ ( _t, y_ ) = E _[t,y]_ _f_ ( _r, Yr_ _[ν]_ [)] _[dr]_ [ +] _[ g]_ [(] _[T, Y]_ _T_ _[ ν]_ [)] _,_

_t_

_f_ ( _t, y_ ) = _−ϕq_ [2] _,_ _g_ ( _t, y_ ) = _x_ + _q_ ( _s −_ Υ sign _q_ ) _−_ _ψq_ [2] _,_


where E _[t,y]_ [ _·_ ] denotes conditional expectation given _Xt_ _[ν]_ _−_ [=] _[ x]_ [,] _[ S][t]_ _−_ [=] _[ s]_ [,] _[ α]_ _t_ _[ν]_ _−_ [=] _[ α]_ [,] _[ Q]_ _t_ _[ν]_ _−_ [=] _[ q]_ [,]
and _ψ, ϕ >_ 0 are constants.
The running cost _f_ ( _t, y_ ) = _−ϕq_ [2] penalizes nonzero inventory levels, reflecting the
exposure to adverse price movements. The terminal reward _g_ ( _t, y_ ) represents the liquidation value at the terminal date, consisting of the current cash balance _x_ and the proceeds
_q_ ( _s −_ Υ sign _q_ ) _−_ _ψq_ [2] obtained upon liquidating the remaining position with a market
order. The quadratic term _−ψq_ [2] accounts for additional costs due to insufficient liquidity
at the best available quote in the order book.
The optimization problem is formulated as a combined stochastic and impulse maximization problem with the value function


_u_ ( _t, y_ ) = sup _J_ _[ν]_ ( _t, y_ ) _._ (1)
_ν∈A_


The dimension of the problem can be reduced to three variables by applying the
substitution
_u_ ( _t, x, s, α, q_ ) = _x_ + _qs_ + _v_ ( _t, α, q_ ) _,_ (2)


where the value function _u_ ( _t, x, s, α, q_ ) decomposes into three components: the accumulated cash _x_, the current mark-to-market value _qs_ of the inventory, and the residual
function _v_ ( _t, α, q_ ) representing the expected additional profit generated on [ _t, T_ ] under
the optimal strategy.
As shown in [5], the value function (1) is the unique viscosity solution to the corresponding Hamilton–Jacobi–Bellman Quasi-Variational Inequality (HJBQVI), which, under substitution (2), takes the form

    - _∂v_  -  - [�]
max sup [+] _[ L][l]_ [a] _[,l]_ [b] _[v]_ [ + ˜] _[f][ l]_ [a] _[,l]_ [b][�] _,_ sup _M_ _[z]_ _v −_ _v_ = 0 _,_ _t ∈_ [0 _, T_ ) _,_



= 0 _,_ _t ∈_ [0 _, T_ ) _,_








- - [�]
_M_ _[z]_ _v −_ _v_



(3)



max



sup
_lt_ [a] _[,l]_ _t_ [b] _[∈{]_ [0] _[,]_ [1] _[}]_




- _∂v_



_∂v_ _,_ sup

_∂t_ [+] _[ L][l]_ [a] _[,l]_ [b] _[v]_ [ + ˜] _[f][ l]_ [a] _[,l]_ [b][�]
_z∈{_ 1 _,−_ 1 _}_



 _v_ ( _T, α, q_ - = ˜ _g_ ( _T, α, q_ - _,_



where



_L_ _[l]_ [a] _[,l]_ [b] _v_ ( _t, α, q_ - = _−kα_ _[∂v]_




     
_[∂v]_ + [1]

_∂α_ [(] _[t, α, q]_ 2




[1]

2 _[ρ]_ [2] _[ ∂]_ _∂α_ [2] _[v]_ [2]




     _∂α_ [2] [(] _[t, α, q]_




  
            -             -             - [�]
+ _λ_ [a] 1 _{lt_ [a][=0] _[}][v]_ [(] _[t, α]_ [ +] _[ γ]_ [a] _[, q]_ + 1 _{lt_ [a][=1] _[}][v]_ [(] _[t, α]_ [ +] _[ γ]_ [a] _[, q][ −]_ [1] _−_ _v_ ( _t, α, q_


  
            -             -             - [�]
+ _λ_ [b] 1 _{lt_ b [=0] _[}][v]_ [(] _[t, α][ −]_ _[γ]_ [b] _[, q]_ + 1 _{lt_ b [=1] _[}][v]_ [(] _[t, α][ −]_ _[γ]_ [b] _[, q]_ [ + 1] _−_ _v_ ( _t, α, q_ _,_



_M_ _[z]_ _v_ ( _t, α, q_ - =




- _v_ ( _t, α, q_ + 1� _−_ Υ _,_ _z_ = 1 _,_
_v_ ( _t, α, q −_ 1� _−_ Υ _,_ _z_ = _−_ 1 _,_



_f_ ˜ _[l]_ [a] _[,l]_ [b] ( _t, α, q_ - = _ασq −_ _ϕq_ [2] + 1 _{lt_ [a][=1] _[}][λ]_ [a][∆+][ 1] _[{][l]_ _t_ [b][=1] _[}][λ]_ [b][∆] _[,]_

_g_ ˜( _t, α, q_  - = _−_ Υ _q_ sign _q −_ _ψq_ [2] _._


4


### **3 Numerical scheme**

Let _{tn}_ _[N]_ _n_ =0 [be a uniform time grid with step size] _[ δt >]_ [ 0][ on the interval][ [0] _[, T]_ []][, and let]
_{αi}_ _[N]_ _i_ = _[α]_ _−Nα_ [be a uniform grid with step size] _[ δα >]_ [ 0][ on][ [] _[−][A, A]_ []][ for some] _[ A >]_ [ 0][. The]
inventory variable _q_ takes values in the grid with unit spacing _{qj}_ _[N]_ _j_ = _[q]_ _−Nq_ [= [] _[−][Q, Q]_ []] _[ ∩]_ [Z][.]
Since the shifted values _α_ + _γ_ [a] and _α −_ _γ_ [b] may not coincide with grid points in _α_, the
value _v_ ( _t, α, q_ ) for _α ∈_ [ _−A, A_ ] _\ {αi}_ _[N]_ _i_ = _[α]_ _−Nα_ [is linearly interpolated between the nearest]
grid points. For _α > A_, the value _v_ ( _t, α, q_ ) is linearly extrapolated using _v_ ( _t, A −_ _δα, q_ )
and _v_ ( _t, A, q_ ), and analogously for _α < −A_ . In equation (3), the process _α_ is replaced
with its truncated version


~~_α_~~ _t_ = min _{A,_ max _{−A, αt}}._


The partial derivatives are approximated by finite differences as follows:



_∂v_

_∂t_ [(] _[t, α, q]_ [)] _[ ∼]_ _[v]_ [(] _[t]_ [ +] _[ δt, α, q]_ _δt_ [)] _[ −]_ _[v]_ [(] _[t, α, q]_ [)]



_∂v_



_,_
_δt_



_−kα_ _[∂v]_

_∂α_ [(] _[t, α, q]_ [)] _[ ∼]_




- _−kα_ _[v]_ [(] _[t,α]_ [+] _[δα,q]_ [)] _[−][v]_ [(] _[t,α,q]_ [)]



_−kα_ _,_ _α ≤_ 0 _,_

_δα_
_−kα_ _[v]_ [(] _[t,α,q]_ [)] _[−][v]_ [(] _[t,α][−][δα,q]_ [)] _,_ _α ≥_ 0 _,_



_,_ _α ≥_ 0 _,_
_δα_



_∂_ [2] _v_

_._

_∂α_ [2] [(] _[t, α, q]_ [)] _[ ∼]_ _[v]_ [(] _[t, α]_ [ +] _[ δα, q]_ [)] _[ −]_ [2] _[v]_ [(] _δα_ _[t, α, q]_ [2] [) +] _[ v]_ [(] _[t, α][ −]_ _[δα, q]_ [)]



The boundary condition on the second derivative with respect to _α_ is given by


_∂_ [2] _v_ _∂_ [2] _v_
and
_∂α_ [2] [(] _[t,][ −][A, q]_ [) = 0] _∂α_ [2] [(] _[t, A, q]_ [) = 0] _[.]_



For convenience, denote _ln_ [a] [=] _[ l]_ _t_ [a] _n_ [,] _[ l]_ _n_ [b] [=] _[ l]_ _t_ [b] _n_ [,] _[ v][n]_ [ =] _[ v]_ [(] _[t][n][, α, q]_ [)][, and][ ˜] _[f][ l]_ [a] _[,l]_ [b] _[,n]_ [ = ˜] _[f][ l]_ [a] _[,l]_ [b][(] _[t][n][, α, q]_ [)][.]
The discrete form of the HJBQVI (3) reads:

 max sup - _v_ _[n]_ [+1] _−v_ _[n]_ + _L_ _[l]_ [a] _[,l]_ [b] _v_ _[n]_ + _f_ [˜] _[l]_ [a] _[,l]_ [b] _[,n]_ [�] _,_ sup - _B_ _[z][v][n][ −]_ [Υ] - [�] = 0 _,_ _n < N,_








- - [�]
_Bδ_ _[z][v][n][ −]_ [Υ]



= 0 _,_ _n < N,_



max



sup
_ln_ [a] _,ln_ [b] _∈{_ 0 _,_ 1 _}_




- _v_ _[n]_ [+1] _−v_ _[n]_



_δt−v_ _[n]_ + _L_ _[l]_ _δ_ [a] _[,l]_ [b] _v_ _[n]_ + _f_ [˜] _[l]_ [a] _[,l]_ [b] _[,n]_ [�] _,_ sup
_z∈{_ 1 _,−_ 1 _}_



 _v_ ( _T, α, q_  - = ˜ _g_ ( _T, α, q_  - _,_

(4)
where



_v_ ( _t, α_ + _δα, q_ ) _−_ _v_ ( _t, α, q_ )
_L_ _[l]_ _δ_ [a] _[,l]_ [b] _v_ ( _t, α, q_ ) = _k_ ~~_α_~~ _−_



) _−_ _v_ ( _t, α, q_ ) _v_ ( _t, α, q_ ) _−_ _v_ ( _t, α −_ _δα, q_ )

_−_ _k_ ~~_α_~~ +
_δα_ _δα_



_δα_



+ _[ρ]_ [2]



_δα_ [2]




_[ρ]_ [2] _v_ ( _t, α_ + _δα, q_ ) _−_ 2 _v_ ( _t, α, q_ ) + _v_ ( _t, α −_ _δα, q_ )

2 _δα_ [2]




  -  + _λ_ [a] 1 _{ln_ a =0 _}I_ [+] _v_ ( _t, α, q_ ) + 1 _{ln_ a =1 _}I_ [+] _v_ ( _t, α, q −_ 1) _−_ _v_ ( _t, α, q_ )


  -  + _λ_ [b] 1 _{ln_ b =0 _}I_ _[−]_ _v_ ( _t, α, q_ ) + 1 _{ln_ b =1 _}I_ _[−]_ _v_ ( _t, α, q_ + 1) _−_ _v_ ( _t, α, q_ ) _,_



_Bδ_ _[z][v]_ [(] _[t, α, q]_ [) =]




_v_ ( _t, α, q_ + 1) _−_ _v_ ( _t, α, q_ ) _,_ _z_ = 1 _,_

_v_ ( _t, α, q −_ 1) _−_ _v_ ( _t, α, q_ ) _,_ _z_ = _−_ 1 _._


5


The operators _I_ [+] and _I_ _[−]_ perform linear interpolation with respect to _α_ :




     -     - _γ_ a
_I_ [+] _v_ ( _t, α, q_ ) = _v_ _t, α_ +

_δα_




- _δα, q_



_γ_ a - _γ_ a

_δα_ _[−]_ _δα_



�� [�]




- - [�]
_δα, q_ _,_




 - _γ_ a
+



_δα_




 - - _γ_ a
_v_ _t, α_ +



_δα_




- - - - _γ_ a
_δα, q_ _−_ _v_ _t, α_ +

_δα_




     -     - _γ_ b
_I_ _[−]_ _v_ ( _t, α, q_ ) = _v_ _t, α −_

_δα_




- _δα, q_




 - _γ_ b
+



_δα_




- - [�]
_δα, q_ _._



_γ_ b - _γ_ b

_δα_ _[−]_ _δα_



�� [�]




 - - _γ_ b
_v_ _t, α −_



_δα_




- - - - _γ_ b
_δα, q_ _−_ _v_ _t, α −_

_δα_


### **4 Policy iteration**

To solve the discrete equation (4), we use the policy iteration algorithm. This algorithm
addresses problems of the form



sup
_P_ _∈P_




- 
_−_ _A_ ( _P_ ) _v_ + _b_ ( _P_ ) = 0 _,_ (5)



where _A_ ( _P_ ) is an _M × M_ matrix, _b_ ( _P_ ) and _v_ are vectors of length _M_, and _P_ denotes the
set of admissible policies.


**Algorithm 1** Policy Iteration

1: _r >_ 0 — tolerance level
2: _v_ [0]  - initial guess
3: **for** _k_ = 0 _,_ 1 _,_ 2 _, . . ._ **do**




- 
_−_ _A_ ( _P_ ) _v_ _[k]_ + _b_ ( _P_ )



4: _P_ _[k]_ = arg max
_P_ _∈P_



5: Solve the linear system _A_ ( _P_ _[k]_ ) _v_ _[k]_ [+1] = _b_ ( _P_ _[k]_ )



6: **if** max
_i_



_vi_ _[k]_ [+1] _−_ _vi_ _[k]_
���� _vi_ _[k]_ [+1]



_< r_ **then**
����



7: break
8: **end if**
9: **end for**



The terminal condition _v_ ( _T, α, q_ ) = ˜ _g_ ( _T, α, q_ ) of equation (4) is specified at _t_ = _T_ .
Proceeding backward in time, for each _n ∈{N −_ 1 _, N −_ 2 _, . . .,_ 1 _}_, the solution _v_ _[n]_ is
obtained by solving problem (5) with the corresponding matrices _A_ ( _P_ ) and vectors _b_ ( _P_ ).
Fix _n ∈{N −_ 1 _, N −_ 2 _, . . .,_ 1 _}_ and set _M_ = (2 _Nα_ + 1)(2 _Nq_ + 1).
The set of admissible policies _P_ in the present problem is given by


_P_ = _W × Z × D,_



where



_M_

- _{_ 0 _,_ 1 _}._


_i_ =1



_M_

- _{_ 1 _, −_ 1 _},_ _D_ =


_i_ =1



_W ⊂_



_M_



_i_ =1




- _{_ 0 _,_ 1 _} × {_ 0 _,_ 1 _}_ _,_ _Z ⊂_



Therefore, a policy _P_ = ( _w, z, d_ ) _∈P_ consists of three components. Namely, the
vector _w_ = ( _w_ 1 _, . . ., wM_ ) _∈W_ corresponds to the stochastic control ( _ln_ [a] _[, l]_ _n_ [b][)][ at each grid]
point, the vector _z_ = ( _z_ 1 _, . . ., zM_ ) _∈Z_ represents the impulses, and the components of


6


the vector _d_ = ( _d_ 1 _, . . ., dM_ ) _∈D_ are indicators of impulse application. Let _D_ denote the
diagonal matrix with _d_ = ( _d_ 1 _, . . ., dM_ ) on the diagonal.
To express equation (4) in the form (5), we write _A_ ( _P_ ) and _b_ ( _P_ ) as


                  -                  -                  
              -               - [�]
_A_ ( _P_ ) = _I −_ _D_ _I −_ _L_ ( _w_ ) + _D_ _I −_ _B_ ( _z_ ) _,_


_b_ ( _P_ ) =            - _I −_ _D_            - _c_ ( _w_ ) + _Dk_ ( _z_ ) _,_


where


_L_ ( _w_ ) = _Lδ_ _[l]_ [a] _[,l]_ [b] _δt,_ _c_ ( _w_ ) = _v_ _[n]_ [+1] + _f_ [˜] _[l]_ [a] _[,l]_ [b] _[,n]_ _δt,_
_B_ ( _z_ ) = _I_ + _Bδ_ _[z][,]_ _k_ ( _z_ ) = _−_ Υ _._


To prove convergence of the policy iteration algorithm to the unique solution of equation (4), we use the theorem from [2]. For this purpose, several definitions are introduced
below.
Let _A_ = ( _aij_ ) _∈_ R _[M]_ _[×][M]_ be a real matrix.


**Definition.** The graph of a matrix _A_ is a graph with vertices _{_ 1 _, . . ., M_ _}_, where vertices
_i_ and _j_ are connected by an edge if _aij ̸_ = 0.


**Definition.** A matrix _A_ is a _Z_ -matrix if _aij ≤_ 0 for all _i ̸_ = _j_ .



**Definition.** A matrix _A_ is strictly (weakly) diagonally dominant if _|aii| >_

[�]



**Definition.** A matrix _A_ is strictly (weakly) diagonally dominant if _|aii| >_ [�] _j_ = _i_ _[|][a][ij][|]_

( _|aii| ≥_ [�] _[|][a][ij][|]_ [) for all] _[ i]_ [.]



_j_ = _i_ _[|][a][ij][|]_ [) for all] _[ i]_ [.]



**Theorem 4.1** (Convergence of policy iteration) **.** _Assume that the following conditions_
_hold:_


_1. P �→_ _A_ ( _P_ ) _[−]_ [1] _is bounded._


_2. A and b are bounded, and for every x ∈_ R _[M]_ _there exists a policy Px ∈P such that_
_−A_ ( _Px_ ) _x_ + _b_ ( _Px_ ) = sup _P_ _∈P{−A_ ( _P_ ) _x_ + _b_ ( _P_ ) _}._


_3. For each P_ = ( _w, z, d_ ) _∈P and vertex i with di_ = 1 _, there exists a path in the graph_
_of the matrix B_ ( _z_ ) _from i to a vertex j with dj_ = 0 _._


_4. For each P_ = ( _w, z, d_ ) _∈P, the matrices I −_ _L_ ( _w_ ) _and I −_ _B_ ( _z_ ) _are Z-matrices with_
_nonnegative diagonal elements. The matrix I_ _−L_ ( _w_ ) _is strictly diagonally dominant,_
_and the matrix I −_ _B_ ( _z_ ) _is weakly diagonally dominant._


_Then the sequence_ ( _v_ _[k]_ ) _[∞]_ _k_ =0 _[produced by the policy iteration algorithm (Algorithm 1) is]_
_nondecreasing and converges to the unique solution v of problem (5). Moreover, if P is_
_finite, convergence occurs in at most |P| iterations (v_ _[|P|]_ = _v_ _[|P|]_ [+1] = _· · · )._


In the context of the present problem, conditions (1) and (2) hold because the set of
admissible policies _P_ is finite.
To verify condition (3), note that by admissibility of the control, the inventory satisfies
_q ∈_ [ _−Q, Q_ ], and simultaneous buy and sell market orders are not allowed.
Consider a state _i ∈{_ 1 _, . . ., M_ _}_ in the graph of the matrix _B_ ( _z_ ) such that _di_ = 1.
Suppose _zi_ = 1, which corresponds to a market buy order. Then there is an edge between
nodes _i_ and _i_ +1, and either _di_ +1 = 0, in which case the required path is found, or _di_ +1 = 1
and _zi_ +1 = 1. As we move from _i_ to _i_ + 1, the inventory _q_ increases by one. Repeating
this argument, we eventually reach a vertex _j_ with _dj_ = 0, where _q_ = _Q_ and a further
increase in inventory is impossible.


7


The case _zi_ = _−_ 1, corresponding to a market sell order, is treated symmetrically.
To verify condition (4), we regroup the terms in the operator _L_ _[l]_ _δ_ [a] _[,l]_ [b] :




     _Lδ_ _[l]_ [a] _[,l]_ [b] = _v_ ( _t, α, q_ ) _−_ _[k]_ ~~_[α]_~~ _[−]_




~~_[α]_~~ [+]

_δα_ _[−]_ _δα_ _[ρ]_ [2]




~~_[α]_~~ _[−]_

_δα_ _[−]_ _[k]_ _δα_ ~~_[α]_~~ [+]




_[ρ]_ [2]  
_[−]_ _[λ]_ [a] _[ −]_ _[λ]_ [b]
_δα_ [2]



~~_α_~~ _−_ _ρ_ [2]

_δα_ [+] 2 _δα_




     - _k_ ~~_α_~~ _−_
+ _v_ ( _t, α_ + _δα, q_ )



2 _δα_ [2]




- - _k_ ~~_α_~~ +
+ _v_ ( _t, α −_ _δα, q_ )



2 _δα_ [2]







~~_α_~~ + _ρ_ [2]

_δα_ [+] 2 _δα_




      -       + _λ_ [a] 1 _{ln_ a =0 _}I_ [+] _v_ ( _t, α, q_ ) + 1 _{ln_ a =1 _}I_ [+] _v_ ( _t, α, q −_ 1)


      -      + _λ_ [b] 1 _{ln_ b =0 _}I_ _[−]_ _v_ ( _t, α, q_ ) + 1 _{ln_ b =1 _}I_ _[−]_ _v_ ( _t, α, q_ + 1) _._


Hence, the diagonal entry of the matrix _I −_ _L_ ( _w_ ) has the form




  - _k_ ~~_α_~~ _−_
1 + _δt_




~~_[α]_~~ [+]

_[ρ]_ [2]
_δα_ [+] _δα_



~~_α_~~ _−_

_[k]_ ~~_[α]_~~ [+]
_δα_ [+] _δα_




_[ρ]_ [2] [+] _[ λ]_ [a][ +] _[ λ]_ [b]  - _>_ 0 _,_

_δα_ [2]



and thus _I −_ _L_ ( _w_ ) is indeed a strictly diagonally dominant _Z_ -matrix with nonnegative
diagonal elements.
The matrix _I −_ _B_ ( _z_ ) also satisfies the required properties, since its rows are either
zero or contain a diagonal element equal to one and one adjacent element equal to _−_ 1,
with all other entries equal to zero.
Therefore, the sufficient conditions of Theorem 4.1 are satisfied, and the policy iteration algorithm numerically yields the unique solution _v_ _[n]_ of equation (4) for each
_n ∈{N −_ 1 _, N −_ 2 _, . . .,_ 1 _}_ .

### **5 Convergence of the numerical scheme**


To prove convergence of the solution of the discrete equation (4) to the viscosity solution of
equation (3), we employ the general framework for proving convergence of finite-difference
approximations to viscosity solutions of partial differential equations, developed in [4].
We rewrite the numerical scheme (4) using the notation introduced in [4, 3]:


_S_ ( _δ, x, v_ _[δ]_ ( _x_ ) _,_ [ _v_ _[δ]_ ] _x_ ) = 0 _,_ _x ∈_ Ω _,_ (6)


where Ω= [0 _, T_ ] _×_ R _×_ ([ _−Q, Q_ ] _∩_ Z), _S_ : R [+] _×_ Ω _×_ R _× Cb_ [1] _[,]_ [2][(Ω)] _[ →]_ [R][,] _[ δ]_ [ = (] _[δt, δα]_ [)][ is the]
grid step, _v_ _[δ]_ : Ω _→_ R denotes the solution of (6) and an approximation of _v_, and [ _v_ _[δ]_ ] _x_
coincides with _v_ _[δ]_ at all points except _x_,




[ _v_ _[δ]_ ] _x_ ~~(~~ ~~_x_~~ ~~)~~ :=




_v_ _[δ]_ ~~(~~ ~~_x_~~ ~~)~~ _,_ ~~_x_~~ = _x,_

0 _,_ ~~_x_~~ = _x._



**Proposition 5.1** (Monotonicity) **.** _Let u, w ∈_ _Cb_ [1] _[,]_ [2] �Ω ~~�~~ _be such that u ≥_ _w. Then, for all_

_δ_ = ( _δt, δα_ ) _∈_ R [+] _×_ R [+] _, x ∈_ Ω _, and r ∈_ R _,_


_S_ ( _δ, x, r, u_ ) _≥_ _S_ ( _δ, x, r, w_ ) _._


_Proof._ Consider a grid point _x_ _[n]_ _ij_ [= (] _[t][n][, α][i][, q][j]_ [)][. Let] _[ u, w][ ∈]_ _[C]_ _b_ [1] _[,]_ [2][(Ω)][ be such that] _[ u][ ≥]_ _[w]_ [ and]
_u_ _[n]_ _ij_ [=] _[ w]_ _ij_ _[n]_ [=] _[ r]_ [, where] _[ u]_ _ij_ _[n]_ [=] _[ u]_ [(] _[t][n][, α][i][, q][j]_ [)][ and] _[ w]_ _ij_ _[n]_ [=] _[ w]_ [(] _[t][n][, α][i][, q][j]_ [)][. Denote][ [] _[u]_ []] _ij_ _[n]_ [:= [] _[u]_ []] _[x][n]_ _ij_ [. If]
_tn_ = _T_, then


_S_ ( _δ, x_ _[n]_ _ij_ _[, u][n]_ _ij_ _[,]_ [ [] _[u]_ []] _[n]_ _ij_ [)] _[ −]_ _[S]_ [(] _[δ, x][n]_ _ij_ _[, w]_ _ij_ _[n]_ _[,]_ [ [] _[w]_ []] _[n]_ _ij_ [) = ˜] _[g]_ [(] _[T, α][i][, q][j]_ [)] _[ −]_ _[g]_ [˜][(] _[T, α][i][, q][j]_ [) = 0] _[.]_


8


If _tn < T_, then


_S_ ( _δ, x_ _[n]_ _ij_ _[, u][n]_ _ij_ _[,]_ [ [] _[u]_ []] _[n]_ _ij_ [)] _[ −]_ _[S]_ [(] _[δ, x][n]_ _ij_ _[, w]_ _ij_ _[n]_ _[,]_ [ [] _[w]_ []] _[n]_ _ij_ [)]




  = max sup
_ln_ [a] _,ln_ [b] _∈{_ 0 _,_ 1 _}_


because




- _unij_ +1 _−δt_ _wij_ _[n]_ [+1] + - _L_ _[l]_ _δ_ [a] _[,l]_ [b] ( _u −_ _w_ ) _[n]_ [�]



_ij_




_,_ sup
_z∈{_ 1 _,−_ 1 _}_



��
_Bδ_ _[z]_ [(] _[u][ −]_ _[w]_ [)] _[n]_ [�] _ij_




- [�]
_≥_ 0 _,_





2




- _L_ _[l]_ _δ_ [a] _[,l]_ [b] ( _u −_ _w_ ) _[n]_ [�]




  -  - [�] _k_ ~~_α_~~ _−_
_ij_ [=] _u_ ( _tn, αi_ + _δα, qj_ ) _−_ _w_ ( _tn, αi_ + _δα, qj_ )



~~_α_~~ _−_

_[ρ]_ [2]
_δα_ [+] 2



~~_α_~~ +

_[ρ]_ [2]
_δα_ [+] 2




 - - [�] _k_ ~~_α_~~ +
+ _u_ ( _tn, αi −_ _δα, qj_ ) _−_ _w_ ( _tn, αi −_ _δα, qj_ )



2








      -       + _λ_ [a] 1 _{lt_ [a][=0] _[}][I]_ [+][(] _[u][ −]_ _[w]_ [)(] _[t][n][, α][i][, q][j]_ [) +][ 1] _[{][l]_ _t_ [a][=1] _[}][I]_ [+][(] _[u][ −]_ _[w]_ [)(] _[t][n][, α][i][, q][j][ −]_ [1)]


     -      + _λ_ [b] 1 _{lt_ b [=0] _[}][I]_ _[−]_ [(] _[u][ −]_ _[w]_ [)(] _[t][n][, α][i][, q][j]_ [) +][ 1] _[{][l]_ _t_ [b][=1] _[}][I]_ _[−]_ [(] _[u][ −]_ _[w]_ [)(] _[t][n][, α][i][, q][j]_ [ + 1)] _≥_ 0 _._


**Proposition 5.2** (Stability) **.** _For any δ_ = ( _δt, δα_ ) _∈_ R [+] _×_ R [+] _, there exists a solution_
_v_ _[δ]_ ( _t, α, q_ ) _of equation (6). Moreover, the following uniform bound holds:_


_U_ 1( _t_ ) _≤_ _v_ _[δ]_ ( _t, α, q_ ) _≤_ _U_ 2( _t_ ) _,_


_where_


2 ~~2~~
_U_ 1( _t_ ) = _−_ Υ _Q −_ _ψQ_ _−_ ( _T −_ _t_ )( _σAQ_ + _ϕQ_ ) _,_

_U_ 2( _t_ ) = ( _T −_ _t_ )(∆( _λ_ [a] + _λ_ [b] ) + _σAQ_ ) _._


_Proof._ Existence follows from Theorem 4.1.
Let _tn < T_ and select a grid point ( _αi, qj_ ) where at _t_ = _tn_ the value of _v_ _[δ]_ attains its
minimum:
_vij_ _[n]_ [=] _[ v][δ]_ [(] _[t][n][, α][i][, q][j]_ [) = min]
_k,m_ _[v][δ]_ [(] _[t][n][, α][k][, q][m]_ [)] _[.]_



Since - _L_ _[l]_ _δ_ [a] _[,l]_ [b] _v_ _[n]_ [�]



_ij_ _[≥]_ [0][ for all] _[ l]_ _n_ [a] _[, l]_ _n_ [b] _[∈{]_ [0] _[,]_ [ 1] _[}]_ [,]




    _ij_ [+ ˜] _[f]_ _ij_ _[ l]_ [a] _[,l]_ [b] _[,n]_ _,_ sup
_z∈{_ 1 _,−_ 1 _}_



��
_Bδ_ _[z][v][n]_ [�]




  - [�]
_ij_ _[−]_ [Υ]



0 = max




_vij_ _[n]_ [+1] _−_ _vij_ _[n]_
+ sup
_δt_ _ln_ [a] _,ln_ [b] _∈{_ 0 _,_ 1 _}_



��
_L_ _[l]_ _δ_ [a] _[,l]_ [b] _v_ _[n]_ [�]



_≥_



_≥_ _[v]_ _ij_ _[n]_ [+1] _−_ _vij_ _[n]_ _−_ _σAQ −_ _ϕQ_ ~~2~~ _._
_δt_


Inductively in _n_ we obtain


~~2~~ ~~2~~
_vij_ _[n]_ _[≥]_ _[v]_ _ij_ _[n]_ [+1] _−_ _σAQ −_ _ϕQ_ _≥_ min _._
_k,m_ _[v][δ]_ [(] _[t][n]_ [+1] _[, α][k][, q][m]_ [)] _[ −]_ _[σAQ][ −]_ _[ϕQ]_


~~2~~
Since _v_ _[δ]_ ( _T, α, q_ ) = ˜ _g_ ( _T, α, q_ ) _≥−_ Υ _Q −_ _ψQ_, we get the lower bound


~~2~~ ~~2~~
_v_ _[δ]_ ( _t, α, q_ ) _≥−_ Υ _Q −_ _ψQ_ _−_ ( _T −_ _t_ )( _σAQ_ + _ϕQ_ ) = _U_ 1( _t_ ) _._


The lower bound corresponds to the case where the market maker holds the extreme
position _±Q_ during the entire period [ _t, T_ ], while the asset price follows a strong adverse
trend, producing the largest running and terminal penalties.


9


Similarly, for the upper bound let _tn < T_ and take ( _αi, qj_ ) where _v_ _[δ]_ ( _tn, αi, qj_ ) attains
its maximum:
_vij_ _[n]_ [=] _[ v][δ]_ [(] _[t][n][, α][i][, q][j]_ [) = max]
_k,m_ _[v][δ]_ [(] _[t][n][, α][k][, q][m]_ [)] _[.]_



Then - _L_ _[l]_ _δ_ [a] _[,l]_ [b] _v_ _[n]_ [�]


Hence,



_ij_ _[≤]_ [0][ for] _[ l]_ _n_ [a] _[, l]_ _n_ [b] _[∈{]_ [0] _[,]_ [ 1] _[}]_ [, and]




- _Bδ_ _[z][v][n]_ [�]



for all _z ∈{_ 1 _, −_ 1 _}._
_ij_ _[−]_ [Υ] _[ ≤−]_ [Υ] _[ <]_ [ 0]




    _ij_ [+ ˜] _[f]_ _ij_ _[ l]_ [a] _[,l]_ [b] _[,n]_ _,_ sup
_z∈{_ 1 _,−_ 1 _}_



��
_Bδ_ _[z][v][n]_ [�]




  - [�]
_ij_ _[−]_ [Υ]



0 = max




_vij_ _[n]_ [+1] _−_ _vij_ _[n]_
+ sup
_δt_ _ln_ [a] _,ln_ [b] _∈{_ 0 _,_ 1 _}_



��
_L_ _[l]_ _δ_ [a] _[,l]_ [b] _v_ _[n]_ [�]



_ij_ _−_ _vij_ _[n]_
_≤_ _[v][n]_ [+1] + ∆( _λ_ [a] + _λ_ [b] ) + _σAQ._
_δt_


This gives the induction step


_vij_ _[n]_ _[≤]_ _[v]_ _ij_ _[n]_ [+1] + ∆( _λ_ [a] + _λ_ [b] ) + _σAQ ≤_ max
_k,m_ _[v][δ]_ [(] _[t][n]_ [+1] _[, α][k][, q][m]_ [) + ∆(] _[λ]_ [a][ +] _[ λ]_ [b][) +] _[ σAQ.]_


Since _v_ _[δ]_ ( _T, α, q_ ) = ˜ _g_ ( _T, α, q_ ) _≤_ 0, we obtain the upper bound


_v_ _[δ]_ ( _t, α, q_ ) _≤_ ( _T −_ _t_ )(∆( _λ_ [a] + _λ_ [b] ) + _σAQ_ ) = _U_ 2( _t_ ) _._


The upper bound _U_ 2( _t_ ) can be interpreted as the accumulation of two maximum gains
over [ _t, T_ ]: from the spread and from exploiting predictable price movements.


**Proposition 5.3** (Consistency) **.** _For all_ ( _t, α, q_ ) _∈_ Ω _and φ ∈_ _Cb_ [1] _[,]_ [2][(Ω)] _[,]_



lim
( _δt,δα_ ) _→_ (0 _,_ 0)
( _t_ _[′]_ _,α_ _[′]_ ) _→_ ( _t,α_ )
_ξ→_ 0




 - _S_ ( _δt, δα_ ) _,_ ( _t_ _[′]_ _, α_ _[′]_ _, q_ ) _, φ_ _[δ]_ ( _t_ _[′]_ _, α_ _[′]_ _, q_ ) + _ξ,_ [ _φ_ _[δ]_ + _ξ_ ]( _t′,α′,q_ )








- - [�]
_M_ _[z]_ _φ −_ _φ_ _._



= max



sup
_ln_ [a] _,ln_ [b] _∈{_ 0 _,_ 1 _}_




- _∂φ_

_,_ sup
_∂t_ [+] _[ L][l]_ [a] _[,l]_ [b] _[φ]_ [ + ˜] _[f][ l]_ [a] _[,l]_ [b][�] _z∈{_ 1 _,−_ 1 _}_



_Proof._ From the definition of the numerical scheme and the continuity of _φ_, we obtain



lim sup
( _δt,δα_ ) _→_ (0 _,_ 0) _ln_ [a] _,ln_ [b] _∈{_ 0 _,_ 1 _}_
( _t_ _[′]_ _,α_ _[′]_ ) _→_ ( _t,α_ )




- _φ_ ( _t′_ + _δt, α′, q_ ) _−_ _φ_ ( _t′, α′, q_ ) 
_δt_ + _L_ _[l]_ _δ_ [a] _[,l]_ [b] _φ_ ( _t_ _[′]_ _, α_ _[′]_ _, q_ ) + _f_ [˜] _[l]_ [a] _[,l]_ [b] ( _t_ _[′]_ _, α_ _[′]_ _, q_ )



= sup
_ln_ [a] _,ln_ [b] _∈{_ 0 _,_ 1 _}_




- _∂φ_ 
_,_
_∂t_ [(] _[t, α, q]_ [) +] _[ L][l]_ [a] _[,l]_ [b] _[φ]_ [(] _[t, α, q]_ [) + ˜] _[f][ l]_ [a] _[,l]_ [b][(] _[t, α, q]_ [)]



and




- _M_ _[z]_ _φ_ ( _t, α, q_ ) _−_ _φ_ ( _t, α, q_ ) _._



lim sup
( _δt,δα_ ) _→_ (0 _,_ 0) _z∈{_ 1 _,−_ 1 _}_
( _t_ _[′]_ _,α_ _[′]_ ) _→_ ( _t,α_ )




- _Bδ_ _[z][φ]_ [(] _[t][′][, α][′][, q]_ [)] _[ −]_ [Υ] = sup
_z∈{_ 1 _,−_ 1 _}_



We rely on the comparison principle from [5, Theorem 2].


**Theorem 5.1** (Comparison principle) **.** _Let v_ 1 _and v_ 2 _be bounded subsolution and super-_
_solution of equation (3), respectively, and assume that v_ 1( _T_ ) _≤_ _v_ 2( _T_ ) _. Then v_ 1 _≤_ _v_ 2 _._


10


**Theorem 5.2** (Convergence) **.** _As_ ( _δt, δα_ ) _→_ (0 _,_ 0) _, the solution v_ _[δ]_ ( _t, α, q_ ) _of equation (6)_
_converges locally uniformly to the unique viscosity solution v_ ( _t, α, q_ ) _of equation (3)._


_Proof._ For ( _t, α, q_ ) _∈_ Ω, define



_v_ ( _t, α, q_ ) = lim inf _v_ _[δt,δα]_ ( _t_ _[′]_ _, α_ _[′]_ _, q_ ) _,_ ~~_v_~~ ~~(~~ _t, α, q_ ) = lim sup
( _δt,δα_ ) _→_ (0 _,_ 0) ( _δt,δα_ ) _→_ (0 _,_ 0)
( _t_ _[′]_ _,α_ _[′]_ ) _→_ ( _t,α_ ) ( _t_ _[′]_ _,α_ _[′]_ ) _→_ ( _t,α_ )



_v_ _[δt,δα]_ ( _t_ _[′]_ _, α_ _[′]_ _, q_ ) _._



By definition, _v_ _≤_ ~~_v_~~ ~~.~~ Moreover, _v_ ( _T, α, q_ ) = ~~_v_~~ ~~(~~ _T, α, q_ ) for all _α, q ∈_ R _×_ ([ _−Q, Q_ ] _∩_ Z).
The boundedness of these functions follows from the stability result (Proposition 5.2).
Hence, to establish the reverse inequality _v_ _≥_ ~~_v_~~ ~~,~~ it suffices—by applying the comparison
principle—to verify that _v_ is a viscosity supersolution and that ~~_v_~~ is a viscosity subsolution.
We prove the first statement; the second follows by symmetry.
Let _φ ∈_ _Cb_ [1] _[,]_ [2] �Ω ~~�~~ and suppose that ( _t,_ [˜] ˜ _α,_ ˜ _q_ ) is a global minimum point of _v−φ_ . Without

loss of generality, assume that the minimum is strict and that _v_ ( _t,_ [˜] ˜ _α,_ ˜ _q_ ) = _φ_ ( _t,_ [˜] ˜ _α,_ ˜ _q_ ).
Then there exist sequences _δk_ = ( _δtk, δαk_ ) _∈_ R [+] _×_ R [+] and ( _tk, αk, qk_ ) _∈_ Ω such that,
as _k →∞_,


( _δtk, δαk_ ) _→_ (0 _,_ 0) _,_ ( _tk, αk, qk_ ) _→_ ( _t,_ [˜] ˜ _α,_ ˜ _q_ ) _,_ _v_ _[δ][k]_ ( _tk, αk, qk_ ) _→_ _v_ ( _t,_ [˜] ˜ _α,_ ˜ _q_ ) _,_


and _v_ _[δ][k]_ _−_ _φ_ attains a global minimum at ( _tk, αk, qk_ ).
Let _ξk_ = _v_ _[δ][k]_ ( _tk, αk, qk_ ) _−_ _φ_ ( _tk, αk, qk_ ). Then _v_ _[δ][k]_ ( _t, α, q_ ) _≥_ _φ_ ( _t, α, q_ ) + _ξk_ for all points
( _t, α, q_ ) _∈_ Ω, with _ξk →_ 0 as _k →∞_ .
By monotonicity (Proposition 5.1) of the scheme _S_, we have


         -         0 = _S_ _δk,_ ( _tk, αk, qk_ ) _, v_ _[δ][k]_ ( _tk, αk, qk_ ) _,_ [ _v_ _[δ][k]_ ]( _tk,αk,qk_ )


         -         _≥_ _S_ _δk,_ ( _tk, αk, qk_ ) _, v_ _[δ][k]_ ( _tk, αk, qk_ ) _,_ [ _φ_ + _ξk_ ]( _tk,αk,qk_ )


         -         = _S_ _δk,_ ( _tk, αk, qk_ ) _, φ_ ( _tk, αk, qk_ ) + _ξk,_ [ _φ_ + _ξk_ ]( _tk,αk,qk_ ) _._


Thus,

       -       _S_ _δk,_ ( _tk, αk, qk_ ) _, φ_ ( _tk, αk, qk_ ) + _ξk,_ [ _φ_ + _ξk_ ]( _tk,αk,qk_ ) _≤_ 0 _._



Applying the consistency property (Proposition 5.3) and taking the limit as _k →∞_, we
obtain







_≤_ 0 _._




- - [�]
_M_ _[z]_ _φ −_ _φ_



max



sup
_ln_ [a] _,ln_ [b] _∈{_ 0 _,_ 1 _}_




- _∂φ_

_,_ sup
_∂t_ [+] _[ L][l]_ [a] _[,l]_ [b] _[φ]_ [ + ˜] _[f][ l]_ [a] _[,l]_ [b][�] _z∈{_ 1 _,−_ 1 _}_



Therefore, _v_ is a viscosity supersolution and ~~_v_~~ is a viscosity subsolution. By the comparison principle and the definitions of _v_ and ~~_v_~~ ~~,~~ it follows that _v_ _≡_ ~~_v_~~ ~~,~~ and this common
function is the unique viscosity solution of equation (3).

### **6 Numerical experiment**


We solve the Hamilton–Jacobi–Bellman Quasi-Variational Inequality numerically with the
following parameter values:


_T_ = 10 _, A_ = 300 _, Q_ = 4 _, σ_ = 0 _._ 01 _, θ_ = 0 _._ 1 _,_

∆= 0 _._ 005 _, ε_ = 0 _._ 005 _, λ_ [a] = _λ_ [b] = 1 _, k_ = 200 _,_

_ρ_ = 1 _, γ_ [a] = _γ_ [b] = 60 _, ϕ_ = 10 _[−]_ [6] _, ψ_ = 0 _._


11


Figure 1: Surface of the value function
_v_ at time _t_ = 0.



Figure 2: Optimal control at time _t_ = 0.



Let the uniform grid in _α_ consist of _Nα_ = 101 points, and let the uniform time grid
contain _N_ = 200 points.
Figure 1 shows the computed surface of the value function _v_ at the initial time. The
corresponding optimal control is displayed in Figure 2. From these results it can be
observed that when the alpha signal is close to zero, the market maker quotes both bid
and ask limit orders. As the alpha signal increases (or decreases), the market maker
begins to trade only on the buy (or sell) side. For large values of the alpha signal, the
market maker uses both limit and market orders to exploit predictable price movements
efficiently.

### **7 Conclusion**


This work investigates an implicit numerical method for solving the Hamilton–Jacobi–
Bellman Quasi-Variational Inequality arising in combined stochastic and impulse control
problem for a market maker. The proposed approach avoids time-step restrictions due to
its unconditional stability.
We established the convergence of the policy iteration algorithm to the solution of
the discrete scheme at each time step. Furthermore, the convergence of the implicit numerical solution to the unique viscosity solution of the Hamilton–Jacobi–Bellman QuasiVariational Inequality was proved. To this end, we verified the monotonicity, stability,
and consistency properties of the numerical scheme.
A numerical experiment was conducted, and the results illustrate the shape of the
value function and the structure of the optimal control at the initial time.

### **Acknowledgements**


The author is thankful to Yuri Kabanov for the attention to his work.

### **References**


[1] Avellaneda, M. and Stoikov, S. 2008. _High Frequency Trading in a Limit Order Book_ .
Quantitative Finance 8:217–224. doi: 10.1080/14697680701381228.


12


[2] Azimzadeh, P. and Forsyth, P. A. 2016. _Weakly Chained Matrices, Policy Iteration,_
_and Impulse Control._ SIAM Journal on Numerical Analysis 54(3):1341– 1364. doi:
10.1137/15M1043431.


[3] Barles, G. and Jakobsen, E. R. 2002. _On the convergence rate of approximation_
_schemes for Hamilton-Jacobi-Bellman Equations._ ESAIM: M2AN 36(1):33–54. doi:
10.1051/m2an:2002002.


[4] G. Barles and P.E. Souganidis. 1991. _Convergence of approximation schemes for_
_fully nonlinear second order equations._ Asymptotic Analysis 4(3):271–283. doi:
10.3233/ASY-1991-4305.


[5] Cartea, ´A. and Wang, Y. 2020. _Market_ _making_ _with_ _alpha_ _signals._ International Journal of Theoretical and Applied Finance 23(03):2050016. doi:
10.1142/S0219024920500168.


[6] Gu´eant, O. and Lehalle, C.-A. and Fernandez-Tapia, J. 2011. _Dealing with the Inven-_
_tory Risk: A Solution to the Market Making Problem._ Mathematics and Financial
Economics 7. doi: 10.1007/s11579-012-0087-0.


13


