**Paraxial diffusion-field retrieval. II. Fokker-Planck generalization of the**
**transport-of-intensity equation**


David M. Paganin and Kaye S. Morgan
_School of Physics and Astronomy, Monash University, Clayton, Victoria, 3800, Australia_
(Dated: January 22, 2026)


The transport-of-intensity equation (TIE), namely the continuity equation associated with a coherent paraxial optical wavefield, has been very widely employed for phase retrieval. In particular,
the TIE is an elliptic second-order partial differential equation which may be solved for the phase
of a coherent paraxial field such as a monochromatic scalar optical beam, given both the intensity and longitudinal intensity derivative in a plane perpendicular to the optical axis. This paper
shows how the coherent flow associated with the TIE may be augmented by a diffusive flow associated with a scalar or tensor diffusion field. Such diffusive flow can arise via scattering from
unresolved spatially random microstructure within an illuminated sample, the blurring effects of an
extended chaotic source that illuminates the sample, the resolution-reducing effect of shot noise in
detected intensity images of the sample, and the sharpening effect (negative diffusion) associated
with scattering from sharp sample edges. Augmenting the TIE’s modeling of coherent flow with a
diffuse-flow channel leads to a Fokker-Planck extension to this equation. Two different TIE augmentations are obtained, using three different derivations. The inverse problems of phase retrieval
and diffusion-field retrieval are then considered, for both defocus-based imaging and mask-based
imaging (structured-illumination imaging). When symmetric overfocus and underfocus images are
employed for the purposes of phase retrieval, the diffusive term drops out and our Fokker-Planck
formalism implies that any ensuing TIE-based phase-retrieval method needs no modification in light
of our formalism. However, the same focal-series dataset—which is typically an infocus image, a
weakly overfocused image, and a weakly underfocused image—may also be employed to access the
additional channel of information associated with the Fokker-Planck diffusion field. Our formalism
is applicable to visible-light microscopy, x-ray imaging, electron microscopy, and neutron imaging.



**I.** **INTRODUCTION**


This article is a direct continuation of our previous
paper [1] (henceforth Paper I). It is structured as follows. Section II briefly reviews the theory underpinning
the transport-of-intensity equation (TIE) [2], namely the
continuity equation associated with the paraxial equation
of coherent scalar wave optics. It is pointed out that the
TIE has been the basis for a very large number of papers
on phase retrieval (noninterferometric intensity measurement) using visible light, x-rays, electrons, and neutrons.
Section III gives two informal derivations for the FokkerPlanck generalization of the TIE [3, 4], in the form that
was stated without proof at the end of Paper I. This generalization augments the coherent-flow term in the TIE
with a position-dependent diffusive flow associated with
a paraxial diffusion field. The first informal derivation,
which is given in Sec. III A, manually bifurcates the optical flow into coherent and diffuse channels. Section III B
gives a second derivation where this bifurcation is seen to
emerge in a natural way, from a geometrical-optics model
wherein we average over an ensemble of beams that are
each continuously distorted in a random manner. These
complementary informal derivations aim to explain key
aspects of the Fokker-Planck extension to the TIE in a
manner that is both mathematically simple and conceptually clear. Section III C explains that the two derivations are incomplete in that both neglect the influence
of a coherent-flow correction term, which is of the same
order in sample-to-detector propagation distance (defo


cus distance) as the diffuse-flow term. This correction
term may be associated with a higher-order version of
the TIE. Such critique of our two informal derivations
motivates the development of Sec. IV, which obtains an
infinite hierarchy of higher-order TIEs, namely expressions for the _m_ th longitudinal derivative of the intensity
associated with a paraxial monochromatic scalar beam
that obeys the paraxial wave equation, where _m_ is any
positive integer. This result enables Sec. V, which considers the simultaneous presence of both coherent and
diffuse energy flow in a paraxial beam, in a manner that
overcomes the preceding critique. We thereby obtain
the corrected paraxial-optics Fokker-Planck generalization of the TIE. Section VI explains how the FokkerPlanck extension to the TIE is indeed a special case of
the form for the Fokker-Planck equation that is typically
employed in its more usual context of nonequilibrium statistical mechanics. Section VII, which is broken into two
parts, considers the inverse problems [5] of phase retrieval

[Sec. VII A] and diffusion-field retrieval [Sec. VII B]. Both
defocus-based schemes and mask-based (structured illumination) schemes are considered. For defocus-based
phase retrieval employing positive and negative defoci
that are equal in magnitude, the diffusive term drops out
in the Fokker-Planck generalization of the TIE; this implies that _all existing TIE-based phase-retrieval schemes,_
_employing symmetric overfocus and underfocus images,_
_need no modification_ in light of the Fokker-Planck generalization of the TIE. More importantly, _an additional_
_channel of information may be recovered from such TIE_
_focal-series datasets, namely the scalar or tensor diffu-_


_sion field_ . Section VIII augments the physical models
for diffusion-field generation that were presented in Paper I, by considering the influence of noise [Sec. VIII A]
on the positive component of the diffusion field, in addition to negative diffusion fields that may be associated
with scattering from sharp edges in a sample or from coherent defocus [Sec. VIII B]. Three closely related topics
lead the discussion in Sec. IX, namely a link between
the optical-physics concept of a paraxial diffusion field
and the statistical-physics notion of a renormalization
group [Sec. IX A], a simple model for the dependence
upon imaging-system spatial resolution of the partitioning of the paraxial flow into coherent and diffuse channels [Sec. IX B], and the role of Liouville’s theorem, spatiotemporal coarse graining, and unresolved speckle, in
the context of the formalism developed in the present
paper [Sec. IX C]. We also discuss some implications of
the diffusion-field concept in the context of the theory
of partially coherent optical fields [Sec. IX D], followed
by application-specific remarks concerning the use of our
paper’s formalism for visible-light imaging, x-ray imaging, electron-microscope imaging, and neutron imaging

[Sec. IX E]. Concluding remarks are given in Sec. X.


**II.** **BACKGROUND:**
**TRANSPORT-OF-INTENSITY EQUATION**


As shown in Fig. 1, consider a paraxial monochromatic
scalar light field, such as a propagating laser beam that
is deformed by passage through an illuminated sample.
If we picture this field in terms of geometrical optics, we
may consider the set of rays associated with the wavefront [1] indicated by the curved line _W_ . Each of these rays
is perpendicular to the wavefront. Since the wavefront is
locally converging in the vicinity of point _A_, the rays labeled 1 _,_ 2 _,_ 3 will get closer together as they propagate in
the direction of the optical axis _z_ . This local convergence
of rays implies that the intensity will increase as we move
from _A_ to _B_ . Similarly, in the vicinity of point _C_, the
rays 3 _,_ 4 _,_ 5 are locally diverging, hence the intensity will
decrease when moving from _C_ to _D_ . In both cases, we assume that no rays cross one another in the vacuum-filled
slab of space between _z_ = 0 and _z_ = ∆ _>_ 0, where _z_ is a
Cartesian coordinate associated with the optical axis; for
our context of paraxial optics, this condition corresponds
to ∆being sufficiently small.
A mathematical model, for the qualitative observations
of the previous paragraph, proceeds as follows. Begin by


1 In the language of geometrical optics, the wavefront is a “surface of constant action” (Ref. [6], p. 273) or “surface of constant eikonal” (Ref. [7], p. 119). In wave-optical language,
the wavefront is a “surface of constant phase”. The action _S_,
eikonal _S_, and phase _ϕ_ are linked via _S/_ ℏ = 2 _πS /λ_ = _ϕ_, where
ℏ = _h/_ (2 _π_ ), _h_ is the Planck constant, and _λ_ is the vacuum wavelength (Ref. [6], p. 278; Ref. [7], pp. 118-119).



2


FIG. 1. Coherent flow of a paraxial scalar optical field, associated with the transport-of-intensity equation [2]. According to geometrical optics, when propagating through the vacuum that is assumed to lie between the planes _z_ = 0 and
_z_ = ∆ _>_ 0, the flow may be modeled in terms of straight
rays such as those labeled 1 to 5. According to wave optics,
we may instead model the flow via an intensity and phase,
with wavefronts (such as that indicated by the curved line _W_ )
associated with surfaces of constant phase. The transport-ofintensity equation is consistent with both viewpoints.


noting that the intensity _I_ ( _x, y, z_ ) and phase Φ( _x, y, z_ ),
of a scalar monochromatic field that is not necessarily
paraxial, can be combined into the complex wavefunction



is the three-dimensional Laplacian, _∇_ is the threedimensional gradient operator,


_k_ = 2 _π/λ_ (4)


is the wavenumber associated with radiation vacuum
wavelength _λ_, and ( _x, y, z_ ) is a Cartesian coordinate system with the ( _x, y_ ) planes being transverse to the optical
axis _z_ . Substitute Eq. (1) into Eq. (2), expand the resulting expression, cancel a common factor of exp( _i_ Φ),
and then separate real from imaginary parts. One of
the equations so obtained is the (nonparaxial) continuity
equation


_∇·_ [ _I_ ( _x, y, z_ ) _∇_ Φ( _x, y, z_ )] = 0 _,_ (5)


which expresses local conservation of energy. This equation also shows that _I∇_ Φ is proportional to the flow vector (Poynting vector) associated with the propagating
field. For simplicity, work in a system of units where the
constant of proportionality is unity, hence we speak of


**S** ( _x, y, z_ ) = _I_ ( _x, y, z_ ) _∇_ Φ( _x, y, z_ ) (6)



_ψ_ �( _x, y, z_ ) = 


_I_ ( _x, y, z_ ) exp[ _i_ Φ( _x, y, z_ )] (1)



that obeys the Helmholtz equation


( _∇_ [2] + _k_ [2] ) _ψ_ ( _x, y, z_ ) = 0 _._ (2)

[�]


Here,



_∇_ [2] = _∇· ∇_ = _[∂]_ [2]




_[∂]_ [2] _[∂]_ [2]

_∂y_ [2] [+] _∂z_




_[∂]_ [2] _[∂]_ [2]

_∂x_ [2] [+] _∂y_



(3)
_∂z_ [2]


3



as _the_ Poynting vector for the flow [8]. As shown for the
point labeled _E_ in Fig. 1, the Poynting vector is perpendicular to the wavefronts (surfaces of constant phase).
Since we are interested in the case of paraxial beams, it
is natural to decompose the wavefield phase Φ( _x, y, z_ ) as
a sum of the phase _kz_ associated with a plane wave that
travels in the direction of the optical axis _z_, and a comparatively slowly-varying modulation (envelope) phase
_ϕ_ ( _x, y, z_ ) that quantifies the manner in which the planewave “carrier wave” phase _kz_ is distorted. Thus


Φ( _x, y, z_ ) = _kz_ + _ϕ_ ( _x, y, z_ ) _,_ (7)


where


_|∇ϕ_ ( _x, y, z_ ) _| ≪_ _k._ (8)


Next, return to Eq. (5) and split it into transverse and
longitudinal contributions as


_∇⊥_ _·_ [ _I_ ( _x, y, z_ ) _∇⊥_ Φ( _x, y, z_ )]



of the phase of the infocus field [10]:



_I_ ( _x, y, z_ = ∆)



= ∆)

_≈_ 1 _−_ [∆]
_I_ in _k_



_⊥_ _[ϕ]_ [(] _[x, y, z]_ [ = 0)] _[.]_ (14)
_k_ _[∇]_ [2]



+ _[∂]_

_∂z_




- _I_ ( _x, y, z_ ) _[∂]_ = 0 _,_ (9)

_∂z_ [Φ(] _[x, y, z]_ [)]



where _∇⊥_ denotes the gradient operator in the ( _x, y_ )
plane. Equation (7) implies that _∇⊥_ Φ = _∇⊥ϕ_, with
Eqs. (7) and (8) together implying that _∂_ Φ _/∂z_ may be
approximated by _k_ . Hence Eq. (9) becomes the following
paraxial continuity equation known as the “transport-ofintensity equation” (TIE) [2]:


_−∇⊥_ _·_ [ _I_ ( _x, y, z_ ) _∇⊥ϕ_ ( _x, y, z_ )] = _k_ _[∂]_ (10)

_∂z_ _[I]_ [(] _[x, y, z]_ [)] _[.]_



The TIE states that the “convergence” (i.e., the negative of the divergence) of the transverse component of
the flow vector (Poynting vector) is proportional to the
longitudinal rate of change of the intensity. This accords with the intuitive remarks made earlier. Indeed,
upon making the asymmetric first-order finite-difference
approximation

 - _∂_  
_≈_ _[I]_ [(] _[x, y, z]_ [ = ∆)] _[ −]_ _[I]_ [(] _[x, y, z]_ [ = 0)]

_∂z_ _[I]_ [(] _[x, y, z]_ [)] _z_ =0 ∆

(11)
to the longitudinal intensity derivative, the TIE leads to



_∂_ 
_∂z_ _[I]_ [(] _[x, y, z]_ [)]



_≈_ _[I]_ [(] _[x, y, z]_ [ = ∆)] _[ −]_ _[I]_ [(] _[x, y, z]_ [ = 0)]
_z_ =0 ∆



_I_ ( _x,y, z_ = ∆) _≈_ _I_ ( _x, y, z_ = 0)

_−_ [∆] (12)

_k_ _[∇][⊥]_ _[·]_ [ [] _[I]_ [(] _[x, y, z]_ [ = 0)] _[∇][⊥][ϕ]_ [(] _[x, y, z]_ [ = 0)]] _[ .]_


The contribution of the second line of the above equation
may be spoken of as “out of focus contrast” [9–12] induced by the locally converging or diverging character of
the flow. Moreover, if the infocus intensity _I_ ( _x, y, z_ = 0)
is approximately uniform, with a value of _I_ in, this out-offocus contrast is proportional to the transverse Laplacian




_[∂]_ [2] _[∂]_ [2]

_∂x_ [2] [+] _∂y_



_∇_ [2] _⊥_ [=] _[∂]_ [2]



(13)
_∂y_ [2]



The TIE [Eq. (10)] has been very widely utilized in
the context of phase retrieval, namely the recovery of
wavefield phase from non-interferometric measurements
of intensity. In this context, we note that the TIE is
an elliptic second-order partial differential equation with
nonconstant coefficients [13], for which the measured intensity and longitudinal intensity derivative, over a given
plane of fixed _z_, may be used to solve for the unknown
phase over that plane [14]. Since such an approach to
phase measurement does not require the formation of interference fringes, its coherence requirements are rather
lax [15]. The vast research literature on TIE-based phase
retrieval will not be reviewed here, with the reader being
referred to the comprehensive review article by Zuo _et al._

[16] together with its extensive list of references.


**III.** **FOKKER-PLANCK EXTENSION TO THE**
**TIE: TWO INFORMAL DERIVATIONS**


The distinction between specular and diffuse reflection
is a key concept in optical physics [17]. For example, if
light is reflected from a roughened plane mirror, the specular reflection (for which the angle of incidence is equal
in magnitude to the angle of reflection) will be accompanied by a diffuse component that travels in a continuum
of different directions.


FIG. 2. Combined coherent and diffuse flow of a paraxial
scalar optical field, associated with Fokker-Planck generalizations of the transport-of-intensity equation.


As shown in Fig. 2, a similar phenomenon occurs when
paraxial quasimonochromatic light [7] passes through a
refracting sample that contains “internal roughness” associated with spatially-random unresolved microstructure [3] [cf. Figs. 3, 6, 7, and 10(b) in Paper I]. In this
case, suppose the plane _z_ = 0 to correspond to the nominally planar exit surface of a thin sample (not shown)
that lies immediately upstream of this plane. At each
point over this plane, the Poynting vector **S** may be split
into two components **S** _c_ and **S** _d_ that are respectively associated with the coherent (specular) and diffuse components of the flow. The coherent component of the flow


corresponds to a fraction 1 _−F_ ( _x, y, z_ ) of the rays, streaming through the point _E_ in Fig. 2, in the direction of
the local phase gradient according to Eq. (6). The diffuse component of the flow has a different character. It
may be associated with a fraction _F_ ( _x, y, z_ ) of the rays,
streaming through the point _E_, having a random spread
of directions indicated by the ray ensemble filling the cone
that is indicated in the diagram with green vectors. [2]


The presence of this combined coherent and diffuse
flow leads to a modified form of the TIE [1, 3, 4, 18], with
the diffuse flow leading to position-dependent blur which
augments the defocus-induced phase contrast associated
with the coherent flow. This yields a modified version of
Eq. (12), as very briefly sketched in Sec. V H near the end
of Paper I; this modification is a form of Fokker-Planck
equation [19] insofar as it is a continuity equation that simultaneously describes both coherent and diffusive flow.
In Secs. III A and III B below, we give two crude derivations that each emphasize different aspects of the optical
physics associated with the Fokker-Planck generalization
of the TIE in the forms previously published [1, 3, 4, 18].
We critique these derivations in Sec. III C, thereby motivating the more involved development given later in the
paper (Secs. IV and V).



4


**A.** **First informal derivation**


Return consideration to the intensity distribution
_I_ ( _x, y, z_ ) associated with Fig. 2. Compressing our notation by writing _I_ ( _x, y, z_ = 0) as _I_ 0( _x, y_ ), we decompose
the “unpropagated intensity” into the diffuse and coherent channels via the identity



For the moment, suppress explicit functional dependence
on ( _x, y_ ) for clarity. In propagating through a small distance ∆, we consider the diffuse-channel intensity distribution _FI_ 0 to be locally blurred via application of the
diffusive operator


_D ≡_ I() + 2 [1] _[∇]_ _⊥_ [2] [[] _[σ]_ ∆ [2] [()]] _[,]_ (16)


where _σ_ ∆ is a position-dependent blur-kernel standard
deviation [see Eq. (8) in Paper I], I denotes the identity operator, and empty brackets indicate where the
acted-upon function should be inserted. [3] Conversely, the
coherent-channel intensity (1 _−_ _F_ ) _I_ 0 is locally sharpened
using the TIE [2], according to the operator


_T ≡_ I() _−_ [∆] _k_ _[∇][⊥]_ _[·]_ [ [()] _[∇][⊥][ϕ]_ []] (17)


given by Eq. (12). We may therefore write the defocusinduced intensity by separately evolving the two flows:



_I_ 0( _x, y_ ) = _F_ ( _x, y_ ) _I_ 0( _x, y_ )

~~�~~      - ~~�~~      diffuse channel



+ [1 _−_ _F_ ( _x, y_ )] _I_ 0( _x, y_ )

 - ~~�~~  - ~~�~~
coherent channel



_._ (15)



_I_ 0 = _FI_ 0 + (1 _−_ _F_ ) _I_ 0


_z_ = ∆ _≥_ 0 _z_ = ∆

� �



_z_ = ∆ _≥_ 0



�



_z_ = ∆ _≥_ 0



(18)



2 [1] _[∇]_ _⊥_ [2] [(] _[σ]_ ∆ [2] _[FI]_ [0][)] + (1 _−_ _F_ ) _I_ 0 _−_ [∆] _k_



_FI_ 0 + [1]



_k_ _[∇][⊥]_ _[·]_ [ [(1] _[ −]_ _[F]_ [)] _[I]_ [0] _[∇][⊥][ϕ]_ []] _[.]_



Now recall Fig. 3 in Paper I, but simplify the scenario
presented there by ignoring the influence of source-size
blur. This simplification implies that we may take


_σ_ ∆( _x, y_ ) = _θs_ ( _x, y_ )∆ _,_ (19)


where _θs_ ( _x, y_ ) is a position-dependent blur angle associated with the position-dependent diffuse scatter induced
by the unresolved sample microstructure (again see Fig. 3


2 While we here emphasize the contribution to the cone-like diffusive ray ensemble that is associated with “internal roughness”
of the sample, another contribution to this diffusive flow is due
to the degree of spatial coherence of the illuminating beam (e.g.,
via an extended incoherent source). For further information, see
Sec. II of Paper I, especially Fig. 3 and the upper line of Eq. (23).
3 For an alternative derivation of this diffusive operator, see
Eqs. (25)-(31) in Ref. [20].



of Paper I), and we are here reinstating explicit functional
dependence upon transverse coordinates ( _x, y_ ). Also introduce the dimensionless diffusion coefficient (diffusion
field) [4]


_D_ ( _x, y_ ) = [1] (20)

2 _[F]_ [(] _[x, y]_ [) [] _[θ][s]_ [(] _[x, y]_ [)]][2] _[ .]_


4 Note that Eq. (20) corresponds to a special case of Eq. (24) in
Paper I, with the angular extended-source size _θ_ 0 (see Figs. 2, 3
and 5 of Paper I) being set to zero.


With the indicated changes, the lower line of Eq. (18)
leads to the finite-difference form


_I_ ( _x, y, z_ = ∆ _≥_ 0) = _I_ ( _x, y, z_ = 0)

_−_ [∆]

_k_ _[∇][⊥]_ _[· {]_ [[1] _[ −]_ _[F]_ [(] _[x, y]_ [)]] _[I]_ [(] _[x, y, z]_ [ = 0)] _[∇][⊥][ϕ]_ [(] _[x, y, z]_ [ = 0)] _[}]_

+ ∆ [2] _∇_ [2] _⊥_ [[] _[D]_ [(] _[x, y]_ [)] _[I]_ [(] _[x, y, z]_ [ = 0)]] (21)


of the isotropic-diffusion Fokker-Planck generalization of
the TIE given in Eq. (146) of Paper I. [5]


**B.** **Second informal derivation**


Here we provide a second informal derivation of the
Fokker-Planck TIE generalization, for the special case
where _F ≪_ 1. This calculation is inspired by, and partly
analogous to, the derivation of Zitterbewegung-induced
smearing of the effective potential (“Darwin term”) for
an electron bound to a hydrogen nucleus in relativistic
quantum theory (see p. 119 of Sakurai [31]). Geometrical
optics is assumed throughout this derivation.
For the moment, we work in one transverse dimension
_x_ . Hence Eq. (12) becomes


_I_ ( _x, z_ = ∆) _≈_ _I_ ( _x, z_ = 0)



5


In writing the preceding expression, we have made the
strong but often reasonable assumption that the previously mentioned unresolved sample structure is sufficiently slowly varying, such that it merely _geometrically_
_distorts the defocused intensity that would exist in the_
_absence of such fluctuations_ .
Taylor expand all functions on the right side of
Eq. (24), working to second order in _δx_ ( _x_ ), and note
that—for the purposes of this expansion—the final line
of Eq. (24) may be considered as a single function. Ensemble average over _E_, as denoted using an overline
(cf. Refs. [3] and [35]). By assumption, _δx_ ( _x_ ) vanishes
at any transverse position _x_, hence


?
_I_ ( _x, z_ = ∆) _−→_ _I_ ( _x −_ _δx_ ( _x_ ) _, z_ = ∆)




[(] _[x]_ [)]][2] _∂_ [2]


2! _∂x_



_≈_ _I_ ( _x, z_ = 0) + [[] _[δx]_ [(] _[x]_ [)]][2]



_∂x_ [2] _[I]_ [(] _[x, z]_ [ = 0)]



_∂_

_−_ [∆]

_k_ _∂x_




- _I_ ( _x, z_ = 0) _[∂]_

_∂x_ _[ϕ]_ [(] _[x, z]_ [ = 0)]




_−_ [∆]

_k_




[ _δx_ ( _x_ )] [2]



( _x_ )] [2] _∂_ [3]

2! _∂x_ [3]



_∂x_ [3]




- _I_ ( _x, z_ = 0) _[∂]_ _._ (25)

_∂x_ _[ϕ]_ [(] _[x, z]_ [ = 0)]



Consistent with a paraxial small-defocus distortion in
the regime of geometrical optics, we now assume that


_δx_ ( _x_ ) = _ε_ ( _x_ )∆ _,_ (26)


where _ε_ ( _x_ ) is a position-dependent refraction angle associated with any one instance (“realization”) of the unresolved sample fluctuations (see Fig. 6 in Paper I). Retaining terms that are no higher than second order in ∆,
the final term in Eq. (25) drops out since it is of third
order with respect to ∆. We are left with


?
_I_ ( _x, z_ = ∆) _−→_ _I_ ( _x −_ _δx_ ( _x_ ) _, z_ = ∆)



_∂_

_−_ [∆]

_k_ _∂x_




- _I_ ( _x, z_ = 0) _[∂]_ _._ (22)

_∂x_ _[ϕ]_ [(] _[x, z]_ [ = 0)]



On the right side of this equation, make the replacement


_x −→_ _x −_ _δx_ ( _x_ ) _,_ (23)


where _δx_ is an _x_ -dependent smooth random function
which continuously deforms the propagated intensity
_I_ ( _x, z_ = ∆) in a manner consistent with the added presence of unresolved sample structure. This unresolved
structure may and often will correspond to the spatially
unresolved random sample microstructure [32] that has
formed a key theme of the present pair of papers, but it
may also be associated with temporally unresolved fluctuations that are due to an extended chaotic source [7, 33]
or the non-zero temperature of the sample [34].
For any one particular instance of _δx_ ( _x_ ), drawn from
the statistical ensemble _E_ of all possible realizations for
this stochastic function, the replacement in Eq. (23) implies that Eq. (22) tentatively becomes


?
_I_ ( _x, z_ = ∆) _−→_ _I_ ( _x −_ _δx_ ( _x_ ) _, z_ = 0) (24)




[∆][2]

2 [[] _[θ][s]_ [(] _[x]_ [)]][2] _[ ∂]_ _∂x_ [2]



_≈_ _I_ ( _x, z_ = 0) + [∆][2]



_∂x_ [2] _[I]_ [(] _[x, z]_ [ = 0)]



_∂_

_−_ [∆]

_k_ _∂x_




- _I_ ( _x, z_ = 0) _[∂]_ _,_ (27)

_∂x_ _[ϕ]_ [(] _[x, z]_ [ = 0)]



where




  _θs_ ( _x_ ) =




[ _ε_ ( _x_ )] [2] (28)



_∂_

_−_ [∆]

_k_ _∂x_




- _I_ ( _x −_ _δx_ ( _x_ ) _, z_ = 0) _[∂]_ _._

_∂x_ _[ϕ]_ [(] _[x][ −]_ _[δx]_ [(] _[x]_ [)] _[, z]_ [ = 0)]



5 See, also, Refs. [3, 4, 18, 21, 22]. Cf. Refs. [23–26] and the earlier
papers by Davis [27–30].



is the root-mean-square half-angle associated with the
sample-induced fluctuations in ray angle [cf. Eq. (73) in
Paper I, together with Fig. 6 in that paper].
To complete the present derivation, an additional physical factor must be taken into account. This extra factor is directly related to the previously mentioned fact
that, when a light beam illuminates a plane mirror that
contains some degree of surface roughness, the reflected
beam is split into specular and diffuse components [17].
In our case, we may instead speak of (i) “specular refraction by the sample” which manifests as the coherent
flow associated with the phase gradient, coupled with (ii)
position-dependent diffuse scatter by the sample that is


associated with diffusive flow. To refine our calculation
so as to take this factor into account, let us bifurcate
the propagated intensity into a sum of coherent-flow and
diffuse-flow channels, respectively, via


_I_ ( _x, z_ = ∆) _−→_ [1 _−_ _F_ ( _x_ )] _I_ ( _x, z_ = ∆)


+ _F_ ( _x_ ) _I_ ( _x −_ _δx_ ( _x_ ) _, z_ = ∆) _._ (29)


If Eq. (22) is used to estimate the first term in the preceding sum, with Eq. (27) being used for the ensemble
average in the second term, we obtain


_I_ ( _x, z_ = ∆) _≈_ _I_ ( _x, z_ = 0)



6


With these definitions in place, and again discarding
Taylor-series terms in ∆that are of higher than second
order, the chain of logic leading from Eq. (24) to (27)
generalizes to [cf. Eqs. (105) and (147) in Paper I]


?
_I_ ( _x,y, z_ = ∆) _−→_ _I_ ( _x −_ _δx_ ( _x, y_ ) _, y −_ _δy_ ( _x, y_ ) _, z_ = ∆)

_≈I_ ( _x, y, z_ = 0) + [∆][2]

2 _[∇][⊥]_ _[·]_ [ [] **[C]** [(] _[x, y]_ [)] _[∇][⊥][I]_ [(] _[x, y, z]_ [ = 0)]]

_−_ [∆] (33)

_k_ _[∇][⊥]_ _[·]_ [ [] _[I]_ [(] _[x, y, z]_ [ = 0)] _[∇][⊥][ϕ]_ [(] _[x, y, z]_ [ = 0)]] _[,]_


where we have introduced the position-dependent
angular-deflection covariance matrix field [7]




   **C** ( _x, y_ ) _≡_



_∂_

_−_ [∆]

_k_ _∂x_




- _I_ ( _x, z_ = 0) _[∂]_

_∂x_ _[ϕ]_ [(] _[x, z]_ [ = 0)]




[ _εx_ ( _x, y_ )] [2] [ _εx_ ( _x, y_ )][ _εy_ ( _x, y_ )] ~~�~~ _._

[ _εx_ ( _x, y_ )][ _εy_ ( _x, y_ )] [ _εy_ ( _x, y_ )] [2]




[1]

2 _[F]_ [(] _[x]_ [)[] _[θ][s]_ [(] _[x]_ [)]][2][∆][2] _[ ∂]_ _∂x_ [2]



+ [1]



_∂x_ [2] _[I]_ [(] _[x, z]_ [ = 0)] _[.]_ (30)



(34)
To refine the calculation, by taking into account the bifurcation into coherent and diffuse flows, we invoke the
generalization of Eq. (29) to two transverse dimensions,
namely


_I_ ( _x,y, z_ = ∆) _−→_ [1 _−_ _F_ ( _x, y_ )] _I_ ( _x, y, z_ = ∆)


+ _F_ ( _x, y_ ) _I_ ( _x −_ _δx_ ( _x, y_ ) _, y −_ _δy_ ( _x, y_ ) _, z_ = ∆) _._ (35)


If Eq. (12) is used to estimate the first term in the preceding sum, with Eq. (33) being used for the ensemble
average in the second term, we arrive at


_I_ ( _x, y, z_ = ∆) _≈_ _I_ ( _x, y, z_ = 0)

_−_ [∆]

_k_ [[1] _[ −]_ _[F]_ [(] _[x, y]_ [)]] _[∇][⊥]_ _[·]_ [ [] _[I]_ [(] _[x, y, z]_ [ = 0)] _[∇][⊥][ϕ]_ [(] _[x, y, z]_ [ = 0)]]

+ [1] (36)

2 [∆][2] _[F]_ [(] _[x, y]_ [)] _[∇][⊥]_ _[·]_ [ [] **[C]** [(] _[x, y]_ [)] _[∇][⊥][I]_ [(] _[x, y, z]_ [ = 0)]] _[.]_


Now enforce both local and global energy conservation
by assuming that the diffuse-scatter fraction _F_ ( _x, y_ ) is a
sufficiently slowly varying function of position that multiplication by _F_ ( _x, y_ ) may be interchanged in order with
application of the transverse divergence operator. [8] In addition, introduce the dimensionless tensor diffusion field

**D**    - ( _x, y_ ) = [1] 2 _[F]_ [(] _[x, y]_ [)] **[C]** [(] _[x, y]_ [)] _[.]_ (37)


7 Note also that in writing Eq. (33) we have assumed the elements
of **C** ( _x, y_ ) to be sufficiently slowly varying functions of spatial
position that they approximately commute with _∂/∂x_ and _∂/∂y_ .
8 “Putting _F_ inside the divergence operation” is consistent with
both local and global energy conservation, in a similar sense
to that described in the paragraph of Paper I which contains
Eq. (26). In effect, what we are doing is (i) to acknowledge
that our approximate analysis spoils the energy conservation
“�� _I_ ( _x, y, z_ = ∆) _dx dy_ = constant” that we know must hold
for any ∆, and then (ii) modifying the resulting expression to restore energy conservation, by ensuring that the diffuse Fick-law
flow [36] is a conserved current, in the sense of Noether’s theorem

[3, 37]. A similar comment applies to the coherent-flow component of the paraxial intensity transport. Cf. use of the “Cayley
form” to restore unitarity, in a finite-difference approximation
that otherwise spoils unitary evolution, by Goldberg _et al._ [38].



Reinstate the second transverse dimension _under the_
_simplifying assumption that the unresolved sample fluc-_
_tuations are rotationally symmetric in their statistical_
_character_ . Stated differently, we here assume that the
diffuse flow at each point may be associated with a local
smearing function that is invariant under rotations about
that point in the ( _x, y_ ) plane. Recall the form for the
dimensionless diffusion coefficient (scalar diffusion field)
_D_ ( _x, y_ ) in Eq. (20), then assume _D_ ( _x, y_ ) to be sufficiently
slowly spatially varying that it approximately commutes
with the transverse Laplacian operator _∇_ [2] _⊥_ [.][6][ Hence]


_I_ ( _x, y, z_ = ∆) _≈_ _I_ ( _x, y, z_ = 0)

_−_ [∆]

_k_ _[∇][⊥]_ _[·]_ [ [] _[I]_ [(] _[x, y, z]_ [ = 0)] _[∇][⊥][ϕ]_ [(] _[x, y, z]_ [ = 0)]]

+ ∆ [2] _∇_ [2] _⊥_ [[] _[D]_ [(] _[x, y]_ [)] _[I]_ [(] _[x, y, z]_ [ = 0)]] _[,]_ (31)


which agrees with Eq. (21) for the special case where
_F ≪_ 1 [cf. Eqs. (25) and (146) in Paper I].
We now generalize the result of the previous paragraph. In particular, we now treat the case where rotational symmetry cannot be assumed for the statistical
character of the sample-induced stochastic wavefield fluctuations. Each instance of the random-microstructure
stochastic distortion field is now represented by _δx_ ( _x, y_ )
for the geometric distortions in the _x_ transverse direction and _δy_ ( _x, y_ ) for the geometric distortions in the _y_
transverse direction. Similarly, we generalize Eq. (26) to


_δx_ ( _x, y_ ) = _εx_ ( _x, y_ )∆ and _δy_ ( _x, y_ ) = _εy_ ( _x, y_ )∆ _,_ (32)


where _εx_ ( _x, y_ ) is a position-dependent refraction (deflection) angle in the _x_ direction that is induced by unresolved sample fluctuations, and _εy_ ( _x, y_ ) is the corresponding refraction (deflection) angle in the _y_ direction.


6 Alternatively, one may follow the logic in Sec. III C of Paper I,
and consider this interchange in order—of the scalar diffusion
field and the transverse Laplacian—to amount to a _change in_
_representation for the diffusion field_, rather than implying any
additional approximation.


We thereby arrive at the anisotropic-diffusion finitedifference form


_I_ ( _x, y, z_ = ∆) _≈_ _I_ ( _x, y, z_ = 0)

_−_ [∆]

_k_ _[∇][⊥]_ _[· {]_ [[1] _[ −]_ _[F]_ [(] _[x, y]_ [)]] _[I]_ [(] _[x, y, z]_ [ = 0)] _[∇][⊥][ϕ]_ [(] _[x, y, z]_ [ = 0)] _[}]_

+ ∆ [2] _∇⊥_ _·_ [ **D** [�] ( _x, y_ ) _∇⊥I_ ( _x, y, z_ = 0)] (38)


of the Fokker-Planck TIE extension, which coincides with
Eq. (147) in Paper I. [9]

We close this section with five miscellaneous remarks.
(i) The TIE can be crudely summarized by the statement
that “phase gradients reveal coherent flow” for a paraxial
beam whose transverse intensity distribution evolves as
it propagates along the optical axis _z_ (which is considered to be an evolution parameter analogous to time,
in this context). In the Fokker-Planck extensions of
the TIE, such a summary may be generalized to “intensity gradients reveal diffusive flow [10] and phase gradients reveal coherent flow”. [11] (ii) It is interesting to
compare the expressions for the scalar and tensor diffusion fields that are given in Eqs. (20) and (37), respectively. [12] The former expression factorizes the scalar diffusion field _D_ ( _x, y_ ) as equal to one half of the product
of the scatter-fraction _F_ ( _x, y_ ) with the _variance_ of the
stochastic angular deflection associated with spatially unresolved sample microstructure [see, also, Eq. (28)]. The
latter expression factorizes the rank-two tensor diffusion
field **D** ( _x, y_ ) as equal to one half of the product of the

[�]
scatter-fraction _F_ ( _x, y_ ) with the 2 _×_ 2 _covariance matrix_
of the stochastic angular deflection associated with spatially unresolved sample microstructure. (iii) If terms of
higher than second order in ∆are retained in the Taylor expansion that was employed earlier in the present
section, then a hierarchy of additional diffusion fields


9 See, also, Refs. [3, 4, 18, 39]. Cf. Ref. [40].
10 The statement that “intensity gradients reveal diffusive flow” is
quantified by Fick’s first law of diffusion in the presence of a
position-dependent diffusion coefficient (see, e.g., pp. 2 and 4 of
Crank [36]). It is the position-dependent diffusion coefficient,
namely the “diffusion field” and its associated diffuse current,
which is revealed through the manner in which the intensity distribution diffuses. Cf. Fig. 1 in Paper I.
11 This simple statement needs some clarification. (a) Spatially
rapid _phase_ gradients (namely phase fluctuations occurring at
length scales finer than the detector resolution) can also lead
to diffusive flow, not only intensity gradients. However, in the
present paper such unresolved rapid phase gradients are considered to have been coarse grained into an associated diffusion field
associated with intensity gradients. See Ref. [3] for an example
of this process. Cf. Sec. IX A. (b) In the absence of any intensity gradients, “edges” of areas of diffusive flow (i.e., regions
where the diffusion field varies rapidly with transverse position)
can still be observed. For example, the final line of Eq. (31) is
nonzero if the diffusing intensity is uniform and the diffusion field
is nonuniform. Cf. Fig. 4 in Ref. [4].
12 See, also, the “ _θ_ 0 = 0” special case of the scalar diffusion field in
Eq. (24) from Paper I, together with the tensor diffusion field in
Eqs. (106)-(109) from the same paper.



7


is generated. This extends our Fokker-Planck equation
into a Kramers-Moyal equation [3, 4, 19]. (iv) The same
rotation-matrix field _Rψ_ ( _x,y_ ) that was used to diagonalize
**D** - ( _x, y_ ) in Eqs. (106)-(109) of Paper I may also be used
to diagonalize **C** ( _x, y_ ). [13] The physical picture in Fig. 9
from that earlier paper still holds in the present context,
with the only difference being that the locally-elliptical
transverse section of the diffuse-scatter fan corresponds
to a sheaf of rays rather than a sheaf of wavevectors. (v)
Transition from tensor diffusion to scalar diffusion follows
if we may make the approximation


**D**     - ( _x, y_ ) _≈_ **I** 2 � _D_ ( _x, y_ ) _,_ (39)

where **I** 2 is the 2 _×_ 2 unit matrix and _D_ [�] ( _x, y_ ) is a scalar
function. [14] In this case the final line of Eq. (38) reduces
to ∆ [2] _∇⊥_ _·_ [ _D_ [�] ( _x, y_ ) _∇⊥I_ ( _x, y, z_ = 0)], which agrees with
the representation for a scalar diffusion field in Sec. III C
of Paper I. Moreover, if _D_ ( _x, y_ ) is a sufficiently slowly

[�]
varying function of position that it approximately commutes with the gradient operator—or, alternatively, if we
employ the change of representation for a scalar diffusion
field that is given in Eq. (50) of Paper I—then we obtain
the functional form given in the final line of Eq. (21).


**C.** **Critique of our two informal derivations**


Equations (21) and (38) are Fokker-Planck extensions
of the TIE that may be criticized on the following
grounds. Observe that the coherent-flow middle line of
each equation is of first order with respect to the defocus
distance ∆, whereas the diffuse-flow third line of each
equation is of second order with respect to ∆. If one
considers ∆to be the only relevant expansion parameter, then there is evidently a missing term, namely a
contribution to the coherent flow that is of second order
with respect to ∆. This issue is clarified in Secs. IV and
V below. Alternatively, one may instead consider there
to be _two_ relevant parameters, namely ∆and the scalar
or tensor diffusion field; if the influence of the diffusion
field is sufficiently strong, then Eqs. (21) and (38) may
be used without need for further modification.


**IV.** **AN INFINITY OF**
**TRANSPORT-OF-INTENSITY EQUATIONS FOR**
**COHERENT PARAXIAL FLOW**


As pointed out in Sec. III C, Eqs. (21) and (38) should
in general be augmented by a coherent-flow term that


13 Note that _ψ_ ( _x, y_ ) denotes a rotation angle in the sense given by
Fig. 9 of Paper I, with _ψ_ ( _x, y, z_ ) denoting a complex wavefield in
the sense employed from Sec. IV onwards in the present paper

[cf. Eq. (1)]. The indicated functional dependence, which is used
consistently, distinguishes the two quantities.
14 Cf. the approximation made in Eq. (115) from Paper I.


is of second order with respect to the defocus distance
∆. This augmentation is very closely related to the
second-order longitudinal intensity derivative, for a coherent paraxial monochromatic scalar beam. As shown
below, this second-order derivative may be obtained by
first calculating _all_ positive-integer orders of the longitudinal intensity derivative. [15] This gives the “infinity of
TIEs” in the title to this section. Our derivation is based
on the previously unpublished analysis by Paganin [41].
We seek all longitudinal intensity derivatives
_∂_ _[m]_ _I_ ( _x, y, z_ ) _/∂z_ _[m]_ associated with the intensity


_I_ ( _x, y, z_ ) = _|ψ_ ( _x, y, z_ ) _|_ [2] (40)


of a paraxial complex scalar field _ψ_ ( _x, y, z_ ). Here, _m_ =
1 _,_ 2 _, · · ·_, the optical axis is _z_, and ( _x, y_ ) are Cartesian
coordinates in planes perpendicular to _z_ . The complex
field _ψ_ ( _x, y, z_ ) is the spatial envelope of the full timedependent complex wave field [cf. Eq. (7)]


Ψ( _x, y, z, t_ ) = _ψ_ ( _x, y, z_ ) exp[ _i_ ( _kz −_ _ωt_ )] _,_ (41)


where _k_ = 2 _π/λ_ is the wavenumber [Eq. (4)] corresponding to the wavelength _λ_, _ω_ is the angular frequency corresponding to the fixed energy _E_ = ℏ _ω_, _t_ denotes time,
and ℏ is Planck’s constant _h_ divided by 2 _π_ .
This formalism is simultaneously applicable to a
number of scenarios, including but not limited to (i)
monochromatic complex scalar paraxial electromagnetic
waves in situations where the polarization degree of freedom may be ignored, (ii) paraxial monoenergetic electron beams where the influence of spin may be neglected,
and (iii) paraxial energy-filtered neutron beams where
the influence of the neutron magnetic moment may be
neglected. In all of these cases, the Helmholtz equation (time-independent free-space Schr¨odinger equation,
time-independent free-space Klein-Gordon equation)


( _∇_ [2] + _k_ [2] )[ _ψ_ ( _x, y, z_ ) exp( _ikz_ )] = 0 (42)



8


terms in the resulting double summation so that the coefficients of increasing powers of ∆are isolated. Hence




- _m_ _m_

 

_n_ =0




- _m_
_n_







_I_ ( _x, y,z_ = ∆) =



_∞_



_m_ =0



�� _i_


2 _k_



_×_ �� _∇_ [2] _⊥_    - _m−n ψ_ ( _x, y, z_ = 0)�


_m_
_×_ �� _−∇_ [2] _⊥_    - _n ψ∗_ ( _x, y, z_ = 0)� [�] ∆ _m_ ! _[,]_ (45)


where

      - _m_      - _m_ !

= (46)

_n_ _n_ !( _m −_ _n_ )! _[,]_


is the binomial coefficient, and an asterisk superscript
denotes complex conjugation. Term-by-term comparison
of Eq. (45) with the Taylor series expansion




- _∂m_



_∂m_ 
_∂z_ _[m]_ _[I]_ [(] _[x, y, z]_ [)]



(47)

_z_ =0



_I_ ( _x, y, z_ = ∆) =



_∞_



_m_ =0



∆ _[m]_


_m_ !



for the intensity shows that




- _∂m_




  - _i_
=
_z_ =0 2



_∂m_ 
_∂z_ _[m]_ _[I]_ [(] _[x, y, z]_ [)]



2 _k_




- _m_ _m_

 

_n_ =0




- _m_ _n_



_×_ �� _∇_ [2] _⊥_       - _m−n ψ_ ( _x, y, z_ = 0)�

_×_ �� _−∇_ [2] _⊥_       - _n ψ∗_ ( _x, y, z_ = 0)� _._ (48)


Dropping the “ _z_ = 0” qualification then gives the required infinity of TIEs, namely [41]



_∂_ _[m]_



_∂_ _[m]_ - _i_

_∂z_ _[m]_ _[I]_ [(] _[x, y, z]_ [) =] 2



2 _k_




- _m_ _m_

 

_n_ =0




- _m_ _n_



reduces to the paraxial equation (parabolic equation)

    -     2 _ik_ _[∂]_ [+] _[ ∇]_ [2] _ψ_ ( _x, y, z_ ) = 0



_∂z_ [+] _[ ∇]_ _⊥_ [2]




_ψ_ ( _x, y, z_ ) = 0 (43)



under the paraxial approximation. Above, the threedimensional Laplacian _∇_ [2] is given by Eq. (3), with the
transverse Laplacian _∇_ [2] _⊥_ [corresponding to Eq. (13).]
A formal solution to the paraxial equation is [2, 10]



_ψ_ ( _x, y, z_ = ∆) = exp - _i_ ∆ _∇_ 2 _⊥_
2 _k_




_ψ_ ( _z, y, z_ = 0) _._ (44)



_×_ �� _∇_ [2] _⊥_  - _m−n ψ_ ( _x, y, z_ )��� _−∇_ [2] _⊥_  - _n ψ∗_ ( _x, y, z_ )� _._ (49)


This relates the indicated transverse derivatives of the
unpropagated complex field _ψ_ ( _x, y, z_ = 0) to the _m_ th
derivative of intensity with respect to _z_ (where _m_ =
0 _,_ 1 _,_ 2 _, · · ·_ ).
For the trivial special case where _m_ = 0, Eq. (49)
reduces to Eq. (40). When _m_ = 1, Eq. (49) reduces to
the standard form of the TIE in Eq. (10). If _m_ = 2, we
obtain the _second-order intensity transport equation_


2 _k_ [2] _[ ∂]_ _∂z_ [2][2] _[I]_ [(] _[x, y, z]_ [) =] �� _∇_ 2 _⊥_ _[ψ]_ [(] _[x, y, z]_ [)] ��2

_−_ Re    - _ψ_ _[∗]_ ( _x, y, z_ )( _∇_ [2] _⊥_ [)][2] _[ψ]_ [(] _[x, y, z]_ [)]    - _._ (50)


Hence, if ∆is sufficiently small that only the first three
terms in Eq. (47) need to be retained, the propagated
intensity associated with Fresnel diffraction may be approximated by



Expand the exponential as a Taylor series, then form the
squared magnitude of the ensuing expression. Arrange


15 This infinite set of transport-of-intensity equations might be of
utility in contexts beyond those explored in the present paper.


9


_I_ ( _x, y, z_ = ∆) _≈_ _I_ ( _x, y, z_ = 0) _−_ [∆] (51)

_k_ _[∇][⊥]_ _[·]_ [ [] _[I]_ [(] _[x, y, z]_ [ = 0)] _[∇][⊥][ϕ]_ [(] _[x, y, z]_ [ = 0)]]



+ [∆][2]

4 _k_ [2]



���� _∇_ 2 _⊥_ - ~~�~~



_I_ ( _x, y, z_ = 0) _e_ _[iϕ]_ [(] _[x,y,z]_ [=0)][���] 2 _−_ Re - ~~�~~

                


_I_ ( _x, y, z_ = 0) _e_ _[iϕ]_ [(] _[x,y,z]_ [=0)][���] _._



_I_ ( _x, y, z_ = 0) _e_ _[−][iϕ]_ [(] _[x,y,z]_ [=0)] ( _∇_ [2] _⊥_ [)][2][ �] ~~[�]~~



The upper line is the first-order finite-difference form of
the TIE [Eq. (12)], which quantifies out-of-focus contrast

[9–12] in a physically intuitive manner that accords with
our earlier statements regarding the local convergence or
divergence of the wavefield upon propagation through a
small distance. The lower line of Eq. (51) is a correction
associated with the second-order TIE [Eq. (50)].


**V.** **FOKKER-PLANCK AND EXTENDED**
**FOKKER-PLANCK GENERALIZATIONS OF**
**THE TRANSPORT-OF-INTENSITY EQUATION**


For the boundary-value problem of paraxial coherent
scalar wave propagation, the formal solution in Eq. (44)
may be written as (see, e.g., Sec. 1.4.1 of Ref. [42])


_ψ_ ( _x, y, z_ = ∆) = _D_ ∆ [(F)] _[ψ]_ [(] _[z, y, z]_ [ = 0)] _[.]_ (52)


Here, the Fresnel diffraction operator _D_ ∆ [(F)] acts on the
unpropagated complex wavefield _ψ_ ( _z, y, z_ = 0), to yield
the propagated wavefield _ψ_ ( _z, y, z_ = ∆). A Fourier representation of this diffraction operator is


_D_ ∆ [(F)] = _F_ _[−]_ [1] exp[ _−i_ ∆( _kx_ [2] [+] _[ k]_ _y_ [2][)] _[/]_ [(2] _[k]_ [)]] _[F]_ _[,]_ (53)


where _F_ denotes Fourier transformation with respect to
_x_ and _y_ using the convention



this plane (see Fig. 1). This situation may be generalized
by considering both coherent and diffuse paraxial flow to
be present simultaneously (see Fig. 2).
In particular, consider a thin sample to be positioned
immediately upstream of _z_ = 0. By assumption, this
sample is illuminated by a normally-incident coherent
scalar plane wave exp( _ikz_ ). The spatially unresolved
microstructure within the sample leads to a bifurcation
of the incident paraxial flow, such that the transmitted flow—over the nominally planar exit surface _z_ = 0
of the sample—is a sum of both coherent and diffuse
components. Restricting consideration to physical models where the intensities of the two components may be
added, we may write the propagated intensity as [16]


_I_ ( _x, y, z_ = ∆) (55)



(F) ��
= ��� _D_ ∆



2
_Ic_ ( _x, y, z_ = 0) exp[ _iϕ_ ( _x, y, z_ = 0)]
����



�� _∞_
+ _Id_ ( _x_ _[′]_ _, y_ _[′]_ _, z_ = 0) _K_ ( _x_ _[′]_ _, y_ _[′]_ _, x, y,_ ∆) _dx_ _[′]_ _dy_ _[′]_ _._

_−∞_


In the middle line above, _Ic_ ( _x, y, z_ = 0) denotes the coherent component of the intensity distribution over the
exit surface of the sample, with _ϕ_ ( _x, y, z_ = 0) being the
phase of the complex disturbance



_ψ_ ( _x, y, z_ ) = 


_Ic_ ( _x, y, z_ ) exp[ _iϕ_ ( _x, y, z_ )] (56)



_F_ _g_ ( _x, y_ ) = [1]

2 _π_



_F_ _g_ ( _x, y_ ) = [1]



�� _∞_

_g_ ( _x, y_ ) exp[ _−i_ ( _kxx_ + _kyy_ )] _dxdy_
_−∞_



(54)
for a well-behaved function _g_ ( _x, y_ ), _F_ _[−]_ [1] denotes the corresponding inverse Fourier transformation, and ( _kx, ky_ )
are Fourier-space coordinates corresponding to ( _x, y_ ).
The exponential function in Eq. (53) may be spoken
of as the “Fourier representation of the Fresnel propagator” or the “free-space complex transfer function”.
Taken together, Eqs. (52) and (53) are equivalent to
the convolution formulation of Fresnel diffraction [43],
thereby indicating the inverse Fourier transformation of
exp[ _−i_ ∆( _kx_ [2] [+] _[k]_ _y_ [2][)] _[/]_ [(2] _[k]_ [)] to be proportional to the paraxial]
approximation for an expanding spherical wave (Huygens
wavelet, outgoing Green function).
The preceding summary of basic Fresnel diffraction
theory assumes exclusively coherent paraxial flow to be
present, both over the plane _z_ = 0 and downstream of



that is associated with this coherent flow. In the bottom
line of Eq. (55), _Id_ ( _x_ _[′]_ _, y_ _[′]_ _, z_ = 0) is the diffuse component of the intensity distribution over the exit surface of
the sample, and the kernel _K_ ( _x_ _[′]_ _, y_ _[′]_ _, x, y,_ ∆) of the integral transform is a diffusion function [cf. Eq. (1) in Paper
I]. The diffusion function quantifies the effect of positiondependent blur, upon propagating through a positive distance ∆, with this blurring being due to the influence of
unresolved microstructure in the sample. [17]

By definition, _K_ ( _x_ _[′]_ _, y_ _[′]_ _, x, y,_ ∆) is the intensity distribution over the plane _z_ = ∆, as a function of transverse coordinates ( _x, y_ ), that arises from a pointlike unit-strength
diffusing intensity distribution


_Id_ ( _x, y, z_ = 0) = _δ_ ( _x −_ _x_ _[′]_ _, y −_ _y_ _[′]_ ) (57)


16 Cf. the very similar form arising from the first-principles analysis
in Eqs. (27), (28), (33), and (42)-(44) of Paganin and Morgan [3].
17 If one extends from coherent to partially coherent illumination,
blurring may also be due to the smearing effects of an extended
chaotic source (see Fig. 3 of Paper I).


at the transverse location ( _x_ _[′]_ _, y_ _[′]_ ) over the plane _z_ = 0,
where _δ_ ( _x, y_ ) is a two-dimensional Dirac delta. Thus,
_K_ ( _x_ _[′]_ _, y_ _[′]_ _, x, y,_ ∆) may be viewed as the Green function associated with an anomalous diffusion equation [44, 45], in
the same sense that was given in the paragraph containing Eqs. (10)-(12) in Paper I. In particular, “anomalous”
rather than “normal” diffusion will usually be operative
for the blurring of _Id_ ( _x, y, z_ = ∆) with increasing ∆,
because the local blur width will typically scale in proportion to the evolution parameter ∆(rather than the
square root of this parameter, as would be the case for
normal diffusion [46]). The diffusion function (i) is normalized to unity via


�� _∞_

_K_ ( _x_ _[′]_ _, y_ _[′]_ _, x, y,_ ∆) _dx_ _[′]_ _dy_ _[′]_ = 1 (58)
_∞_


as a direct consequence of the conservation of energy

[cf. Eq. (3) in Paper I], (ii) has first moments which are
assumed to vanish, so that


�� _∞_
0 = ( _x −_ _x_ _[′]_ ) _K_ ( _x_ _[′]_ _, y_ _[′]_ _, x, y,_ ∆) _dx_ _[′]_ _dy_ _[′]_

_∞_

�� _∞_
= ( _y −_ _y_ _[′]_ ) _K_ ( _x_ _[′]_ _, y_ _[′]_ _, x, y,_ ∆) _dx_ _[′]_ _dy_ _[′]_ (59)

_∞_


because we only consider models where net refraction is
exclusively associated with the coherent component of
the total flow [cf. Eq. (4) in Paper I], (iii) is assumed to
be rotationally symmetric about its center, so that


�� _∞_
0 = ( _x −_ _x_ _[′]_ )( _y −_ _y_ _[′]_ ) _K_ ( _x_ _[′]_ _, y_ _[′]_ _, x, y,_ ∆) _dx_ _[′]_ _dy_ _[′]_ _,_ (60)

_∞_


and (iv) is of a form that implies zero blur at zero prop


10


agation distance ∆, hence


_K_ ( _x_ _[′]_ _, y_ _[′]_ _, x, y,_ ∆= 0) = _δ_ ( _x −_ _x_ _[′]_ _, y −_ _y_ _[′]_ ) _._ (61)


Following similar logic to that given in Eqs. (1)-(8) from
Paper I, the diffusion-function properties in Eqs. (58)(61) imply that the final line of Eq. (55) may be approximated as the energy-preserving flow

�� _∞_

_Id_ ( _x_ _[′]_ _, y_ _[′]_ _, z_ = 0) _K_ ( _x_ _[′]_ _, y_ _[′]_ _, x, y,_ ∆) _dx_ _[′]_ _dy_ _[′]_ (62)
_−∞_

_≈_ _Id_ ( _x, y, z_ = 0) + [1] _⊥_   - _σ_ ∆ [2] [(] _[x, y]_ [)] _[I][d]_ [(] _[x, y, z]_ [ = 0)]   - _,_

2 _[∇]_ [2]


provided ∆is sufficiently small. Here,



is the position-dependent standard deviation (halfwidth) of the rotationally symmetric diffusion function.
Inspired by the two-fluid model of superfluidity [18] we
now write the total intensity as


_I_ ( _x, y, z_ ) = _Ic_ ( _x, y, z_ ) + _Id_ ( _x, y, z_ ) _._ (64)


The position-dependent fraction of the total intensity,
that is associated with the diffuse flow, is an orderparameter field [50] given by [19]


_Id_ ( _x, y, z_ )
_F_ ( _x, y, z_ ) = _[I][d]_ [(] _[x, y, z]_ [)] (65)
_Ic_ ( _x, y, z_ ) + _Id_ ( _x, y, z_ ) [=] _I_ ( _x, y, z_ ) _[.]_


We may then write


_Ic_ ( _x, y, z_ ) = [1 _−_ _F_ ( _x, y, z_ )] _I_ ( _x, y, z_ ) _,_
_Id_ ( _x, y, z_ ) = _F_ ( _x, y, z_ ) _I_ ( _x, y, z_ ) _,_
0 _≤_ _F_ ( _x, y, z_ ) _≤_ 1 _,_ (66)


so that Eq. (55) becomes [20]



_σ_ ∆ [2] [(] _[x, y]_ [) = ][1]

2



�� _∞_

[( _x −_ _x_ _[′]_ ) [2] + ( _y −_ _y_ _[′]_ ) [2] ]
_−∞_

_×K_ ( _x_ _[′]_ _, y_ _[′]_ _, x, y,_ ∆) _dx_ _[′]_ _dy_ _[′]_ (63)



_I_ ( _x, y, z_ = ∆) = ��� _D_ ∆(F)� ~~�~~ [1 _−_ _F_ ( _x, y, z_ = 0)] _I_ ( _x, y, z_ = 0) exp[ _iϕ_ ( _x, y, z_ = 0)]����2



�� _∞_
+ _F_ ( _x_ _[′]_ _, y_ _[′]_ _, z_ = 0) _I_ ( _x_ _[′]_ _, y_ _[′]_ _, z_ = 0) _K_ ( _x_ _[′]_ _, y_ _[′]_ _, x, y,_ ∆) _dx_ _[′]_ _dy_ _[′]_ _._ (67)

_−∞_



18 See Tisza [47], together with the textbook accounts on pp. 152159 of Yourgrau and Mandelstam [48] or pp. 311-313 of Huang

[49], regarding the decomposition of quantum-liquid flow into
a superfluid and an ordinary fluid. This two-fluid model has
some points of similarity with our decomposition of paraxialwave intensity transport into coherent and diffuse flow channels.
19 One may also consider _F_ ( _x, y, z_ ) to be a non-standard mea


sure of the degree of partial coherence, which may be compared
to commonly employed measures of the degree of coherence in
standard works such as Zernike [51] and Mandel and Wolf [52]
(cf. Sec. IX D). Moreover, for the idealized case of a thin sample
illuminated by strictly monochromatic light, _F_ ( _x, y_ ) is equal to
the position-dependent total scattering cross section (for diffuse
scatter) per unit area.
20 Cf. Eqs. (27), (33), and (42) in Paganin and Morgan [3].


As mentioned earlier, it will often be the case that
the blurring-kernel half-width _σ_ ∆( _x, y_ ) is directly proportional to ∆, when this blur is associated with rotationally symmetric paraxial diffuse-scatter cones such as
those shown in Figs. 3, 5, 6, 7, and 10(b) of Paper I. With
a loss of generality that is readily dropped if needed, we
assume this direct proportionality and thereby write


tan _θs_ ( _x, y_ ) _≈_ _θs_ ( _x, y_ ) = _[σ]_ [∆][(] _[x, y]_ [)] _._ (68)

∆


Here, _θs_ ( _x, y_ ) _≪_ 1 is the paraxial apex half-angle of the



11


diffuse-scatter cone that may be associated, e.g., with
spatially unresolved random sample microstructure (see
Fig. 3 of Paper I). The assumption that [21]


_σ_ ∆( _x, y_ ) _∝_ ∆ _,_ (69)


when coupled with the approximation for the diffuse
channel of the flow in Eq. (62), results in the bottom
line of Eq. (67) being estimated by an expression including a term on the order of ∆ [2] . Working to the same order
in ∆for the first line of Eq. (67) may be achieved with
the help of Eq. (51). We thereby arrive at



_I_ ( _x, y, z_ = ∆) = _I_ ( _x, y, z_ = 0) _−_ [∆] _⊥_ [[] _[D]_ [(] _[x, y]_ [)] _[I]_ [(] _[x, y, z]_ [ = 0)]]

_k_ _[∇][⊥]_ _[· {]_ [[1] _[ −]_ _[F]_ [(] _[x, y]_ [)]] _[ I]_ [(] _[x, y, z]_ [ = 0)] _[∇][⊥][ϕ]_ [(] _[x, y]_ [)] _[}]_ [ + ∆][2] _[∇]_ [2]



2

[1 _−_ _F_ ( _x, y_ )] _I_ ( _x, y, z_ = 0) _e_ _[iϕ]_ [(] _[x,y]_ [)][���]

                      


+ [∆][2]

4 _k_ [2]



���� _∇_ 2 _⊥_ ��



��

_−_ Re




[1 _−_ _F_ ( _x, y_ )] _I_ ( _x, y, z_ = 0) _e_ _[−][iϕ]_ [(] _[x,y]_ [)] ( _∇_ [2] _⊥_ [)][2][ �] ~~[�]~~




[1 _−_ _F_ ( _x, y_ )] _I_ ( _x, y, z_ = 0) _e_ _[iϕ]_ [(] _[x,y]_ [)][���]



_,_ (70)



where we have introduced the abbreviations


_F_ ( _x, y_ ) _≡_ _F_ ( _x, y, z_ = 0) (71)

_ϕ_ ( _x, y_ ) _≡_ _ϕ_ ( _x, y, z_ = 0) _,_ (72)


and made use of the dimensionless diffusion coefficient
_D_ ( _x, y_ ) in Eq. (20).
If rotational symmetry cannot be assumed for the diffusion function _K_ ( _x_ _[′]_ _, y_ _[′]_ _, x, y,_ ∆) at every fixed value for
( _x_ _[′]_ _, y_ _[′]_ ), but it can instead be approximated by an elliptical form (see Fig. 9 in Paper I), we can follow the associated development in Sec. IV A of that paper by making
the replacement [22]


_∇_ [2] _⊥_ [[] _[D]_ [(] _[x, y]_ [)] _[I]_ [(] _[x, y, z]_ [ = 0)]]

_−→∇⊥_ _·_ [ **D** [�] ( _x, y_ ) _∇⊥I_ ( _x, y, z_ = 0)] (73)


in the first line of Eq. (70). Here, **D** ( _x, y_ ) is the dimen
[�]
sionless symmetric tensor diffusion field

**D**  - ( _x, y_ ) = [1] 2 _[F]_ [(] _[x, y]_ [)] (74)





[ _Rψ_ ( _x,y_ )] _[T]_



_× Rψ_ ( _x,y_ )



�[ _θ_ 1( _x, y_ )] [2] 0
0 [ _θ_ 2( _x, y_ )] [2]



21 The constant of proportionality, which is implicit in Eq. (69), is
a function of _x_ and _y_ .
22 Cf. pp. 5-6 of Crank [36] and p. 88 of Pavliotis [53], together with
the form of “directional” (diffusive) dark-field imaging reported
in Jensen _et al._ [54, 55]. Note, moreover, that the tilde on the
right side of Eq. (73) accords with the notation in Secs. III C and
IV A of Paper I, together with Eq. (37) of the present paper.



that is obtained by combining Eqs. (103) and (106) of
Paper I, the matrix field


�cos _ψ_ ( _x, y_ ) _−_ sin _ψ_ ( _x, y_ )�
_Rψ_ ( _x,y_ ) = (75)
sin _ψ_ ( _x, y_ ) cos _ψ_ ( _x, y_ )


corresponds to the position-dependent principal-axis rotation angle for the approximately-elliptical smearing
function (see Fig. 9 of Paper I), the transverse gradient
_∇⊥_ is taken to be a two-component column-vector operator ( _∂/∂x, ∂/∂y_ ) _[T]_, a superscript _T_ denotes matrix transposition, the transverse divergence _∇⊥·_ is taken to be a
row-vector operator ( _∂/∂x, ∂/∂y_ ), and _θ_ 1( _x, y_ ) _, θ_ 2( _x, y_ )
denote the position-dependent angular half-widths associated with the principal axes of the smearing-function
ellipse (again see Fig. 9 in Paper I). Comparison of
Eqs. (37) and (74) shows the lower line of the latter equation to coincide with the diagonalized factorization of the
angular-deflection covariance-matrix field in Eq. (34).
We speak of Eq. (70), together with the variant given
by the replacement in Eq. (73), as the _extended Fokker-_
_Planck generalization of the transport-of-intensity equa-_
_tion for paraxial wave optics_ . This terminology is chosen
because, if _D_ ( _x, y_ ) is sufficiently large [23] that the second


23 The dimensionless diffusion field _D_ ( _x, y_ ) is always much smaller
than unity, for the paraxial scenarios to which we restrict consideration. This smallness compared to unity arises from the fact
that paraxiality implies the inequality _θs_ ( _x, y_ ) _≪_ 1, which may
be combined with the constraint that _F_ ( _x, y_ ) _≤_ 1 to observe from
Eq. (20) that 0 _≤_ _D_ ( _x, y_ ) _≪_ 1. Thus, when writing the words “if
_D_ ( _x, y_ ) is sufficiently large” in the main text, what is meant is


and third lines of Eq. (70) may be neglected, then (i)
Eq. (70) reduces to Eq. (21) and (ii) with the replacement in Eq. (73), Eq. (70) reduces to the finite-difference
form


_I_ ( _x, y, z_ = ∆ _≥_ 0) = _I_ ( _x, y, z_ = 0)

_−_ [∆]

_k_ _[∇][⊥]_ _[· {]_ [[1] _[ −]_ _[F]_ [(] _[x, y]_ [)]] _[I]_ [(] _[x, y, z]_ [ = 0)] _[∇][⊥][ϕ]_ [(] _[x, y]_ [)] _[}]_

+ ∆ [2] _∇⊥_ _·_ [ **D** [�] ( _x, y_ ) _∇⊥I_ ( _x, y, z_ = 0)] _,_ (76)


of the anisotropic-diffusion Fokker-Planck equation in
Eq. (147) of Paper I. These special cases [Eqs. (21)
and (76)] may both be spoken as _Fokker-Planck gener-_
_alizations of the TIE for paraxial wave optics_ . [24] Thus
Eq. (70)—together with the variant obtained via the
replacement in Eq. (73)—is an “extended” form of
Eqs. (21) and (76), in the sense that the second and third
lines of Eq. (70) are omitted in Eqs. (21) and (76).


**VI.** **ROUTE FROM NONEQUILIBRIUM**
**STATISTICAL MECHANICS TO PARAXIAL**
**BEAM OPTICS, VIA THE FOKKER-PLANCK**
**EQUATION**


Here we establish broader context regarding the
Fokker-Planck extension to the TIE. In Sec. VI A we
briefly revise some salient elements regarding the FokkerPlanck equation (forward Kolmogorov equation) [19]
in its more usual context of nonequilibrium statistical
physics. Section VI B clarifies the conceptual and mathematical connection, between this master equation [25] and
the present context of paraxial-optics diffusion fields.


**A.** **Fokker-Planck equation in generic form**


The Fokker-Planck equation is a particular form of
continuity equation, which governs the evolution of a
probability density function as it diffuses and drifts with
time. It is often used in nonequilibrium statistical mechanics since it can allow one to study the manner in


“even though _D_ ( _x, y_ ) is intrinsically small in the absolute sense
that it is a dimensionless non-negative quantity that is much
less than unity for all paraxial diffusion fields, this quantity may
nevertheless be sufficiently large in the relative sense that the
only term, of order ∆ [2], that needs to be retained in Eq. (70) is
∆ [2] _∇_ [2] _⊥_ [[] _[D]_ [(] _[x, y]_ [)] _[ I]_ [(] _[x, y, z]_ [ = 0)]”. From a physical perspective, this]
approximation corresponds to the blurring influence of the diffusion field being large in comparison to the influence of diffraction
(to second order in ∆). Such an approximation is particularly
likely to break down at sharp sample edges [26].
24 Very similar expressions are given in Refs. [3] and [4]. For the
case where _F_ ( _x, y_ ) _≪_ 1, Eqs. (21) and (76) have been utilized in
a number of recent papers on x-ray optics [18, 21–26, 40, 56–60]
and mentioned in one paper on neutron optics [39].
25 “Master equations” are “equations of motion for various probability distributions” (see p. 878 of Mandel and Wolf [52]).



12


which statistical equilibrium is approached in thermodynamic systems (Ref. [61], p. 157). It is also employed in
a plethora of additional settings [3, 19, 30, 53, 62] that
will not be reviewed here.
Following p. 169-170 of Ref. [63], this equation is



Here, _p_ ( _**ξ**_ _, t_ ) is a multicomponent probability density
function associated with the _N_ -component vector


_**ξ**_ ( _t_ ) = ( _ξ_ 1( _t_ ) _, ξ_ 2( _t_ ) _, · · ·, ξN_ ( _t_ )) (78)


that stochastically evolves with time _t_, the set _{Dij_ ( _**ξ**_ _, t_ ) _}_
gives the elements of a symmetric _N ×N_ diffusion-matrix
field _**D**_ ( _**ξ**_ _, t_ ) which governs the manner in which the probability density diffuses with time, and


_**f**_ ( _**ξ**_ _, t_ ) = ( _f_ 1( _**ξ**_ _, t_ ) _, f_ 2( _**ξ**_ _, t_ ) _, · · ·, fN_ ( _**ξ**_ _, t_ )) (79)


is an _N_ -component drift-vector field which may be
thought of a local velocity vector in _**ξ**_ space.
Loosely, the diffusion matrix is associated with the
manner in which the probability density smears out in
_**ξ**_ space with time, with the drift vector being associated
with the shifting of peak values for _p_ ( _**ξ**_ _, t_ ) in _**ξ**_ space as
time evolves. Any one particular instance of _**ξ**_ ( _t_ ) may be
viewed as a time-dependent point in _**ξ**_ space whose evolution is generated by a stochastic differential equation;
the drift vector is associated with deterministic generalized forces [64] that act on _**ξ**_ ( _t_ ), with the diffusion matrix
being related to random generalized forces acting on _**ξ**_ ( _t_ ).
Under this view, there is a correspondence between the
stochastic differential equation for one particular realization of _**ξ**_ ( _t_ ), and the associated Fokker-Planck equation
for the probability density associated with an ensemble
of realizations (Ref. [63], pp. 73, 120, and 169-170).


**B.** **Fokker-Planck equation in paraxial-optics form**


To connect the generic Fokker-Planck equation in
Eq. (77) with our context of paraxial optics, consider
Fig. 3. Here, an extended chaotic source _A_ of quasimonochromatic [26] radiation or matter waves, which are
paraxial with respect to an optical axis _z_, illuminates a
sample _B_ . The transmitted waves pass through an imaging system _C_ that forms a real image _I_ ( _x, y, z_ = 0) of


26 The source may also be broadband, in which case energy filtration (quasimonochromatization) may be performed by the detector, or by a monochromator or energy filter upstream of the
detector.



_∂_
_∂t_ _[p]_ [(] _**[ξ]**_ _[, t]_ [) =] _[ −]_



_N_



_i_ =1



_∂_

[ _p_ ( _**ξ**_ _, t_ ) _fi_ ( _**ξ**_ _, t_ )]
_∂ξi_



_N_



_j_ =1



+



_N_



_i_ =1



_∂_ [2]

[ _Dij_ ( _**ξ**_ _, t_ ) _p_ ( _**ξ**_ _, t_ )] _._ (77)
_∂ξi∂ξj_


_B_ over the plane _D_ . Over-focused and under-focused
images may also be registered over planes _E_ and _F_, corresponding to _I_ ( _x, y, z_ = ∆) and _I_ ( _x, y, z_ = _−_ ∆), respectively. [27] The sample is considered to be sufficiently
weakly scattering that the exiting beam remains paraxial.
We also assume the sample to be elastically scattering,
so that the energy of the incident and transmitted fields
is unchanged. The volume between the exit surface of _C_
and the detection planes _{D, E, F_ _}_ is taken as vacuum.


FIG. 3. Generic imaging setup for paraxial diffusion-field retrieval using Fokker-Planck and extended Fokker-Planck generalizations of the TIE.


Conservation of energy implies that the propagating
paraxial intensity distribution _I_ ( _x, y, z_ ) obeys

��
_I_ ( _x, y, z_ ) _dx dy ≡_ _κ_ = constant _,_ (80)


over any plane of fixed _z_ in the free space between the
exit surface of _C_ and the detection planes _D_, _E_, _F_ . [28]

Over any two-dimensional plane of fixed _z_, the intensity
may be related to a _z_ -dependent probability density [29]


_p_ ( _x, y_ ; _z_ ) = _I_ ( _x, y, z_ ) _/κ._ (81)


If, in addition, we consider _z_ rather than _t_ to be the
evolution parameter, the replacements


_t −→_ _z,_ _**ξ**_ _−→_ ( _x, y_ ) _,_ ( _f_ 1 _, f_ 2) _−→_ _k_ _[−]_ [1] _∇⊥ϕ_ (82)


change the _N_ = 2 special case of Eq. (77) to


_∂_
_∂z_ _[I]_ [(] _[x, y, z]_ [) =] _[ −]_ _k_ [1] _[∇][⊥]_ _[·]_ [ [] _[I]_ [(] _[x, y, z]_ [)] _[ ∇][⊥][ϕ]_ [(] _[x, y, z]_ [)]]

+ _[∂]_ [2]

_∂x_ [2] [[] _[D][xx]_ [(] _[x, y, z]_ [)] _[ I]_ [(] _[x, y, z]_ [)]]

+ _[∂]_ [2]

_∂y_ [2] [[] _[D][yy]_ [(] _[x, y, z]_ [)] _[ I]_ [(] _[x, y, z]_ [)]]

+ 2 _[∂]_ [2] (83)

_∂x∂y_ [[] _[D][xy]_ [(] _[x, y, z]_ [)] _[ I]_ [(] _[x, y, z]_ [)]] _[ .]_


27 Alternatively, over-focused and under-focused images _I_ ( _x, y, z_ =
_±_ ∆) may be obtained by keeping the detection plane fixed and
suitably altering the state of the imaging system _C_ . Our treatment applies to either scenario, but for simplicity we refer to the
free-space propagation geometry of Fig. 3, in the main text.
28 Cf. the paragraph containing Eqs. (26) and (27), in Paper I.
29 See, e.g., p. 805 of Barrett and Myers [65].



13


While we can already recognize the TIE [Eq. (10)] in
the first line of Eq. (83), some care is needed regarding
the subsequent lines, on account of the distinction between normal and anomalous diffusion [44, 45] that was
discussed in Sec. II of Paper I. Accordingly, set _z_ = 0 in
Eq. (83) and then use the asymmetric-defocus first-order
finite-difference approximation in Eq. (11). Hence


_I_ ( _x,y, z_ = ∆) = _I_ ( _x, y, z_ = 0)

_−_ [∆]

_k_ _[∇][⊥]_ _[·]_ [ [] _[I]_ [(] _[x, y, z]_ [ = 0)] _[ ∇][⊥][ϕ]_ [(] _[x, y]_ [)]]

       - _∂_ 2
+ [∆ _[a]_ [+(1] _[/]_ [2)] ] [2] _∂x_ [2] [[] _[D][xx]_ [(] _[x, y]_ [)] _[ I]_ [(] _[x, y, z]_ [ = 0)]]

+ _[∂]_ [2]

_∂y_ [2] [[] _[D][yy]_ [(] _[x, y]_ [)] _[ I]_ [(] _[x, y, z]_ [ = 0)]]


             
+ 2 _[∂]_ [2] _,_ (84)

_∂x∂y_ [[] _[D][xy]_ [(] _[x, y]_ [)] _[ I]_ [(] _[x, y, z]_ [ = 0)]]


wherein explicit “ _z_ = 0” dependence is dropped for clarity in both the phase _ϕ_ and the diffusion tensor _**D**_, and we
have introduced the anomalous diffusion coefficient _a_ “by
hand”. [30] When _a_ = 0, Eq. (84) is faithful to Eq. (83), insofar as it is a normal-diffusion Fokker-Planck equation
in finite-difference form. When _a_ = 1 _/_ 2 [see Eq. (12)
of Paper I] we have the case of ballistic superdiffusion

[44, 68] that is relevant to us. In this case Eq. (84) is an
anomalous-diffusion Fokker-Planck equation [67, 69, 70]
in finite-difference form. It may also be thought of as a
crudely space-fractional form of Fokker-Planck equation

[71] that displays the required ballistic-superdiffusion behavior (here “fractional” refers to fractional-order differentiation [45, 66]). The “ _a_ = 1 _/_ 2” case of Eq. (84) is
essentially identical to the _F_ ( _x, y_ ) _≪_ 1 special case of
Eq. (76), albeit with a different representation for the
tensorial diffusion field (cf. the distinction between two
different representations for the scalar diffusion field in
Secs. III C and IV A of Paper I). Similarly, if we set
_a_ = 1 _/_ 2 and


_Dxx_ ( _x, y_ ) = _Dyy_ ( _x, y_ ) _≡_ _D_ ( _x, y_ ) _,_ _Dxy_ ( _x, y_ ) = 0 _,_ (85)


Eq. (84) becomes the _F_ ( _x, y_ ) _≪_ 1 special case of Eq. (21);
cf. Eq. (39). Finally, recall that we chose to speak of
Eq. (70) as an “extended” Fokker-Planck equation, which
is consistent with the fact that its second and third lines
are not present in Eq. (84).


We close this section by returning attention to Eq. (82)
and briefly expanding upon the physical meaning of the
three replacements that are given there. (i) Given that


30 Cf. pp. 101-102 of Evangelista and Lenzi [45]. There the normal
diffusion equation is converted to an anomalous diffusion equation “by hand”, in changing one of the integer-order derivatives
to a fractional-order derivative [66]. For similar reasoning in a
Fokker-Planck context, see Yanovsky _et al._ [67].


the image-forming field (e.g., photons, electrons, neutrons etc.) propagates at a fixed speed for monoenergetic or quasimonoenergetic systems, paraxiality implies
that _t ∝_ _z_ for a (mathematical) point that is comoving
with respect to the energy flow. In this sense the first
replacement in Eq. (82) is merely a change of variables
in which time is still the relevant evolution parameter,
from a physical perspective. Moreover, for paraxial electromagnetic beams, _t ∝_ _z_ even in the case of polyenergetic radiation. (ii) Regarding the second replacement
in Eq. (82), ( _x, y_ ) is the transverse apex location of the
cone of small-angle diffuse scatter arising from an ensemble of realizations of the sample microstructure (Paper I, Figs. 3, 5-7, and 10(b)). For ray models, this
diffuse-scatter cone may be associated with an ensemble of continuous random walks [72] through the sample
microstructure (Paper I, Fig. 6). For a wave model, under the first Born approximation [73], see Eq. (111) of
Paper I. (iii) The third replacement in Eq. (82) makes
a physical connection between the generic concept of a
Fokker-Planck drift vector, and the specific notion of deflection angles associated with the coherent flow channel,
namely the paraxial angles


( _αx_ ( _x, y_ ) _, αy_ ( _x, y_ )) = _k_ _[−]_ [1] _∇⊥ϕ_ ( _x, y_ ) (86)


that the coherent-flow current density makes with respect
to the optical axis. While we used wave-optics language
in speaking of _ϕ_ as the “phase” of the propagating beam,
if we work in geometrical-optics terms we can instead
use the Hamiltonian-mechanics concept of “action”. Under this view, the wave-optical notion of a wavefront
(surface of constant phase) reduces to the corresponding
geometrical-optics notion (surface of constant action) in
the short-wavelength limit (Ref. [64], pp. 484-492).


**VII.** **PHASE AND DIFFUSION-FIELD**
**RETRIEVAL VIA THE FOKKER-PLANCK OR**
**EXTENDED FOKKER-PLANCK EQUATIONS**


This section has two parts. Section VII A considers means for phase retrieval that are based on our
Fokker-Planck TIE generalizations [e.g., Eqs. (21), (70),
and (76)]. Here, “phase retrieval” refers to means by
which noninterferometric intensity measurements such as
_I_ ( _x, y, z_ = 0) and _I_ ( _x, y, z_ = _±_ ∆) may be used to infer
wavefield phase _ϕ_ ( _x, y_ ). Diffusion-field retrieval, namely
the question of inferring _D_ ( _x, y_ ) or **D** ( _x, y_ ) from mea
[�]
sured intensity distributions, is treated in Sec. VII B.


**A.** **Phase retrieval**


Many papers utilize the TIE for phase retrieval. See
Zuo _et al._ [16] for an extensive bibliography. Evidently,
our Fokker-Planck extensions to this equation imply the
need to revisit TIE-based phase retrieval. Do such analyses need to be modified when a diffuse channel to



14


the paraxial flow is present? As we shall argue, when
symmetric over-focus and under-focus intensity measurements _I_ ( _x, y,_ = _±_ ∆) are employed, existing TIE-based
approaches to phase retrieval may be used without any
modification, even though a diffuse channel to the flow is
present and a Fokker-Planck extension to the TIE is employed (Sec. VII A 1). However when asymmetric defoci
are employed, such as a focal series where all of the defocus distances ∆have the same sign, modifications to the
phase-retrieval process are required when passing from
the TIE to its Fokker-Planck extensions (Sec. VII A 2).
Structured-illumination approaches to phase retrieval are
considered in Sec. VII A 3.


_1._ _Phase retrieval: Symmetric-defocus case_



The asymmetric-defocus estimate for the longitudinal
intensity derivative, as given in Eq. (11), may be improved by the symmetric-defocus estimate

 - _∂_  - _[I]_ [(] _[x, y, z]_ [ = ∆)] _[ −]_ _[I]_ [(] _[x, y, z]_ [ =] _[ −]_ [∆)]



_∂_ 
_∂z_ _[I]_ [(] _[x, y, z]_ [)]



2∆



_≈_ _[I]_ [(] _[x, y, z]_ [ = ∆)] _[ −]_ _[I]_ [(] _[x, y, z]_ [ =] _[ −]_ [∆)]
_z_ =0 2∆



_≡−k_ _[−]_ [1] _Q_ ( _x, y_ ) _._ (87)


Approximate each term in the numerator on the
right side, using the extended Fokker-Planck equation

[Eq. (70)]. The second and third lines of Eq. (70) make
no contribution, with the diffuse-flow final term on the
first line also dropping out since all of these terms are
proportional to ∆ [2] = ( _−_ ∆) [2] . Hence the known data
function _Q_ ( _x, y_ ) acts as a source term for the elliptic
second-order partial differential equation


_Q_ ( _x, y_ ) = _∇⊥_ _· {_ [1 _−_ _F_ ( _x, y_ )] _I_ ( _x, y, z_ = 0) _∇⊥ϕ_ ( _x, y_ )] _} ._
(88)


Restrict consideration to the case of a weak diffusion field,
so that _F_ ( _x, y_ ) is everywhere much less than unity [see
Eq. (22) of Paper I]. Hence the term in square brackets
in Eq. (88) may be approximated by unity, leaving


_Q_ ( _x, y_ ) = _∇⊥_ _·_ [ _I_ ( _x, y, z_ = 0) _∇⊥ϕ_ ( _x, y_ )] _, F_ ( _x, y_ ) _≪_ 1 _._
(89)


Given the known data function _Q_ ( _x, y_ ) that is constructed using overfocus and underfocus intensities according to Eq. (87), the form in Eq. (89) is identical to
that encountered when working with the “bare” TIE (i.e.,
without any Fokker-Planck extension). Hence if we consider both _Q_ ( _x, y_ ) and _I_ ( _x, y, z_ = 0) to be known by
direct intensity measurements in the infocus plane _z_ = 0
and symmetric-defocus planes _z_ = _±_ ∆, _existing phase-_
_retrieval methods for solving the TIE may be employed_
_without modification_ in order to solve Eq. (89) for the
phase function _ϕ_ ( _x, y_ ). [31]


31 For all methods of the present paper that employ two or more


One such method, due to Paganin and Nugent [15],
will be employed here. This begins by following Teague

[2] in introducing the auxiliary function Υ( _x, y_ ) via


_∇⊥_ Υ( _x, y_ ) = _I_ ( _x, y, z_ = 0) _∇⊥ϕ_ ( _x, y_ ) _._ (90)


We emphasize that an approximation is made in this implicit definition for Υ( _x, y_ ), since the Helmholtz decomposition theorem [32] implies that the vector field on the
right side of Eq. (90) should in general be written as the
sum of the gradient of a scalar potential Υ plus the curl of
a divergence-free vector potential _**η**_ . However, omission
of the vector potential is often an excellent approximation in the context of TIE-based phase retrieval for highly
structured beams [76]; the physical reason for this is that
the local linear momentum density typically has a much
larger magnitude that the local angular-momentum density, for highly structured paraxial beams with continuous (and therefore vortex-free) wavefronts. If vortices
are present (e.g., for fully developed speckle fields [77])
then the vector potential cannot be neglected [15], with
a similar statement applying to gently structured beams

[76] (e.g., in the context of wavefront metrology [78]).
Returning to the main thread of the argument, Eq. (90)
transforms Eq. (89) to the Poisson equation [79]


_Q_ ( _x, y_ ) = _∇_ [2] _⊥_ [Υ(] _[x, y]_ [)] _[.]_ (91)


Formally solve this by applying the inverse transverse



15


Laplacian operator _∇_ _[−]_ _⊥_ [2] [to both sides.][33][ Then apply] _[ ∇][⊥]_
to both sides of the resulting expression, hence


_∇⊥∇_ _[−]_ _⊥_ [2] _[Q]_ [(] _[x, y]_ [) =] _[ ∇][⊥]_ [Υ(] _[x, y]_ [)] _[.]_ (92)


Next, use Eq. (90) for the right side, and divide through
by the infocus intensity _I_ ( _x, y, z_ = 0) under the oftenmild assumption that this does not vanish at any point
within the field of view. This gives


_⊥_ _[Q]_ [(] _[x, y]_ [)]
_∇⊥ϕ_ ( _x, y_ ) = _[∇][⊥][∇][−]_ [2] (93)
_I_ ( _x, y, z_ = 0) _[.]_


We can stop at this point if the intention is to recover
the transverse phase gradients _∇⊥ϕ_ ( _x, y_ ), or, in what
amounts to essentially the same thing, we wish to recover the position-dependent transverse deflection angles
in Eq. (86). If, however, we wish to recover the phase
map _ϕ_ ( _x, y_ ) then we can apply the transverse divergence
operator _∇⊥·_ to both sides of Eq. (93). The resulting
estimate




            - _∇⊥∇−⊥_ 2 _[Q]_ [(] _[x, y]_ [)]
_∇_ [2] _⊥_ _[ϕ]_ [(] _[x, y]_ [) =] _[ ∇][⊥]_ _[·]_
_I_ ( _x, y, z_ = 0)


for the wavefront curvature [34] then gives




(94)




- - 1 _I_ ( _x, y, z_ = ∆) _−_ _I_ ( _x, y, z_ = _−_ ∆)
_∇⊥_ _·_ _I_ ( _x, y, z_ = 0) _[∇][⊥][∇]_ _⊥_ _[−]_ [2] 2∆



��
_,_


(95)



_ϕ_ ( _x, y_ ) = _∇_ _[−]_ _⊥_ [2]




- - _∇⊥∇−⊥_ 2 _[Q]_ [(] _[x, y]_ [)]
_∇⊥_ _·_
_I_ ( _x, y, z_ = 0)



��
= _−k∇_ _[−]_ _⊥_ [2]



which is identical to the Paganin-Nugent TIE-based
phase-retrieval algorithm in Eq. (21) [15] _provided that_
_the longitudinal intensity derivative_ [ _∂I_ ( _x, y, z_ ) _/∂z_ ] _z_ =0
_is estimated using the symmetric-defocus estimate in_
_Eq. (87_ ) above. This statement does not just apply to
the particular method for phase retrieval that is used
above. More generally, _while the presence of a diffusion_
_field extends the TIE into a Fokker-Planck (or extended_
_Fokker-Planck) form, this extension leaves TIE-based al-_


images obtained at different defoci, note that it is possible for
such a “focal stack” to be acquired in a single shot. For a recent example of such “multifocus” imaging systems, see Miyasaki
_et al._ [74].
32 See, e.g., pp. 52-54 of Morse and Feshbach [75]. For the 2D
variant of Helmholtz decomposition, see, e.g., Schmalz _et al._ [76].
33 Cf. Eq. (35) in Paper I.
34 Cf. the concept of “curvature sensing” in the context of astronomical adaptive optics [80]. Also, there are certain contexts in
which the phase curvature _∇_ [2] _⊥_ _[ϕ]_ [(] _[x, y]_ [) is of specific interest, e.g.,]
in transmission electron microscopy, where the phase curvature
is proportional to the projected charge density of a sufficiently
thin sample (in the high-energy limit) [81].



_gorithms for phase retrieval unchanged if symmetric de-_
_foci are used to estimate the longitudinal intensity deriva-_
_tive_ .
Regarding the inverse Laplacian that appears in
Eq. (95), Ref. [15] employed the Fourier representation


1
_∇_ _[−]_ _⊥_ [2] [=] _[ −][F][ −]_ [1] _kx_ [2] + _ky_ [2] + _ϵ_ [2] _[F]_ _[,]_ _ϵ >_ 0 _,_ (96)


where _F_ denotes Fourier transformation with respect
to _x_ and _y_, _F_ _[−]_ [1] denotes the corresponding inverse
Fourier transformation, ( _kx, ky_ ) are Fourier-space coordinates dual to ( _x, y_ ), and _ϵ_ is a positive regularization
parameter [35] that has physical units of inverse length. [36]


35 The regularization parameter avoids the division-by-zero blowup
that would otherwise occur in the denominator of Eq. (96), at
the origin ( _kx, ky_ ) = (0 _,_ 0) of Fourier space.
36 Here and henceforth we avoid redundant brackets by considering
operator products to “act from right to left”. Thus, for example, if _v_ ( _x, y_ ) and _w_ ( _x, y_ ) are arbitrary smooth functions, then
the action of the operator _F_ _[−]_ [1] _v_ ( _x, y_ ) _F_ on _w_ ( _x, y_ ) is equal to
_F_ _[−]_ [1] ( _v_ ( _x, y_ ) _{F_ [ _w_ ( _x, y_ )] _}_ ). Cf. Eq. (53).


Moreover, any Fourier-transform convention may be employed which is such that the Fourier derivative theorem

[82] maps the operators _∂/∂x_ and _∂/∂y_ to multiplication
by _ikx_ and multiplication by _iky_, respectively. [37] The preceding sentence also implies that the gradient operators,
appearing in Eq. (95), may be computed via


_∇⊥_ = _iF_ _[−]_ [1] ( _kx, ky_ ) _F_ _._ (97)


From a data-analysis perspective for pixelated intensity maps [see, e.g., Eq. (38) of Paper I], use of the Fast
Fourier Transform (FFT) [83] to estimate _F_ and _F_ _[−]_ [1]

implies an assumption of periodic boundary conditions.
For highly structured aperiodic wavefields whose number
of independent degrees of freedom in _ϕ_ ( _x, y_ ) is on the order of several hundred or more, this assumption—which
amounts, strictly speaking, to an improper treatment of
boundary conditions associated with the Poisson equations whose solutions are informally denoted by the inverse Laplacian operators in Eq. (95)—typically leads to
errors that are acceptably small. This conclusion arises
from the fact that solutions to the corresponding homogeneous partial differential equation, namely the Laplace
equation, will typically make a small contribution on account of their often unphysical properties that (i) every
point is a saddle point, and (ii) such solutions will attain both their maximum and minimum values over the
boundary of the field of view [79]. See Schmalz _et al._

[76] for further information on the typically mild consequences of implicitly assuming periodic boundary conditions when this is not in fact the case, in the context of
TIE-based phase retrieval using an FFT implementation
of the method of Ref. [15]; the conclusions of Schmalz
_et al._ [76] may also be applied to Eq. (95) above. If
boundary conditions do need to be properly taken into
account, which will certainly be the case for gently structured wavefields such as those encountered in wavefront
metrology, then methods are available to do so (see, e.g.,
Ref. [84]). Also, if zero boundary conditions apply—for
example, in the case of plane-wave illumination of a sample that is well contained within the field of view of the intensity measurements—then the operator _F_ in Eq. (95)
may be replaced with the Fast Sine Transform, using an
analogous approach to that in Sec. III B of Paper I.


_2._ _Phase retrieval: Asymmetric-defocus case_


If no post-specimen imaging system _C_ is employed then
negatively defocused images such as _I_ ( _x, y, z_ = _−_ ∆) are
inaccessible. Upon deleting _C_ from Fig. 3, we return to
the scenario in Fig. 3 of Paper I, where the transmitted
field propagates in vacuum from the exit surface _z_ = 0
of the sample to the entrance surface _z_ = ∆ _≥_ 0 of
the detector. Here we solve the extended Fokker-Planck


37 Equation (54) is an example of such a convention.



16


equation [Eq. (70)] for the case where _F_ ( _x, y_ ) _≪_ 1, in
order to determine the phase _ϕ_ ( _x, y_ ) _≡_ _ϕ_ ( _x, y, z_ = 0)
when intensity measurements are only available for _z ≥_ 0.
Assume the three intensity maps


_I_ 0( _x, y_ ) _≡_ _I_ ( _x, y, z_ = 0)
_I_ 1( _x, y_ ) _≡_ _I_ ( _x, y, z_ = ∆1)
_I_ 2( _x, y_ ) _≡_ _I_ ( _x, y, z_ = ∆2) (98)


to have been measured, where ∆1 and ∆2 _̸_ = ∆1 are both
nonzero. Write down the corresponding “ _z_ = ∆1” and
“ _z_ = ∆2” instances of Eq. (70), which then allows the
resulting system of linear equations to be solved algebraically for _∇⊥_ _· {_ [1 _−_ _F_ ( _x, y_ )] _I_ 0( _x, y_ ) _∇⊥ϕ_ ( _x, y_ )] _}_ because this term is multiplied by ∆whereas all other terms
are proportional to different powers of ∆(i.e., ∆ [2] or ∆ [0] ).
We thereby obtain a modified form of Eq. (88), namely


_Q_ ˘( _x, y_ ) = _∇⊥_ _· {_ [1 _−_ _F_ ( _x, y_ )] _I_ 0( _x, y_ ) _∇⊥ϕ_ ( _x, y_ )] _},_ (99)


where we have introduced the known data function [85] [38]


_Q_ ˘( _x, y_ ) = [∆] 2 [2] _[I]_ [1][(] _[x, y]_ [)] _[ −]_ [∆][2] 1 _[I]_ [2][(] _[x, y]_ [) + (∆][2] 1 _[−]_ [∆] 2 [2][)] _[I]_ [0][(] _[x, y]_ [)] _._
∆1∆2(∆1 _−_ ∆2) _/k_

(100)


Analogous to our passage from Eq. (88) to Eq. (89), the
assumption that _F_ ( _x, y_ ) _≪_ 1 then gives


_Q_ ˘( _x, y_ ) = _∇⊥_ _·_ [ _I_ 0( _x, y_ ) _∇⊥ϕ_ ( _x, y_ )] _, F_ ( _x, y_ ) _≪_ 1 _._ (101)


We emphasize that the preceding equation holds true,
whether we work with (i) the _F_ ( _x, y_ ) _≪_ 1 special case of
the scalar-diffusion extended Fokker-Planck equation in
the form given by Eq. (70), or (ii) the _F_ ( _x, y_ ) _≪_ 1 special
case of the tensor-diffusion extended Fokker-Planck equation that is obtained when the replacement in Eq. (73)
is applied to Eq. (70). In either case, when only nonnegative propagation distances 0 _<_ ∆1 _<_ ∆2 are employed,
the fact that the replacement _Q_ ( _x, y_ ) _−→_ _Q_ [˘] ( _x, y_ ) maps
Eq. (89) to Eq. (101) means that the solution to the latter equation may be obtained by applying the same replacement to Eq. (95). This leads to the following phaseretrieval algorithm for the case of asymmetric defocus,
which is identical to that previously derived by Leatham

[85, 86] in the more restricted context of the _F ≪_ 1 variant of Eq. (21):



While we have written down this result with the case
0 _<_ ∆1 _<_ ∆2 in mind, it may also be applied when ∆1 _<_
0 _<_ ∆2. For the special symmetric-defocus case where


38 Cf. Eq. (61) in Ref. [3] and Eq. (10) in Ref. [21].




_∇⊥∇_ _[−]_ _⊥_ [2] _[Q]_ [˘][(] _[x, y]_ [)]
_I_ 0( _x, y_ )



��



_ϕ_ ( _x, y_ ) = _∇_ _[−]_ _⊥_ [2]





_∇⊥_ _·_



_._ (102)


∆1 = _−_ ∆2 _≡_ ∆ _>_ 0, the three-image data function
_Q_ ˘( _x, y_ ) in Eq. (100) reduces to the two-image data function _Q_ ( _x, y_ ) in Eq. (87), with Eq. (102) thereby reducing
to Eq. (95). Also, if all three defoci _z_ = ∆1 _,_ ∆2 _,_ ∆3 differ
from zero, with ∆1 _̸_ = ∆2 _̸_ = ∆3, then the data function
in Eqs. (100)-(102) should be generalized via the replacement (cf. Ref. [86])


_Q_ ˘ _−→_ [(∆] 2 [2] _[−]_ [∆] 3 [2][)] _[I]_ [1] [+ (∆][2] 3 _[−]_ [∆] 1 [2][)] _[I]_ [2] [+ (∆][2] 1 _[−]_ [∆] 2 [2][)] _[I]_ [3] _,_
(∆1 _−_ ∆3)(∆2 _−_ ∆3)(∆1 _−_ ∆2) _/k_

(103)
where _Ij ≡_ _I_ ( _x, y, z_ = ∆ _j_ ) for _j_ = 1 _,_ 2 _,_ 3 and functional
dependence on ( _x, y_ ) is omitted for clarity. [39] This form
may be of use, for example, when negative ∆values are
inaccessible, but one has the added constraint that ∆ _>_ 0
cannot be made arbitrarily small (since, e.g., the detector
plane _C_ for the lens-free scenario in Fig. 3 of Paper I
cannot be moved to _z_ = 0 on account of the geometry of
that detector). If we set ∆3 to zero, Eq. (103) reverts to
Eq. (100).


_3._ _Phase retrieval: Structured-illumination case_


In passing from Fig. 3 to Fig. 5 in Paper I, structured illumination of a thin sample _B_ was introduced via a mask
_M_ having a position-dependent intensity transmission
function _M_ ( _x, y_ ). As stated in Sec. III D of Paper I, the
purpose of such patterned illumination is “to introduce
a spatially rapidly varying transmission function, which
amplifies the measured signal”. Note that in order to produce structured illumination at the detector, masks may
be designed with a position-dependent transmission function [87–92] or introduce position-dependent phase shifts

[93–95]. In many cases, for example when using a random
speckle generator [96–103], both phase and attenuation
effects will play a role in creating structure in the illumination. While we previously considered such amplification in the setting of paraxial diffusion-field retrieval,
here we revisit this concept for structured-illumination
phase retrieval [87–103].
We simultaneously consider two scenarios, namely (i)
the configuration in Fig. 5 of Paper I, in which the lack
of post-specimen optical elements implies that intensity
images _I_ ( _x, y, z_ = ∆) may only be formed for ∆ _≥_ 0, and
(ii) a modified form of this figure, whereby the introduction of post-specimen optical elements allows intensity
images to be formed for both positive and negative propagation distances (defoci) ∆ ≷ 0 (cf. Fig. 3 above).
Let the complex transmission function of the mask
be - _M_ ( _x, y_ ) exp[ _iϕm_ ( _x, y_ )], where _M_ ( _x, y_ ) _≥_ 0. For

the case of unit-intensity normally-incident coherent


39 Note that if the defocus values all differ from zero, then _I_ 0( _x, y_ )
in Eq. (101) will need to be estimated using _I_ 1( _x, y_ ), _I_ 2( _x, y_ ), and
_I_ 3( _x, y_ ). This can be done via a quadratic fit, at each transverse
position ( _x, y_ ), to the intensity as a function of defocus _z_ .



17


scalar plane-wave illumination, an infocus intensity image _I_ [(] _[m]_ [)] ( _x, y, z_ = 0) of the mask in the absence of the
sample may be used to determine _M_ ( _x, y_ ) via [40]


_I_ [(] _[m]_ [)] ( _x, y, z_ = 0) = _M_ ( _x, y_ ) _._ (104)


Regarding the phase _ϕm_ ( _x, y_ ) of the complex transmission function of the mask, this may be obtained using either (i) the method of Eq. (95) for the symmetrical focal
series _{I_ [(] _[m]_ [)] ( _x, y, z_ = 0) _, I_ [(] _[m]_ [)] ( _x, y, z_ = ∆) _, I_ [(] _[m]_ [)] ( _x, y, z_ =

[�]

_−_ ∆) [�] _}_, using a suitable mask-defocus distance ∆ _>_ 0,

[�]
provided that a post-specimen imaging system is present
in order to register the negative-defocus image over the
plane _z_ = _−_ ∆, or (ii) the method of Eq. (102), using [�]
the data function in Eq. (100) [if intensity images may
be obtained in the planes _z_ = 0, _z_ = ∆ [�] 1 _>_ 0 and
_z_ = ∆ [�] 2 _>_ ∆ [�] 1] or the data function in Eq (103) [if intensity images may be obtained in the positive-defocus
planes _z_ = ∆ [�] 1 _>_ 0, _z_ = ∆ [�] 2 _>_ ∆ [�] 1 and _z_ = ∆ [�] 3 _>_ ∆ [�] 2; for
this case, Eq. (104) cannot be used to estimate _M_ ( _x, y_ ),
so this quantity should instead be estimated via suitable
algebraic manipulation of the images measured in the
planes _z_ = ∆ [�] 1 _,_ ∆ [�] 2 _,_ ∆ [�] 3].
Having determined the complex transmission function

~~�~~ _M_ ( _x, y_ ) exp[ _iϕm_ ( _x, y_ )] of the structured-illumination

mask using intensity measurements that are obtained in
the absence of the sample, the sample may now be placed
either immediately upstream or immediately downstream
of the mask (for the latter variant, see Fig. 5 of Paper
I). Assume that the speckle mask makes no contribution to the diffusion field at the exit surface _z_ = 0 of the
sample-mask system. Suppress functional dependence on
transverse coordinates ( _x, y_ ) for clarity. Moreover, assume that _F ≪_ 1. For a defocus distance of ∆, we may
then use Eq. (70) to generalize Eq. (55) of Paper I. This
leads to the following expression for the intensity distribution _I_ ∆ [(] _[s]_ [+] _[m]_ [)] in the presence of both the sample and the
mask:


_I_ ∆ [(] _[s]_ [+] _[m]_ [)] = _TM_ + ∆ [2] _∇_ [2] _⊥_ [(] _[DTM]_ [)] (105)

_−_ [∆]

_k_ _[∇][⊥]_ _[·]_ [ [] _[MT]_ _[∇][⊥]_ [(] _[ϕ]_ [ +] _[ ϕ][m]_ [)] + ∆][2][Ξ][(] _[s]_ [+] _[m]_ [)] _[.]_


In the preceding equation, _T ≡_ _T_ ( _x, y_ ) is the intensity
transmission function of the sample, _ϕ ≡_ _ϕ_ ( _x, y_ ) is the
phase shift induced by the sample, all functional dependencies on ( _x, y_ ) are suppressed for clarity, and



is a diffraction-induced correction associated with the
second and third lines of Eq. (70).


40 Cf. the ∆= 0 case of Eq. (57) in Paper I. Note also that we are
using a similar notation to that in Sec. III D 1 of Paper I.



2
_TMe_ _[i]_ [(] _[ϕ]_ [+] _[ϕ][m]_ [)][��] (106)

        


Ξ [(] _[s]_ [+] _[m]_ [)] = [1]



4 _k_ [2]



_√_
���� _∇_ 2 _⊥_




   - _√_

_−_ Re



_TMe_ _[−][i]_ [(] _[ϕ]_ [+] _[ϕ][m]_ [)] ( _∇_ [2] _⊥_ [)][2] _[√]_



_TMe_ _[i]_ [(] _[ϕ]_ [+] _[ϕ][m]_ [)][��]


Note the _amplification of the sample phase signal_ via
the divergence term appearing in Eq. (105), due to the
presence of the mask transmission function _M_ . [41] From
a physical perspective, sharply varying mask absorption
leads to large values for _∇⊥M_, amplifying the sensitivity
to sample-induced phase gradients _∇⊥ϕ_ because the refractive effect of phase gradients deforms the sharp mask
edge upon nonzero defocus ∆. [42] In view of this amplification, efficient mask choices have transmission functions
_M_ ( _x, y_ ) that are spatially rapidly varying, such as random patterns [96–102] or grid-type arrays [87, 88, 90, 91]
whose intensity varies significantly over transverse distances on the order of (say) a few pixels.

To solve Eq. (105) for the sample-induced phase shift
_ϕ_, one can measure “sample plus mask” intensities _I_ ∆ [(] _[s]_ [+] _[m]_ [)]
for three different defocus distances, say ∆= 0, ∆= ∆1,
and ∆= ∆2. The mask phase _ϕm_ is assumed to have
been determined using the method described earlier [see
the paragraph containing Eq. (104)]. With these data
the terms containing _D_ and Ξ may be algebraically eliminated from the three instances of Eq. (105) that correspond to the defoci ∆= 0 _,_ ∆1 _,_ ∆2. This yields


_∇⊥_ _·_ ( _I_ 0 [(] _[s]_ [+] _[m]_ [)] _∇⊥ϕ_ ) = _Q_ [�] (107)


where the known data function _Q_ is

[�]



_k_
_Q_ - = ∆1∆2(∆1 _−_ ∆2)




∆ [2] 2 _[I]_ ∆ [(] _[s]_ 1 [+] _[m]_ [)] _−_ ∆ [2] 1 _[I]_ ∆ [(] _[s]_ 2 [+] _[m]_ [)] (108)



18


**B.** **Diffusion-field retrieval**


Here we consider the problem of paraxial diffusion-field
retrieval, namely means to solve the Fokker-Planck or
extended Fokker-Planck equations so as to obtain a scalar
or tensor diffusion field, given intensity measurements
_I_ ( _x, y, z_ = ∆) that are taken for different defocus values
∆. Since only sample-scattered radiation contributes to
our diffusion fields, [43] this inverse problem may be spoken
as a form of “dark-field imaging” [104, 105]. In particular,
for a sample that is entirely contained within the imaging
field of view, a map of the modulus of the sample-induced
diffusion field _D_ ( _x, y_ ) will appear as bright upon a dark
background (see, e.g., Alloo _et al._ [26]).
The remainder of this section has three parts. We
begin by considering the symmetric-defocus case where
both over-focused and under-focused images are available, corresponding to defocus values that are equal in
magnitude but opposite in sign. We then consider the
case of asymmetric defoci, which is important in contexts where no imaging system is present (thereby rending negative-defocus images inaccessible [44] ). Finally, we
consider diffusion-field retrieval using structured illumination.


_1._ _Diffusion-field retrieval: Symmetric-defocus case_


In this subsection we restrict consideration to scalar
diffusion-field retrieval. Two cases are considered, respectively, in the next two paragraphs: (i) the simpler
case of the Fokker-Planck equation obtained by retaining only the first line of Eq. (70) (“Case A”), and (ii) the
more involved case where all three lines of Eq. (70) are
taken into account (“Case B”).
_Case A:_ If only the first line of Eq. (70) is retained,
we obtain the form for the Fokker-Planck extension to
the TIE that was given in Eq. (146) of Paper I (without, however, the restriction to defoci that obey ∆ _≥_ 0).
Now use the symmetric overfocus and underfocus intensity images _I_ ( _x, y, z_ = _±_ ∆), together with the infocus
intensity image _I_ ( _x, y, z_ = 0), to form the data function
_q_ ( _x, y_ ) defined in Eq. (148) of Paper I, namely


_q_ ( _x, y_ ) = _[I]_ [(] _[x, y,]_ [ ∆) +] _[ I]_ [(] _[x, y,][ −]_ [∆)] _[ −]_ [2] _[I]_ [(] _[x, y,]_ [ 0)] _._ (109)

2∆ [2]


43 We here neglect the influence of the term _θ_ 02 [that appears in]
Eq. (24) of Paper I [see, also, Figs. 2 and 3 of Paper I]. Alternatively, we can consider the influence of this term—which represents blurring due to an extended chaotic source—as having
been subtracted from a recovered diffusion field such as _D_ ( _x, y_ ).
44 While this case is perhaps of less importance for the field of
visible-light imaging, it is of key importance in propagationbased x-ray phase contrast imaging [42, 106], namely a form
of inline holography [107] with a sample-to-detector propagation
distance that is sufficiently short for the associated Fresnel number [108] to be on the order of unity or greater.




           +(∆ [2] 1 _[−]_ [∆] 2 [2][)] _[I]_ 0 [(] _[s]_ [+] _[m]_ [)] _−∇⊥_ _·_ ( _I_ 0 [(] _[s]_ [+] _[m]_ [)] _∇⊥ϕm_ ) _._


Equation (107) is identical in form to Eq. (89), if
_I_ ( _x, y, z_ = 0) in Eq. (89) is replaced by _I_ 0 [(] _[s]_ [+] _[m]_ [)] _≡_
_I_ 0 [(] _[s]_ [+] _[m]_ [)] ( _x, y_ ) and _Q_ is replaced by _Q_ [�] . Hence Eq. (107)
may be solved for _ϕ_ in the same manner that was previously employed for solving Eq. (89) [see the first part of
Eq. (95)].

Alternative structured-illumination phase-retrieval algorithms may be constructed by transversely shifting the
mask _M_ to a number of different locations (see Fig. 5 in
Paper I), but to keep this paper to a reasonable length
such algorithms will not be reported here.


41 If there is appreciable distance between the mask and the thin
sample, which we previously illustrated as being “almost touching” in Fig. 5 of Paper I, the previously mentioned concept of
“out of focus contrast” [9–12] implies that phase shifts associated
with the mask can lead to intensity variations over the entrance
surface of the sample. In this case, the mask transmission function and phase-shift function refer to the complex field at the
nominally planar entrance surface of the sample, rather than the
exit surface of the mask. Cf. Fig. 5(a), later in this paper.
42 Cf. the remarks on mask-induced amplification of diffusion-field
intensity signals, in Sec. III D of Paper I.


Following Eq. (149) of Paper I, the measured data function _q_ ( _x, y_ ) may be related to the scalar diffusion field
_D_ ( _x, y_ ) and infocus intensity via the Poisson equation


_∇_ [2] _⊥_ [[] _[D]_ [(] _[x, y]_ [)] _[I]_ [(] _[x, y, z]_ [ = 0)] =] _[ q]_ [(] _[x, y]_ [)] _[.]_ (110)


In a similar manner to the means by which we solved
Eq. (91), we may write a formal solution as


_⊥_ [[] _[q]_ [(] _[x, y]_ [)]]
_D_ ( _x, y_ ) = _[∇][−]_ [2] (111)
_I_ ( _x, y, z_ = 0) _[.]_


The inverse Laplacian can be evaluated in a number of
ways, since it merely indicates that one should “solve
the Poisson equation subject to relevant boundary conditions”. For example, if one makes use of the Fourier
representation for the inverse Laplacian in Eq. (96), the
recovered diffusion field is


_−_ 1 1
_D_ ( _x, y_ ) = _I_ ( _x, y, z_ = 0) _[F][ −]_ [1] _kx_ [2] + _ky_ [2] + _ϵ_ [2] _[F]_ [[] _[q]_ [(] _[x, y]_ [)]] _[.]_

(112)
Other means for regularization are possible, such as


_−_ 1 _kx_ [2] [+] _[ k]_ _y_ [2]
_D_ ( _x, y_ ) = _I_ ( _x, y, z_ = 0) _[F][ −]_ [1] ( _kx_ [2] + _ky_ [2] ) [2] + _ϵ_ [4] _[F]_ [[] _[q]_ [(] _[x, y]_ [)]] _[.]_

(113)
Note also that Eq. (109) is a finite-difference approximation to the second _z_ derivative of intensity, since



19


Moreover, the replacement in Eq. (73) leads to the
_tensor-diffusion intensity transport equation_ [45]




              - _∂_ 2
_∇⊥_ _·_ [ **D** [�] ( _x, y_ ) _∇⊥I_ ( _x, y, z_ = 0)] =



_._

_z_ =0



_∂_ 2 
_∂z_ [2] _[I]_ [(] _[x, y, z]_ [)]




- _∂_ 2



_≈_

_z_ =0



_∂_ 2 
_∂z_ [2] _[I]_ [(] _[x, y, z]_ [)]



_I_ ( _x,y,_ ∆) _−I_ ( _x,y,_ 0)



(117)
If the right sides of the preceding two equations were
to contain the first rather than the second longitudinal
derivative of intensity, they would be “normal diffusion”
equations. The fact that the second derivative appears
on the right sides is related to the fact that they are
“anomalous diffusion” equations [45] associated with ballistic superdiffusion [44] [see the paragraph in Paper I
that contains Eqs. (10)-(12), for further information].
_Case B:_ If all three lines of Eq. (70) are taken into
account, while restricting consideration to symmetricdefocus scenarios where _F_ ( _x, y_ ) _≪_ 1, the analysis in
Sec. VII A 1 shows that the phase-retrieval algorithm
of Paganin and Nugent—namely Eq. (95) [15]—may be
used to recover the phase _ϕ_ ( _x, y_ ) in the plane _z_ = 0.
Adopting a suggestion made to the authors by Mario
A. Beltran in 2022, we may then use the recovered phase
and infocus intensity to calculate the second and third
lines of Eq. (70). Denoting the calculated form for the
second and third lines of this equation by ∆ [2] Ξ( _x, y_ ),
Eq. (110) has the generalized form


_∇_ [2] _⊥_ [[] _[D]_ [(] _[x, y]_ [)] _[I]_ [(] _[x, y, z]_ [ = 0)] =] _[ q]_ [(] _[x, y]_ [)] _[ −]_ [Ξ(] _[x, y]_ [)] _[.]_ (118)


Since the right side of this equation consists entirely of
known functions, we can make the replacement


_q_ ( _x, y_ ) _−→_ _q_ ( _x, y_ ) _−_ Ξ( _x, y_ ) (119)


in Eqs. (112) or (113), to give the diffusion field _D_ ( _x, y_ ).
For later use, we write Ξ( _x, y_ ) explicitly [cf. Eq. (106)]:



∆ _−I_ ( _x,y,_ 0) _−_ _[I]_ [(] _[x,y,]_ [0)] _[−]_ ∆ _[I]_ [(] _[x,y,][−]_ [∆)]



∆ _._
2∆



(114)
Hence the symmetric-defocus formula for “Case A”
diffusion-field retrieval, in Eq. (111), may be written as



1
Ξ =
4 _k_ [2]



_I_ 0 _e_ _[iϕ]_ [��] �2 _−_ Re - ~~�~~ _I_ 0 _e_ _[−][iϕ]_ ( _∇_ [2] _⊥_ [)][2][�]



_I_ 0 _e_ _[iϕ]_ [��] _._



���� _∇_ 2 _⊥_ 


_∇_ _[−]_ _⊥_ [2] �� _∂z∂_ [2][2] _[I]_ [(] _[x, y, z]_ [)]    _D_ ( _x, y_ ) =







_z_ =0



_._ (115)
_I_ ( _x, y, z_ = 0)



Thus the same focal series of three intensities employed
for “ordinary” TIE phase retrieval in Eq. (95)—namely
an overfocus image _I_ ( _x, y, z_ = ∆), an underfocus image
_I_ ( _x, y, z_ = _−_ ∆), and an infocus image _I_ ( _x, y, z_ = 0)—
may also be employed for diffusion-field retrieval using
Eq. (115). _The infocus intensity and intensity derivative_
_give the key information needed for phase retrieval; the_
_infocus intensity and_ second _intensity derivative give the_
_key information needed for diffusion-field retrieval_ . Regarding the latter point, Eq. (115) implies the second intensity derivative (with respect to defocus) to be a source
term for the _scalar-diffusion intensity transport equation_




            - _∂_ 2
_∇_ [2] _⊥_ [[] _[D]_ [(] _[x, y]_ [)] _[I]_ [(] _[x, y, z]_ [ = 0)] =]



_._ (116)

_z_ =0



_∂_ 2 
_∂z_ [2] _[I]_ [(] _[x, y, z]_ [)]



(120)
Above, we use the compressed notation Ξ _≡_ Ξ( _x, y_ ) _, I_ 0 _≡_
_I_ ( _x, y, z_ = 0), and _ϕ ≡_ _ϕ_ ( _x, y, z_ = 0) [cf. Eq. (98)].


_2._ _Diffusion-field retrieval: Asymmetric-defocus case_


We again restrict consideration to paraxial diffusionfield retrieval when _F_ ( _x, y_ ) _≪_ 1. Three intensity images


45 We emphasize that Eqs. (116) and (117) are approximations
which are valid to the extent that one can indeed retain only
the first line of Eq. (70) (“Case A”). This simplification is likely
to become an oversimplification in the vicinity of sharp sample edges. Comparison with the edge-induced diffusion fields, as
developed in Secs. VIII B 1 and VIII B 2 below, leads to the conjecture that Eqs. (116) and (117) might have a broader domain of

validity if the diffusion fields _D_ ( _x, y_ ) and **D** ( _x, y_ ) are augmented

[�]
by diffusion fields that are induced by sharp-edge scatter.


at different defoci are assumed to have been measured. If
we suitably choose the origin of optical-axis coordinates
_z_, one of these images will correspond to the plane _z_ = 0;
let the other defocus planes be denoted by _z_ = ∆1 and
_z_ = ∆2. Using the method outlined in Sec. VII A 2, the
phase _ϕ_ ( _x, y_ ) may be obtained in the plane _z_ = 0. From
this point onward, we then distinguish between Cases A
and B that were defined in the previous subsection.
_Case A:_ If only the first line of Eq. (70) is retained,
and _F_ ( _x, y_ ) is approximated by zero, then for any one of
the nonzero defocus distances (e.g., ∆1), one obtains a
Poisson equation of the same form as Eq. (110), with the
data function _q_ ( _x, y_ ) now being obtained via the knownfunction replacement


_q_ ( _x, y_ ) _−→_ _[I]_ [1] _[ −]_ _[I]_ [0][ + ∆][1] _[k][−]_ [1] _[∇·]_ [ (] _[I]_ [0] _[∇][⊥][ϕ]_ [)] _._ (121)

∆ [2] 1


Above, we use the previously-defined compressed notation, together with _I_ 1 _≡_ _I_ ( _x, y, z_ = ∆1). With this replacement, _D_ ( _x, y_ ) is obtained via Eqs. (112) or (113).
_Case B:_ If all three lines of Eq. (70) are taken into account, Ξ may be constructed using the measured intensity _I_ 0 and retrieved phase _ϕ_ [see Eq. (120)]. Equation
(70) again yields the Poisson-type form in Eq. (110), with
the data function now given by


_q_ ( _x, y_ ) _−→_ _[I]_ [1] _[ −]_ _[I]_ [0][ + ∆][1] _[k][−]_ [1] _[∇·]_ [ (] _[I]_ [0] _[∇][⊥][ϕ]_ [)] _−_ Ξ _._ (122)

∆ [2] 1


Equations (112) or (113) then retrieve _D_ ( _x, y_ ).


_3._ _Diffusion-field retrieval: Structured-illumination case_


In the next four paragraphs, respectively, we study
structured-illumination diffusion-field retrieval for (i)
Case A scalar diffusion fields, (ii) Case B scalar diffusion fields, (iii) Case A tensor diffusion fields, and (iv)
Case B tensor diffusion fields. We use the same notation
that was previously employed in Sec. VII A 3.
_Scalar diffusion field, Case A:_ Write down Eq. (105)
and delete Ξ (as previously mentioned, this is the fundamental assumption which distinguishes Case A from Case
B). Assume that _I_ ∆ [(] _[s]_ [+] _[m]_ [)], _I_ ∆=0 [(] _[s]_ [+] _[m]_ [)] _≡_ _TM_, and _ϕ_ + _ϕm_ have
been either directly measured or retrieved; the nonzero
defocus distance ∆and wavenumber _k_ are also taken to
be known. Algebraically rearrange the resulting equation
to give


_∇_ [2] _⊥_ [(] _[DTM]_ [) = ˘] _[Q]_ (123)


where the known data function is

_Q_ ˘ = _[I]_ ∆ [(] _[s]_ [+] _[m]_ [)] _−_ _TM_ + [1]
∆ [2] _k_ ∆ _[∇][⊥]_ _[·]_ [ [] _[MT]_ _[∇][⊥]_ [(] _[ϕ]_ [ +] _[ ϕ][m]_ [)]] _[.]_ [ (124)]


Hence the required scalar diffusion field is


_D_ = ( _TM_ ) _[−]_ [1] _∇_ _[−]_ _⊥_ [2] _[Q.]_ [˘] (125)



20


_Scalar diffusion field, Case B:_ Write down Eq. (105).
Again assume that _I_ ∆ [(] _[s]_ [+] _[m]_ [)], _TM_, and _ϕ_ + _ϕm_ have been
either directly measured or retrieved; ∆and _k_ are also
given. Then construct Ξ [(] _[s]_ [+] _[m]_ [)] using Eq. (106). Algebraically rearrange the resulting equation to give


_∇_ [2] _⊥_ [(] _[DTM]_ [) = ˘] _[Q][ −]_ [Ξ][(] _[s]_ [+] _[m]_ [)] _[,]_ (126)


hence Eq. (125) generalizes to


_D_ = ( _TM_ ) _[−]_ [1] _∇_ _[−]_ _⊥_ [2][[ ˘] _[Q][ −]_ [Ξ][(] _[s]_ [+] _[m]_ [)][]] _[.]_ (127)


_Tensor diffusion field, Case A:_ Approximate Ξ [(] _j_ _[s]_ [+] _[m]_ [)] by
zero, in the approach that is given in the next paragraph.
_Tensor diffusion field, Case B:_ By using a tensor diffusion field **D** ( _x, y_ ) [see Eqs. (37), (73), and (74)] rather

[�]
than a scalar diffusion field _D_ ( _x, y_ ), Eq. (105) generalizes
to the following extension of Eq. (125) in Paper I:


_Ij,_ [(] _[s]_ ∆ [+] _[m]_ [)] = _TMj_ + ∆ [2] _∇⊥_ _·_ [ **D** [�] _∇⊥_ ( _TMj_ )] (128)

_−_ [∆] _k_ _[∇][⊥]_ _[·]_ [ [] _[M][j][T]_ _[∇][⊥]_ [(] _[ϕ]_ [ +] _[ ϕ][j,m]_ [)] + ∆][2][Ξ] _j_ [(] _[s]_ [+] _[m]_ [)] _._


Above, the subscript _j_ = 1 _,_ 2 _, · · ·, j_ max indicates a number of different masks (or transverse mask positions);
similar notation was used for Eq. (126) in Paper I. The
phase shift due to the _j_ th mask, namely _ϕj,m_, can be
determined using the same method that was given in
Sec. VII A 3; this is because the method of that section
algebraically eliminates the diffusion-field term, irrespective of whether the diffusion has a scalar or tensor character. [46] Also, as was the case on several previous occasions, Eq. (106) can be used to calculate Ξ [(] _j_ _[s]_ [+] _[m]_ [)], via
quantities that have either been directly measured or retrieved. Thus, the only unknown quantity in Eq. (128)
is the tensor diffusion field **D** that appears after the first

[�]
divergence symbol. Introduce the known data function


_Ij,_ [(] _[s]_ ∆ [+] _[m]_ [)] _−_ _TMj_
Q _j,_ ∆ = (129)
∆ [2]

+ _k_ [1] ∆ _[∇][⊥]_ _[·]_ [ [] _[M][j][T]_ _[∇][⊥]_ [(] _[ϕ]_ [ +] _[ ϕ][j,m]_ [)]] _[ −]_ [Ξ] _j_ [(] _[s]_ [+] _[m]_ [)]


which corresponds to the _j_ th mask and defocus ∆. Hence


_∇⊥_ _·_ [ **D** [�] _∇⊥_ ( _TMj_ )] = Q _j,_ ∆ _._ (130)


Now use Eq. (108) from Paper I to write the symmetric
diffusion tensor as a 2 _×_ 2 matrix, represent _∇⊥_ ( _TMj_ )
as a two-component column vector, then introduce the
abbreviations _∂x ≡_ _∂/∂x_ and _∂y ≡_ _∂/∂y_ . Hence



_∇⊥_ _·_ ��� _Dxx_ _D_ - _xy_
_D_   - _xy_ _D_   - _yy_



�� _∂∂xy_ (( _TMTMjj_ ))�� = Q _j,_ ∆ _._ (131)



46 Alternatively, for each mask position _j_, the sample-plus-mask
phase shift _ϕ_ + _ϕj,m_ can be retrieved via the method in
Sec. VII A 2.


Expanding the left side then gives a linear combination
(with known position-dependent coefficients that will not
be written here) of the same seven unknown functions
that are contained within square brackets in Eq. (126)
from Paper I. The same method, employed in Sec. IV B
of Paper I, may then be used to construct the diffusion
tensor, using at least seven independent data functions
Q _j,_ ∆. These independent data functions may be obtained
by varying either or both of the mask position _j_ and the
defocus ∆.


**VIII.** **SOME PARAXIAL DIFFUSION-FIELD**
**MODELS**


Several physical models for paraxial scalar and tensor diffusion fields, all of which are of primary relevance
to this paper, were given in Paper I. Here we augment
this list with a model for _noise-induced contributions to_
_diffusion fields_, namely an effective position-dependent
blur associated with shot noise in photon-limited intensity detection scenarios (Sec. VIII A). [47] We then consider
two distinct classes of model by which _negative diffusion_
_fields_ may be obtained, namely diffusion fields that locally sharpen an intensity distribution rather than locally
blurring it (Sec. VIII B).


**A.** **Noise-induced contribution to diffusion field**


Paper I gave several models for the contribution
to a paraxial diffusion field that arises from positiondependent blur due to diffuse scatter from spatially random microstructure in a sample. Here we study a physically distinct contribution due to photon shot noise. The
analysis, which complements Sec. V E of Paper I, has
three parts. Section VIII A 1 develops a simple form of
noise-resolution tradeoff. This is used, in Sec. VIII A 2, to
obtain a noise-induced contribution to the Fokker-Planck
diffusion field. Finally, Sec. VIII A 3 develops a variant
of these ideas that is applicable to the case of randomly
structured illumination (cf. Fig. 5 in Paper I, for the special case where a spatially random mask _M_ is employed).


_1._ _Noise-resolution tradeoff_


Consider the detector-surface region in Fig. 4. By assumption the rectangular region _A_ is not illuminated,
while the rectangular region _B_ is uniformly illuminated
with a photon fluence _f_ (stated more precisely, the mean


47 As explained in Sec. V E of Paper I, noise-induced blur can be
thought of as the “washing out of high-frequency detail by highfrequency noise”. Resolution estimation via Fourier ring correlation [109] leads to the same conclusion. Cf. the final paragraph
of Sec. VIII A 3.



21


number of detected photons per unit area is _f_, assuming
perfect detector efficiency). [48] Now imagine a fictitious
square-pixel grid to be imposed over the illuminated region, as shown in green. By definition, let _ℓ_ noise be the
width of the smallest “fictitious pixel” that can resolve
the “shadow edge” indicated by the dashed line in Fig. 4.
A rough estimate for _ℓ_ noise corresponds to a mean of one
photon per pixel, hence _fℓ_ [2] noise [= 1.] If we now consider the more general case where fluence is a function
of detector-plane Cartesian coordinates ( _x, y_ ), _ℓ_ noise will
also become position dependent. Thus [110, 111]


1
_ℓ_ noise( _x, y_ ) = ~~�~~ _f_ ( _x, y_ ) (132)


is a position-dependent lower bound on the spatial resolution associated with a given fluence _f_ ( _x, y_ ). This result is an example of the well-known tradeoff between
noise and spatial resolution, namely the fact that for
fixed fluence, improvement in per-pixel signal-to-noise ratio implies coarsened spatial resolution [110–116]. From
a dimensional-analysis perspective [117, 118], Eq. (132) is
the only length scale that can be formed from the fluence
alone. Moreover, Eq. (132) bears some conceptual similarity to the position-momentum uncertainty principle

[73], since _ℓ_ noise is a lower-bound measure of positional
uncertainty and _[√]_ _f_ is proportional to the uncertainty in
transverse momentum associated with “salt and pepper”
shot noise [65]. In particular, for two contiguous square
detector areas that correspond to the same fluence _f_ [see,
e.g., two neighboring green boxes in region _B_ of Fig. 4],
Poisson statistics implies the detected number of photons
in the contiguous areas to differ by a zero-mean random
number that is proportional to _[√]_ _f_ ; this difference may be
conceptualized in terms of a fluctuating transverse momentum, or in terms of a spatially random phase distribution associated with unresolved spatiotemporal speckle.


FIG. 4. Geometry for derivation of noise-resolution tradeoff.


48 This definition for _f_ follows p. 652 of Barrett and Myers [65].


_2._ _Noise-induced Fokker-Planck diffusion field_


We now seek an expression for the Fokker-Planck
paraxial diffusion field induced by Eq. (132). While it
is somewhat artificial to do so, the noise-induced blur
width _ℓ_ noise may be associated with the half-angle _θ_ noise
given by truncating Eq. (142) in Paper I to




     - _ℓ_ noise
_θ_ noise = tan _[−]_ [1]

∆




_≈_ _[ℓ]_ [noise] _,_ (133)

∆



22


The more attenuating the sample, the stronger the diffusion field induced by shot noise. Lower incident fluence
_f_ 0 also increases the strength of this diffusion field.


_3._ _Noise-induced visibility-reduction field_


In the context of random-illumination (speckle tracking [96, 97]) approaches to paraxial diffusion-field retrieval [100, 102], such as that sketched in Fig. 5(a), [49]

let an illuminating speckle be roughly approximated as
“one bump” of a sinusoid. [50] Note that the argument
that follows can be applied to other methods of phase
and dark-field imaging, for example, simply replacing the
speckle by a beamlet used in single-grid imaging, edge illumination, or grating interferometry [4, 119]. Working
in one transverse spatial dimension _x_, the intensity of the
illuminating speckle may therefore be written as [4]


_I_ in( _x_ ) = _a_ sin( _x/p_ ) + _b,_ (140)


where _a >_ 0 is the speckle-intensity amplitude, _b ≥_ _a_
is an additive offset, and _p_ is a measure of the speckle
width. The Michelson visibility [120] of the illuminating
speckle is obtained from the maximum intensity _I_ max and
the minimum intensity _I_ min via



where ∆is the sample-to-detector distance. Then take
Eq. (20), replace _θs_ with _θ_ noise, set _F_ to unity, and use
Eq. (133). Now employ Eq. (132) and then discard a factor of one half on account of the crudeness of the present
analysis, to give the following expression for the noiseinduced contribution to the Fokker-Planck diffusion field:


1
_D_ noise( _x, y_ ) = (134)
∆ [2] _f_ ( _x, y_ ) _[.]_


This is the simplest dimensionless function that can be
created using the only available quantities (namely _f_ and
∆), which is such that the noise-induced diffusion field is
a decreasing function of increasing fluence.
Having obtained an expression for the noise-induced
diffusion field, we now examine conditions under which
it is ignorable. Since the angle subtended by one physical
(rather than fictitious) pixel with respect to a point on an
imaged sample is paraxially equal to the width _W_ of that
pixel divided by the sample-to-detector distance (defocus
distance) ∆, the condition for a negligible contribution
due to the noise-induced diffusion field is

_θ_ noise( _x, y_ ) _≪_ _[W]_ (135)

∆ _[.]_


Using Eq. (133) reduces this to the natural requirement


_ℓ_ noise( _x, y_ ) _≪W._ (136)


Now use Eq. (132), hence


_W_ [2] _f_ ( _x, y_ ) _≫_ 1 _._ (137)


Since the left side is equal to the mean number of photons per pixel, we conclude that _the noise-induced contri-_
_bution to a paraxial diffusion field is negligible when the_
_mean number of photons per pixel is much greater than_
_unity_ . Conversely, in weak-field (low sample-dose) situations where the mean number of photons per pixel is on
the order of (say) 10 or less, the noise-induced contribution to the diffusion field should be taken into account.
In the common situation where a sample with intensity
transmission function _T_ ( _x, y_ ) is uniformly illuminated at
normal incidence with spatially uniform fluence _f_ 0, we
may write


_f_ ( _x, y_ ) _≈_ _f_ 0 _T_ ( _x, y_ ) _,_ 0 _< T_ ( _x, y_ ) _≤_ 1 _,_ (138)


hence Eq. (134) becomes


1
_D_ noise( _x, y_ ) = (139)
∆ [2] _f_ 0 _T_ ( _x, y_ ) _[.]_



_V_ in = _[I]_ [max] _[ −]_ _[I]_ [min]




[(] _[a]_ [ +] _[ b]_ [)] _[ −]_ [(] _[b][ −]_ _[a]_ [)] _[a]_

( _a_ + _b_ ) + ( _b −_ _a_ ) [=] _b_



_b_ _[≤]_ [1] _[.]_ [ (141)]




_[I]_ [max] _[ −]_ _[I]_ [min] = [(] _[a]_ [ +] _[ b]_ [)] _[ −]_ [(] _[b][ −]_ _[a]_ [)]

_I_ max + _I_ min ( _a_ + _b_ ) + ( _b −_ _a_



The noise-induced smearing of this speckle, over a transverse length scale of _ℓ_ noise, may be modeled via the intensity distribution


_I_ out( _x_ ) = [ _a_ sin( _x/p_ )+ _b_ ] _⊗G_ ( _µ_ = 0 _, σ_ = _ℓ_ noise _, x_ ) _,_ (142)


where _⊗_ denotes convolution and _G_ ( _µ, σ, x_ ) is a unitarea Gaussian function of _x_ with mean _µ_ and standard
deviation _σ_ . Evaluate the convolution integral to give




     _I_ out( _x_ ) = _a_ exp _−_ [[] _[ℓ]_ [noise][(] _[x]_ [)]][2]

2 _p_ [2]




- - _x_
sin

_p_




+ _b,_ (143)



49 The basic idea underpinning speckle tracking is as follows. A
uniformly illuminated random mask creates speckles over a detector plane, which are (i) attenuated in accord with the absorption profile _T_ ( _x, y_ ) of the sample, (ii) transversely displaced via
the refractive properties _ϕ_ ( _x, y_ ) of the sample, and blurred by

the presence of a diffusion field _D_ ( _x, y_ ) [or **D** ( _x, y_ )] induced by

[�]
unresolved microstructure in the sample. Speckle tracking seeks
to recover _T_ ( _x, y_ ) from the sample-induced attenuation of the
mask speckles, in addition to recovering _ϕ_ ( _x, y_ ) from the sampleinduced displacement of the speckles, and the diffusion field (or
visibility-reduction field) from the position-dependent blur of the
speckles. The book by Zdora [102] reviews several methods.
50 While the intensity distribution of the illuminating random
speckles—namely the intensity distribution immediately downstream of the random mask in Fig. 5(a)—is not periodic, each
individual speckle is here being modeled as having an intensity
distribution that is locally sinusoidal.


with the speckle visibility now being reduced to




     _V_ out( _x_ ) = exp _−_ [[] _[ℓ]_ [noise][(] _[x]_ [)]][2]

2 _p_ [2]




- _a_

(144)
_b_ _[.]_



Note that the speckle width _p_ is independent of _x_, by
assumption; this corresponds to the random mask in
Fig. 5(a) being statistically spatially stationary. Take
the ratio of Eqs. (144) and (141), revert to two spatial
dimensions, then use Eq. (132). Hence [51]



_V_ out( _x, y_ ) - _−_ [[] _[ℓ]_ [noise][(] _[x, y]_ [)]][2]

_V_ in( _x, y_ ) [= exp] 2 _p_ [2]



_V_ out( _x, y_ )







2 _p_ [2]




  - 1   = exp _−_ _._ (145)
2 _p_ [2] _f_ ( _x, y_ )



Now assume uniform-fluence illumination of a sample
with transmission function _T_ ( _x, y_ ), hence Eq. (138) gives



_V_ out( _x, y_ ) - _−_ 1 - _._ (146)

_V_ in( _x, y_ ) [= exp] 2 _p_ [2] _f_ 0 _T_ ( _x, y_ )



Approximate the area _A_ of one random-illumination
speckle as _p_ [2], then discard a factor of two on account
of the crudeness of our calculation, thus



_V_ out( _x, y_ ) - _−_ 1

_V_ in( _x, y_ ) [= exp] _Af_ 0 _T_ ( _x, y_ )




_._ (147)



23


FIG. 5. (a) Basic scenario for “speckle tracking” approach to
structured-illumination imaging [96, 97, 100, 102]. (b) Plot of
the noise-induced relative reduction _V_ out _/V_ in in the visibility
of a random-mask speckle, according to Eq. (149), where N is
the number of photons that pass through both the particular
speckle and the sample. The inset zooms into the region in
the vicinity of the essential singularity at N = 0 (see, e.g.,
p. 380 of Morse and Feshbach [75]).


From Eq. (149), which is plotted in Fig. 5(b), we conclude that the noise-induced visibility reduction of an
illuminating speckle is only non-negligible when at most
a handful of photons N is transmitted through both that
particular speckle and the sample that is being imaged.
For example, a noise-induced blur that alters speckle visibility by 1% or more implies the left side of Eq. (149) to
be no greater than 0.99. In this case, _nt_ ≲ 100, implying
no more than 100 photons to be transmitted through any
one random-mask speckle. If N ≳ 5, as will typically be
the case if the illumination is not too weak or the randommask speckles are not too absorbing, then we may make
the Taylor-series approximation exp( _−_ 1 _/_ N) _≈_ 1 _−_ (1 _/_ N).
This leads to the simple rule-of-thumb



Now let


_n_ = _Af_ 0 (148)


be the number of photons that illuminate each randommask speckle, during the exposure time needed to record
the intensity image. Hence



_V_ out( _x, y_ ) - _−_ 1

_V_ in( _x, y_ ) [= exp] _n T_ ( _x, y_ )




- - _−_ 1 = exp _,_ (149)
N( _x, y_ )



where the dimensionless quantity


N _≡_ _nT_ (150)


is the total number of photons transmitted through both
a given speckle and the sample. For example, as shown in
Fig. 5(a), if _f_ 0 photons per unit area illuminate a randommask speckle with area _A_, on the order of _n_ = _Af_ 0 photons will impinge on the corresponding area of the sample; upon subsequently passing through a region of the
sample with local intensity transmission coefficient _T_, a
total of _nT ≡_ N photons will strike the detector. This
value for N is unchanged if the mask-sample sequence is
reversed.


51 Cf. Eq. (132) in Paper I, whose functional form is consistent with
the expression obtained by eliminating _f_ ( _x, y_ ) from Eqs. (134)
and (145) in the present paper.



for the relative percentage reduction in mask-speckle visibility that is induced by photon shot noise, where


∆ _V ≡V_ in _−V_ out (152)


is the absolute change in mask-speckle visibility.
We close this subsection with a point of clarification. The idea that noise leads to local blurring, as explained in footnote 47, is consistent with the concept of
a noise-induced visibility- _reduction_ field. However, methods for measuring visibility from an experimental image



∆ _V_



if N ≳ 5 (151)
N



∆ _V_

_×_ 100% _≈_ [100]
_V_ in N


can change how noise influences the outcome. For example, if one takes the absolute maximum and minimum
pixel values in a local region then noise will induce a local
_increase_ in visibility; conversely, if one were to fit a sinusoid (or some other smooth function such as a Gaussian)
to the intensity in the local region then noise will induce
a local _decrease_ in visibility. Our analysis is consistent
with the latter approach, but distinct from the former.


**B.** **Negative diffusion-field models**


For the visibility-reduction structured-illumination approach to diffusive dark-field imaging, in the sense explained in Secs. III D and V B of Paper I, several articles have reported the measurement of paraxial diffusion
fields whose origin is due at least in part to scattering
from sharp edges [105, 121–124] (cf. Refs. [125, 126]).
Similar remarks apply to edge-scatter contributions for
both the scalar [25, 26, 56] and tensor [40] Fokker-Planck
diffusion fields. The visibility-reduction and FokkerPlanck viewpoints, respectively associated with the previous two sentences, may be related to one another
through Eq. (132) of Paper I. For a recent direct experimental example, of the local visibility reduction of
structured-illumination intensity due to edge scatter, see
the borders of the dielectric spheres in Fig. 2(b) of Groenendijk _et al._ [127]. As explained by Yashiro and Momose

[124], the physical origin—of such edge-scatter local visibility reduction—is different from the contribution due
to diffuse scatter from spatially unresolved sample microstructure. Indeed, this edge scatter may be variously
conceptualized as due to (i) Young boundary waves in
scalar-wave diffraction theory [128–134], (ii) edge scatter
associated with critical points of the second kind in the
asymptotic expansion of the Fresnel diffraction integral in
the presence of sharp absorptive edges [52], or (iii) Keller
diffracted rays associated with the geometrical theory of
diffraction [135].
The idea of a _negative diffusion coefficient associated_
_with scattering from sharp sample edges in the context of_
_coherent imaging_ has several precedents in the literature
(see, e.g., Refs. [26, 136–138]). Following Croughan _et al._

[137], local _sharpening of visibility due to diffuse scat-_
_ter_ may be modeled as a diffuse-scatter cone with complex apex angle. In cases where the cone-angle _θs_ ( _x, y_ )
is purely imaginary, the expression for the dimensionless diffusion field in Eq. (20) becomes negative. In
this context, the following terms may be taken as synonymous: “locally negative diffusion field”, “local deblur (negative blur)”, “local deconvolution”, and “local
diffusion-induced sharpening ”. Regarding this final term
in particular, which might superficially appear to contain
a logical contradiction, we refer to the argument centered
about Fig. 4 in Ref. [4]. There, it is shown that when a
diffusion-field is spatially rapidly varying—for example,
in the vicinity of a sharp sample edge—it can lead to local
sharpening rather than local smearing (see also Supple


24


mentary Sec. 1 of Ahlers _et al._ [58]).
Additional context provided by previous work on negative diffusion in a Fokker-Planck setting [139, 140] encourages exploration of the possibility of negative diffusion fields associated with Fokker-Planck extensions to
the TIE. Below we consider scalar (Sec. VIII B 1) and
then tensor (Sec. VIII B 2) negative diffusion fields associated with scattering from sharp sample edges, followed
by an outline of how out-of-focus contrast may also lead
to a negative diffusion field (Sec. VIII B 3). In the context
of the presented models, note that it can be challenging
to achieve quantitative agreement between experimental
data and models of the signal observed at a sample edge.
This is due to the multiple possible contributions to the
edge signal, the concentration of contrast into only a few
pixels, and the potential diffusion of that very local contrast due to source size or detector blurring.


_1._ _Negative diffusion field induced by edge scatter: Scalar_
_case_


The dimensionless scalar diffusion field _D_ ( _x, y_ ) _≥_ 0
in Eq. (24) of Paper I, resulting from both unresolved
sample microstructure and source-size blur, may be augmented by a negative diffusion field associated with scattering from sharp edges. Hence we make the replacement


_D_ ( _x, y_ ) _−→_ _D_ ( _x, y_ ) _−_ _D_ edge( _x, y_ ; ∆ _, · · ·_ ) _,_ (153)


where _D_ edge( _x, y_ ; ∆) _≥_ 0, ∆is the defocus, and the ellipsis indicates additional relevant parameters. In particular, the functional form of the negative diffusion field
will in general depend upon the sharpness of the transverse intensity gradients, and therefore upon the appropriate model for the associated edges. If more than one
edge model is needed in a particular context, then more
than one negative-diffusion field may be required. For
example, if two diffusion fields are needed to model two
different classes of sharp edge, then we may write



_D_ ( _x, y_ ) _−→_ _D_ ( _x, y_ ) _−_



2

- _D_ edge [(] _[j]_ [)] [(] _[x, y]_ [; ∆] _[,][ · · ·]_ [ )] _[,]_ (154)

_j_ =1



where _D_ ( _x, y_ ) _≥_ 0 and _D_ edge [(] _[j]_ [)] [(] _[x, y]_ [; ∆] _[,][ · · ·]_ [ )] _[ ≥]_ [0.]
A simple negative-diffusion model recalls the theory
of Fresnel diffraction of normally incident plane waves
with wavelength _λ_, from a perfectly sharp straight edge
of an opaque screen: see Fig. 6. The width of the Fresnel diffraction peak, in the _√_ vicinity of the sharp edge, is
on the order of the width _λ_ ∆of the first Fresnel zone

[141]. [52] The associated angular width for the fan of edgescatter radiation is - _λ/_ ∆. Now set _F_ to roughly unity


52 Importantly, this corresponds to normal rather than anomalous
diffusion, in the sense explained in Sec. II of Paper I. As shall
be seen in a moment, this is related to the introduction of the ∆
dependence of _D_ edge( _x, y_ ; ∆ _, · · ·_ ) in Eq. (153).


FIG. 6. Fresnel diffraction of normally-incident monochromatic plane waves _A_ by a thin opaque screen _B_ (side view).
The edge _C_ of the screen ~~_√_~~ gives a scattered wave _D_ whose
width is on the order of _λ_ ∆, upon propagating a distance

_z_ = ∆ _≥_ 0 downstream of _C_ . ~~_√_~~ The corresponding angular
width of _D_ is _ϑ ≈_ ~~�~~ _λ/_ ∆. If _λ_ ∆is small relative to the

width of the field of view of the “defocused” intensity distribution over the plane _z_ = ∆, the narrow primary Fresnel
diffraction fringe may be viewed as locally sharpening the image of the screen’s edge.


in Eq. (20), on account of the fact that, for small ∆, edge
scatter dominates the defocused intensity in the vicinity
of the sharp scattering edge. This gives the rough estimate [53]



25


∆that are sufficiently small), with the corresponding
_√_
transverse length scale corresponding to the width _λ_ ∆

of the first Fresnel zone. For similar reasons, the transverse thicknes _√_ s of the indicator function will also be on
the order of _λ_ ∆(cf. the notion of a Fresnel volume, on

p. 14 of Kravtsov and Orlov [142]). Also, via a slight
extension in the preceding chain of logic—for example
in the presence of sharp transverse phase gradients, or
sharp transverse intensity gradients where the intensity
rapidly changes from one nonzero value to a different
nonzero value— _I_ 1( _x, y_ ) may be viewed as a dimensionless sharp-edge negative-diffusion field whose magnitude
varies between zero and a number on the order of unity.
A different class of negative-diffusion field may be considered, by returning to the second and third lines of
the extended Fokker-Planck equation [Eq. (70)]. Let
_ℓ_ edge _≫_ _λ_ be the width over which a soft absorptive edge
has its associated intensity transmission function vary
from its minimum to its maximum value. Dimensional
analysis then gives the associated soft-edge negativediffusion field




      - _λ_
_D_ edge [(2)] [(] _[x, y]_ [;] _[ ℓ]_ [edge][)] _[ ≈]_
_ℓ_ edge



�2
_I_ 2( _x, y_ ) _,_ (156)



_λ_

∆



_D_ edge [(1)] [(] _[x, y]_ [; ∆)] _[ ≈]_ [1]

2 _[×]_ [ 1] _[ ×]_



��



�2



_I_ 1( _x, y_ )



= _[λ]_ (155)

∆ _[I]_ [1][(] _[x, y]_ [)] _[,]_



where _I_ 2( _x, y_ ) is a dimensionless soft-edge negativediffusion indicator function that is not necessarily on the
order of unity [unlike _D_ edge [(1)] [(] _[x, y]_ [; ∆), which is typically on]
the order of unity in regions where it is not negligible]. [54]

When the sharp-edge and soft-edge negative-diffusion
fields of the preceding two paragraphs are employed for
the replacement in Eq. (154), additional edge-related
terms are generated in the Fokker-Planck and extended
Fokker-Planck generalizations of the TIE. Restricting
ourselves to one example, the _F ≪_ 1 special case of
Eq. (21) leads to


_I_ ( _x, y,z_ = ∆) = _I_ ( _x, y, z_ = 0)

_−_ _[λ]_ [∆]

2 _π_ _[∇][⊥]_ _[·]_ [ [] _[I]_ [(] _[x, y, z]_ [ = 0)] _[∇][⊥][ϕ]_ [(] _[x, y]_ [)]]

+ ∆ [2] _∇_ [2] _⊥_ [[] _[D]_ [(] _[x, y]_ [)] _[I]_ [(] _[x, y, z]_ [ = 0)]] (157)

_−_ _λ_ ∆ _∇_ [2] _⊥_ [[] _[I]_ [1][(] _[x, y]_ [)] _[I]_ [(] _[x, y, z]_ [ = 0)]]



where _I_ 1( _x, y_ ) _≥_ 0 is a dimensionless indicator function that is (i) defined to be on the order of unity in
the vicinity of sharp edges where the infocus intensity
_I_ ( _x, y, z_ = 0) changes abruptly from zero to unity, and
(ii) equal to zero elsewhere; also, a factor of one half
has been discarded in the final line, by absorbing it into
the indicator function. Note that this unusual means of
framing small-distance Fresnel diffraction, in terms of a
negative diffusion coefficient, may be justified by the fact
that boundary-wave scatter sharpens rather than blurs
the intensity distribution of the edge (in the immediate
transverse vicinity of that edge, for propagation distances


53 Since we here model edges as perfectly sharp, there is no
length scale associated with the width of such edges. From a
dimensional-analysis perspective [117, 118], the only available
nondimensionless parameters are _λ_ and ∆; since both have units
of length, and the left side of Eq. (155) is dimensionless, only the
ratio _λ/_ ∆(or some power ( _λ/_ ∆) _[p]_ or function _q_ ( _λ/_ ∆) thereof)
may appear on the right side of this equation. Also, since _λ_
must explicitly influence this expression since its physical underpinnings pertain to diffraction, _p_ cannot be zero and _q_ cannot be
constant. Hence ∆must appear on the right side of our equation, which is why functional ∆dependence was included on the
left side. From a physical perspective, and for the particular
negative-diffusion model considered here, the ∆dependence on
the right side of Eq. (155) relates to the transition from ballistic superdiffusion to normal diffusion (see Sec. II of Paper I);
cf. footnote 54.



The preceding rough calculations are broadly consistent with the Fokker-Planck analysis in Beltran _et al._

[24], where the discarding of negative components of a
recovered paraxial diffusion field was seen to suppress
contributions due to edge scatter and thereby emphasize
the contribution due to unresolved sample microstructure. Such clipping of a recovered paraxial diffusion field


54 The lack of ∆dependence in Eq. (156) is consistent with ballistic
superdiffusion (Paper I, Sec. II). Cf. the end of footnote 53.




 - _λ_ ∆

_−_

_ℓ_ edge



�2
_∇_ [2] _⊥_ [[] _[I]_ [2][(] _[x, y]_ [)] _[I]_ [(] _[x, y, z]_ [ = 0)]] _[.]_


to its nonnegative component, in order to separate bulkmicrostructure scatter from edge scatter, has also been
clearly observed in separate investigations by Croughan
_et al._ [137] and Alloo _et al._ [26]. More generally, the final
two terms on the right side of Eq. (157) can be viewed
as modeling “left over” contrast that is not adequately
modeled by the first three terms on the right side. Under
this view, the indicator functions _I_ 1( _x, y_ ) and _I_ 2( _x, y_ )
are generic corrections, of order ∆and ∆ [2] respectively,
associated with the failure of the other terms [on the
right side of Eq. (157)] to model _I_ ( _x, y, z_ = ∆) in an
accurate manner. Such indicator functions are of particular relevance to sharp sample edges since it is difficult
to correctly model a very high contrast fringe that is
sampled over only a few pixels and with some detector
point spread function. Note that the nature of these correction terms will in general differ depending on whether
one uses a forward-evolution Fokker-Planck approach (as
employed in the present paper) or a reverse-evolution approach (see Beltran _et al._ [24] and Alloo _et al._ [26]).
We close this section by pointing out that a more
systematic means for obtaining a series of negativediffusion terms associated with edge-induced scatter—
each of which depend on a different power of ∆—is to
consider the role of critical points of the second kind in
the asymptotic expansion of double integrals for Fresnel
diffraction (see, e.g., Sec. 3.3.3 of Mandel and Wolf [52]).


_2._ _Negative diffusion field induced by edge scatter: Tensor_
_case_


In structured-illumination experiments that recover
the Fokker-Planck diffusion tensor [40], it is evident that
the principal axis of the corresponding diffusion ellipse
(see Fig. 9 in Paper I) has an inclination angle _ψ_ ( _x, y_ )
that makes its long axis perpendicular to sharp sample
edges. [55] This phenomenon is evident in the experimental reconstruction from Fig. 3(c) of Pavlov _et al._ [40]; see,
also, the very closely related earlier examples in Fig. 2(d)
of Jensen _et al._ [54] and Fig. 4(f) of Jensen _et al._ [55].
To help develop a preliminary model for diffusion-field
ellipses induced by sharp-edge scatter, consider Fig. 7.
Here, a solid sample with a smooth surface is shown projected onto the ( _x, y_ ) plane which is transverse to the
optical axis of _z_ -directed illumination (not shown). The
shaded region Ωdenotes the interior of the _z_ -projected
sample, with smooth boundary _∂_ Ω. Diffusion-field ellipses are shown in blue, for three locations _A_, _B_, and _C_
on _∂_ Ω; the size of these ellipses is exaggerated for clarity,
since they are in fact constrained to lie within the region
Ωedge shaded in green, which by definition corresponds
to the set of points where the diffusion field associated
with sharp-edge scatter is non-negligible.


55 Recall footnote 13, regarding our dual use of the symbol _ψ_ .



26


FIG. 7. Diffusion-field ellipses associated with edge scatter.


It is beyond the scope of this paper to derive particular
models for edge-scatter diffusion tensor fields, e.g., using
the geometrical theory of diffraction [135] or the method
of stationary phase for two-dimensional diffraction integrals [52]. In lieu of such a formal development, take
Eq. (74), make the approximation _θ_ 1( _x, y_ ) _≈_ - _λ/_ ∆(see

Fig. 6 from this paper and Fig. 9 from Paper I) and then
ignore the influence of _θ_ 2( _x, y_ ). Next, replace [1] 2 _[F]_ [(] _[x, y]_ [)]

with a dimensionless indicator function _−I_ 3( _x, y_ ) that is
only significantly different from zero in the vicinity of a
scattering edge (as shaded in green in Fig. 6). This estimates the sharp-edge negative-diffusion tensor field as
the symmetric matrix function



(158)
where _ψ_ (˘ _x,_ ˘ _y_ ) _∈_ ( _−π/_ 2 _, π/_ 2] is the angle that the major axis of each edge-scatter ellipse makes with the positive _x_ axis, _Rψ_ ( _x,y_ ) is the rotation matrix field defined in
Eq. (75), (˘ _x,_ ˘ _y_ ) denotes spatial coordinates of the point
on the scattering edge _∂_ Ωthat is closest to ( _x, y_ ) (see
Fig. 7), and a superscript _T_ means matrix transposition.


_3._ _Negative diffusion field: Case for a single-material_
_sample_


Our preceding discussions, relating to negative diffusion fields in the context of Fokker-Planck extensions to
the TIE, all consider scattering from sharp sample edges.
Here we consider a distinct mechanism for negative diffusion, which may be associated with out-of-focus contrast

[9–12] of a single-material sample [143].
Consider the simple special case of a thin sample that
is _composed of a single material_ described by a fixed
nonzero linear attenuation coefficient _µ_ and fixed refractive index


_n_ = 1 + _δ_ (159)


that is not equal to unity. [56] Let the projected thickness of
the sample be denoted by _T_ proj( _x, y_ ), with this projection


56 The following formalism is also applicable if the single material



**D** - edge( _x, y_ ) _≈−_ ∆ _[λ]_ _[I]_ [3][(] _[x, y]_ [)] _[R][ψ]_ [(˘] _[x,][y]_ [˘][)]



�1 0�
0 0 [ _Rψ_ (˘ _x,y_ ˘)] _[T]_ _,_


being taken along the direction of the optical axis of a
paraxial imaging system. Assuming normally-incident
near-monochromatic illumination by a plane wave with
uniform intensity _I_ 0, with the thin sample being placed
immediately upstream of the plane _z_ = 0, the intensity
at the exit surface of the sample is given by the Beer–
Lambert law as


_I_ ( _x, y, z_ = 0) = _I_ 0 exp[ _−µT_ proj( _x, y_ )] _._ (160)


Under the projection approximation [42] whereby local
ray paths within the sample are well approximated by
straight-line trajectories that are parallel to the optical
axis _z_, the phase _ϕ_ ( _x, y_ ) of the field—over the sample
exit surface in the plane _z_ = 0—is approximated by [143]


_ϕ_ ( _x, y_ ) = _kδT_ proj( _x, y_ ) _._ (161)


Substitute the preceding two equations into Eq. (21) and
then make a weak-scatter approximation by replacing
1 _−_ _F_ ( _x, y_ ) with unity. Hence, without any further approximation, we obtain [Ref. [3], Eq. (59)] [57]


_I_ ( _x, y, z_ = ∆) = _I_ ( _x, y, z_ = 0)

+ ∆ [2] _∇_ [2] _⊥_ [[ ˘] _[D]_ [(] _[x, y]_ [; ∆)] _[I]_ [(] _[x, y, z]_ [ = 0)]] _[,]_ _F_ ( _x, y_ ) _≪_ 1 _,_
(162)


wherein we have introduced the dimensionless effective
diffusion field


_δ_
_D_ ˘ ( _x, y_ ; ∆) = _D_ ( _x, y_ ) + (163)
_µ_ ∆ _[.]_


Equation (162) has the mathematical form of a finitedifference approximation to the ordinary diffusion equation, with the important difference that _the associated ef-_
_fective diffusion coefficient may be either positive or neg-_
_ative_ . In particular, if the blurring influence of the diffusion field _D_ ( _x, y_ ) is negligible, this term may be dropped
to leave the constant _defocus-induced diffusion field_


_δ_
_D_ ˘ ( _x, y_ ; ∆) _−→_ (164)
_µ_ ∆ _[.]_


If we exclude the case of optically-pumped active media under conditions of population inversion [33], the linear attenuation coefficient _µ_ will be positive. However,


is of variable density. In this more general case, both _δ_ and _µ_
will be functions of position at any point within the sample, but
the ratio of these quantities will be constant. Note, further, that
Eq. (159) in the present paper repeats the first half of Eq. (74)
in Paper I, without the “ _|δ| ≪_ 1” restriction in the second half
of the latter equation. Cf. footnote 11 in Paper I.
57 Note that a non-dimensionless form for the diffusion field is employed in Ref. [3]. Moreover, the quantity _δ_ in that x-ray paper
is the negative of the _δ_ employed in the present paper. This difference in notation arises from the fact that refractive indices for
hard x-rays are typically (slightly) less than unity, whereas for
visible light refractive indices are typically greater than unity.



27


_δ/_ ∆may be either positive or negative. For example,
for visible-light imaging, _δ_ will typically be positive but
∆can be made negative via an imaging system that can
access negative defoci ∆. As another example, for hardx-ray imaging, _δ_ will typically be negative (and much less
than unity in magnitude), [58] with positive ∆being accessible via free-space propagation (from the exit surface of
the sample, to the entrance surface of a position-sensitive
detector). Under such conditions, the defocus-induced
diffusion field in Eq. (164) will be negative.
The uniform negative diffusion field corresponding to
the “negative _δ/_ ∆” case of Eq. (164) is possible because the single-material assumption [as quantified in
Eqs. (160) and (161)] enables the phase _ϕ_ ( _x, y_ ) over the
sample’s exit surface to be written in terms of the intensity _I_ ( _x, y, z_ = 0) over the same surface. This formally
eliminates phase from the finite-difference approximation
to the Fokker-Planck generalization of the TIE in the
form given by Eq. (162). [59] The associated conceptual
adjustment—from (i) viewing transverse phase gradients
as associated with defocus-induced transverse intensity
flow to (ii) instead viewing transverse intensity gradients
as associated with such flow—recasts out-of-focus phase
contrast in entirely diffusive terms. For indicative experimental examples, of the sharpening effects of the negative diffusion field associated with out-of-focus contrast
for single-material samples, see, e.g., the visible-light images in Poola and John [145], the electron-microscopy
images in Gabor [146], the x-ray images in Snigirev _et al._

[106], and the neutron images in Allman _et al._ [147].
It is also interesting to consider how the image-blurring
effects of an extended chaotic source may be balanced by
the image-sharpening effects due to out-of-focus contrast
and its associated negative diffusion field (for the case of
a single-material sample). Such a balance has previously
been studied by Gureyev _et al._ [148] and Beltran _et al._

[149]. By assumption, let us here ignore the blurring
influence of a nonzero diffuse-flow fraction by setting _F_
to zero in Eq. (24) from Paper I. The associated sourceblur uniform diffusion field is given by _D_ = [1] 2 _[θ]_ 0 [2][, where]

_θ_ 0 is the half-angle subtended by the illuminating source
at the entrance surface of the sample (see Fig. 2 in Paper
I). Hence Eq. (163) becomes


_δ_

_D_ ˘ (∆) = [1] 0 [+] (165)

2 _[θ]_ [2] _µ_ ∆ _[.]_


Depending on the defocus ∆, _D_ [˘] can assume negative
or positive values. Negative values for _D_ [˘] correspond to
defoci ∆which are such that the image-sharpening effects of out-of-focus contrast are stronger than the imageblurring effects of a nonzero source size. Conversely, positive values for _D_ [˘] correspond to defoci where the imagesharpening effects of out-of-focus contrast are weaker


58 See, e.g., p. 114 of Ref. [42].
59 A similar comment is made in Gureyev _et al._ [144].


than the image-blurring effects of a nonzero source size.
A zero value for _D_ [˘] is attained for ∆equal to _−_ 2 _δ/_ ( _µθ_ 0 [2][);]
this reproduces a result reported in Gureyev _et al._ [148],
wherein the previously mentioned effects—namely outof-focus sharpening and source-size blur (or, more generally, the blurring effects of an imaging system’s point
spread function (PSF))—cancel one another. [60]


**IX.** **DISCUSSION**


This discussion has five parts. Section IX A examines how paraxial diffusion fields are a “running coupling” associated with the statistical-physics idea of a
renormalization group. Section IX B treats the resolution dependence of a paraxial-flow partition into coherent
and diffuse channels, emphasizing that _progressively finer_
_spatiotemporal resolution leads to a progressively smaller_
_fraction of the flow being assigned to the diffuse chan-_
_nel_ . This is closely related to Sec. IX C, which considers
Liouville’s theorem and the role of unresolved speckle.
Connections between the diffusion-field concept and the
notion of partial coherence are discussed in Sec. IX D.
We close with Sec. IX E, which suggests how some of the
ideas developed in the present pair of papers might be applied to imaging using a variety of radiation and matterwave fields, such as visible-light microscopy, transmission
electron microscopy, and neutron imaging. [61]


**A.** **Paraxial-optics diffusion fields, renormalization**
**group, and running couplings**


From a fundamental perspective, there is an important relation between the Fokker–Planck diffusion field
and the notion of a renormalization group. The renormalization group is a concept often employed in statistical physics and quantum field theory [49, 150]. The basic
idea is that, upon suitable coarse graining (“blurring”) of
a physical system, the governing equations—which may


60 This cancellation when ∆= _−_ 2 _δ/_ ( _µθ_ 02 [) may be reframed by fol-]
lowing Fig. 2 in Paper I to set _σ_ ∆ = _θ_ 0∆, where _σ_ ∆ is the standard deviation associated with _any_ position-invariant PSF (i.e.,
a PSF which is not necessarily associated with source-size blur).
Hence the cancellation of blur and out-of-focus contrast occurs
when ∆= _−_ 2 _δ/_ [ _µ_ ( _σ_ ∆ _/_ ∆) [2] ], namely when ∆= _−µσ_ ∆ [2] _[/]_ [(2] _[δ]_ [).]
Now let _µ_ = 2 _kβ_ (see p. 74 of Ref. [42]), where _β_ is the imaginary part of the complexified refractive index _n_ = 1 + _δ_ + _iβ_ of
the single-material sample [cf. Eq. (159)], and _k_ = 2 _π/λ_ is the
wavenumber corresponding to wavelength _λ_ . Hence the cancellation occurs when ∆= _−kβσ_ ∆ [2] _[/δ]_ [, in agreement with the result]
of Gureyev _et al._ [148]. Note that the convention for _δ_, in the
just-cited paper, is the negative of that employed in Eq. (159).
61 As mentioned on several occasions, Fokker-Planck diffusion-field
retrieval has already been applied in a number of publications
employing hard-x-ray photons. However, to the best of our
knowledge, it has yet to be applied to visible-light microscopy,
transmission electron microscopy, or neutron imaging.



28


be differential equations, as is the case in our work—are
unchanged in mathematical form. However, the physical
quantities that appear in the equations _are_ changed by
the process of coarse graining. In our case, the coarse
graining is in the spatial dimension, with characteristic
length scale _ℓ_ specified by the resolution of the optical
imaging system. Features smaller than _ℓ_ are not spatially resolved, by definition, with such fine features contributing to the Fokker–Planck diffusion field in either
its scalar form _D_ ( _x, y_ ) or tensor form **D** ( _x, y_ ). Hence

[�]
such paraxial _diffusion fields will be a function of ℓ_ . [62]

More generally, the bifurcation of energy flows into both
the diffuse and coherent channels is dependent on _ℓ_ . In
this context, we can view the Fokker–Planck diffusion
scalar _D_ ( _x, y_ ; _ℓ, · · ·_ ) or tensor **D** ( _x, y_ ; _ℓ, · · ·_ ) as a _running_

[�]
_coupling_ [150] that quantifies the degree to which an illuminated object transfers incident photons (or electrons,
neutrons, etc.) from the coherent-flow to the diffuseflow channel. The invariance in mathematical form of
the Fokker–Planck equation upon a change of _ℓ_, albeit
with a change in the running couplings such as that encoded in the diffusion scalar or tensor, is typical of the
renormalization-group concept. This statement holds for
a particular range of the sliding scale _ℓ_, which should be
(i) large enough that higher-order diffusion-field terms [63]

may be neglected to a good approximation, and (ii) small
enough that one has an image, i.e., _ℓ_ must be significantly
smaller than the transverse extent of the sample at the
image plane. Moreover, the manner in which the diffusion tensor varies with _ℓ_ (or with energy) may give further information regarding the nature of the unresolved
microstructure. For example, if the unresolved structure
is a random fractal [50, 153–156] with a given fractal
dimension, this will influence the manner in which the
Fokker-Planck diffusion field scales with changing _ℓ_ .


**B.** **Resolution dependence of paraxial-flow**
**partition into coherent and diffuse channels**


The considerations of Sec. IX A have implications for
the use of pixelated image-intensity measurements. Consider an imaging detector that uses square pixels of
width _W_, which measures intensity maps in the context
of paraxial-wave diffusion-field retrieval. Changing the
pixel size will change the decomposition of the paraxial optical flow, into its coherent-flow and diffuse-flow
components. In particular, the scalar and tensor diffusion fields will carry a dependence upon _W_ . In the
idealized limit of an elastically-scattering sample transmitting paraxial scalar monochromatic radiation whose


62 The diffusion field will also depend on other parameters such as
energy and detector acquisition time. Regarding the dependence
on detector acquisition time, cf. Magyar and Mandel [151] and
Paganin and S´anchez del R´ıo [152].
63 We here refer to the Kramers-Moyal extension of the FokkerPlanck equation (see the final paragraph of Sec. III B).


intensity is measured using a detector having pixels that
are arbitrarily small, all of the detected energy will correspond to the coherent-flow channel, with none being
assigned to the diffuse-flow channel. More realistically,
for an elastically-scattering sample which is illuminated
by paraxial quasimonochromatic radiation that remains
paraxial after passing through the sample, the scalar and
tensor diffusion fields will in general reduce in magnitude
as _W_ decreases. Moreover, if the sample-to-detector defocus distance ∆may be altered via free-space propagation [64] through a vacuum-filled region between the exit
surface of a fixed sample _B_ and a movable entrancesurface of a detector _C_ (see Fig. 3 of Paper I), then increasing ∆will also alter the scalar and tensor diffusion
fields associated with the sample, because this increase
in ∆will alter the angle that any pixel subtends with
respect to any particular point in the sample.
In light of the preceding paragraph, it is clarifying to
consider the following simple model for the dependence of
a diffusion field upon pixel size _W_ . Adapting the notation
from Sec. V E of Paper I, let _P_ ( _kR_ ) denote the intensity
power spectrum illuminating a planar detector surface,
where _kR_ denotes radial spatial frequency. Let

_k_ ˜ _R ≡_ _π/W_ (166)


be the radial Nyquist spatial frequency [83], namely the
highest radial spatial frequency that is properly sampled
by the detector. At any one particular pixel location, the
fraction _F_ of the field that is associated with diffusive
flow (rather than coherent flow) is [86]



29


With trivial loss of generality we choose units of length
such that _α_ = 1. In this case _F_ may be plotted versus
_W_ for various values of _γ >_ 2. As shown in Fig. 8, we
observe the expected behaviors that (i) _F_ is a nonconstant function of _W_, (ii) _F_ tends to zero in the infiniteresolution limit where _W_ tends to zero, and (iii) _F_ becomes progressively closer to unity as the resolution becomes sufficiently coarser, namely as _W_ becomes progressively larger. The “broader the tails” of the power
spectrum, namely the smaller the value of _γ_, the greater
the fraction _F_ of the paraxial flow that is classified
as diffusive rather than coherent. Since the diffusion
field is directly proportional to the scattering fraction
_F_, via Eq. (20), [66] we reach the interesting conclusion
that measuring the resolution dependence of the diffusion field may enable a measurement of _γ_, which governs
the asymptotic rate of decay of the local power spectrum.


FIG. 8. Variation of the diffuse-flow fraction _F_ as a function
of detector spatial resolution _W_, according to Eq. (170).


**C.** **Liouville’s theorem, spatial coarse graining, and**
**the role of unresolved speckle**


Consider the following two models for beamlike flow
through an infinitely extended two-dimensional planar
mathematical surface _S_ that is perpendicular to the optical axis associated with a partially coherent [51] quasimonochromatic [7] paraxial complex scalar wave field. (i)
Using the Fokker-Planck formalism of the present pair
of papers, we may describe this propagating beam using four fields, namely the (scalar) intensity _I_ ( _x, y_ ), the
(scalar) phase _ϕ_ ( _x, y_ ), the (scalar) fraction _F_ ( _x, y_ ) of the
flow that is associated with the diffuse channel, and the
diffusion field [which may be a scalar field _D_ ( _x, y_ ) or a
rank-two symmetric matrix field **D** ( _x, y_ )]. (ii) More generally, under the space-frequency description of partially
coherent fields [32, 158], we may instead model the beam
over _S_ via a statistical ensemble _E_ of strictly monochro

66 For a more general expression, which takes the effects of sourcesize blur into account, see Eq. (24) in Paper I.



_F_ ( _W_ ) =




- _∞_
_k_ ˜ _R_ ~~�~~ =0 ~~_∞_~~ _π/kWRP_ _[k]_ _R_ ( _k_ _[P]_ _R_ [(] ) _[k]_ _dkR_ [)] _R_ _[dk]_ _R_ _._ (167)



As a model power spectrum, use the “Pearson VII” form


_N_
_P_ ( _kR_ ) = (168)
(1 + _αkR_ [2] [)] _[γ/]_ [2] _[,]_


where _α >_ 0 and _γ >_ 2 are positive constants [65] and _N_
is a normalization factor [157]. Note that the case where
_γ −→_ 2 corresponds to a Lorentzian distribution (BreitWigner distribution), with _γ −→∞_ corresponding to a
Gaussian distribution provided that _α ∝_ _γ_ _[−]_ [1] in the same
limit. Also note that for large radial spatial frequency,
the asymptotic behavior

_P_ ( _kR_ ) _∼_ _kR_ _[−][γ]_ (169)


of the power spectrum agrees with the form in Eq. (137)
of Paper I. Substitute Eq. (168) into Eq. (167) and then
evaluate the resulting integrals to give [86]


_F_ ( _W, γ, α_ ) = _W_ _[γ][−]_ [2] ( _απ_ [2] + _W_ [2] ) [1] _[−]_ [(] _[γ/]_ [2)] _._ (170)


64 This situation is distinct from scenarios where defocus is induced
using a suitable imaging system, in which case the text of the
remainder of this paragraph is inapplicable.
65 The condition on _γ_ ensures that the integrals in Eq. (167) are
finite. Also, _α_ has units of squared length.


matic fields, all of which have the same temporal frequency (i.e., the same energy). Each member of _E_ is
a complex scalar wavefunction that may be thought of
a single point in a high-dimensional state space (phase
space) [49, 64]; hence _E_ corresponds to a cloud _C_ of statespace points. Upon propagating along the optical axis
downstream of _S_, the state-space cloud will flow. The
unitary nature of the paraxial wavefield diffraction operator [159] implies that Liouville’s theorem is operative,
i.e., _C_ flows in a volume-preserving manner that corresponds to an incompressible phase-space fluid [49, 64].


The volume preserving (and therefore entropy preserving) phase-space flow in the second model might appear
to contradict the entropy increase implied by the diffusion field in the first model. However, there is no
contradiction, for the following reason. Following the
explanation on pp. 183-184 of Thorne and Blandford

[160], the unresolved speckles implicit in the ensemble
_E_ will cause the cloud _C_ to evolve in a “mixing” [161]
manner whereby the volume of the cloud is folded (in
a highly convoluted way) through a progressively larger
volume of the phase space; while the volume of _C_ does
not change upon free-space propagation, it quickly becomes so broadly dispersed (filamented) that _upon per-_
_forming a spatial coarse graining that is necessitated by_
_the finite spatial resolution of pixelated imaging detec-_
_tors_ the effective phase-space volume increases with increased propagation distance downstream of _S_ . Stated
differently, the phase-space volume does not grow, but
the coarse-grained phase-space volume does grow; this
latter statement is consistent with the entropy increase
implied by nonzero Fokker-Planck diffusion fields.


The preceding discussion on spatial coarse graining
leads us to the closely related notion of unresolved
speckle. It is typical, in imaging scenarios employing partially coherent radiation, for unresolved speckle to play
a key albeit often implicit role [3, 18, 152]. For the work
outlined here, two distinct foundational roles for unresolved speckle should be highlighted. The first relates to
spatiotemporal speckle [162] associated with partially coherent illumination and its subsequent transport through
an imaging system. The time integration in an intensity
measurement averages over the temporal speckles, with
spatial averages over finite-area detector elements coarse
graining over the spatial speckles. These time averages
may be replaced by ensemble averages, if ergodicity can
be assumed [163]. Under this view, the time-averaged
energy-flow vector (or ensemble-averaged flow) exhibits
the bifurcation into coherent-flow and diffuse-flow channels as described by the Fokker-Planck generalization

[3, 4] of the TIE [2]. A second role for unresolved speckle
lies with spatially-unresolved sample microstructure (“internal roughness”), which may itself be viewed as a form
of speckle insofar as it is associated with spatially random
variations in the scattering potential [32, 163, 164].



30


**D.** **Link between paraxial diffusion fields and**
**partial coherence**


Recall Eq. (24) from Paper I, which models two distinct contributions to a paraxial scalar diffusion field
_D_ ( _x, y_ ). The first contribution is the approximately
position-independent diffusive influence of the nonzero
angular radius _θ_ 0 of an extended chaotic source (see
Fig. 3 from Paper I), with the second being the positiondependent diffusive contribution due to scattering from
unresolved sample microstructure. Notwithstanding this
partition of the influence of source size (“spatial coherence”) and sample microstructure, the resulting _diffusion_
_field is a property of the paraxial optical beam_ at the exit
surface of the sample (again see Fig. 3 from Paper I).
While the diffusion field may be influenced by both sample and source, together with the spatial and temporal
resolution of the detector, the concept of a diffusion field
may be decoupled from such particular influences.
This observation invites comparison with formalisms
for partially coherent optical fields [7, 52]. Indeed, the
concept of partial optical coherence is often couched in
terms of the ability of an optical field to form interference fringes, with high fringe visibility associated with
a high degree of coherence, and low fringe visibility associated with a low degree of coherence [51]. If we now
think of lower interference-fringe visibility as being a diffused form of higher visibility, [67] we are immediately led
to inquire into the connection between the diffusion-field
concept and standard notions of partial coherence.
In an imaging context, partial coherence may exist at
two distinct levels which are related to the imaging system and sample (if present), respectively. Both mechanisms may lead to a diffuse component in energy flow
through the system, which augments the coherent energy
flow [3]. We discuss each mechanism in turn. (i) The optical system in Fig. 3—which consists of a source _A_, an
imaging system _C_, and a detector (not shown) with finite
spatial and temporal resolution—will in general lead to
a partially coherent field over the imaging plane _D_ . If it
is not laser-like, the source itself will typically generate
illumination that is partially coherent to a non-negligible
degree. This state of partial coherence may be described
using a variety of formalisms such as the cross-spectral
density [52], density matrix [73], Wigner function [165],
generalized radiance [166], ambiguity function [167], etc.
Regardless of the adopted formalism, the corresponding
coherence function will evolve as the field propagates
through free space. [68] The imaging system _C_ also influences coherence-function transport. Moreover, finite
spatial and temporal detector resolution are key parameters. For example, finite pixel size will smear spatial features or speckles that are smaller than the pixel size (or


67 Cf. Eqs. (140)-(143).
68 The van Cittert-Zernike theorem [163] is a key example.


point-spread-function width if this is larger than the pixel
size); [69] finite temporal resolution will smear over temporal fluctuations occurring at timescales smaller than the
temporal resolution [34, 151]. More generally, a complete description of the state of coherence of the field
involves an ensemble of correlation functions of progressively higher order. [70] In comparison, the diffusion-field
concept only gives a partial description of the state of
a partially coherent field. (ii) Spatially unresolved microstructure within the sample alters the degree of coherence of transmitted radiation. Stated differently, we
may consider any of the previously-mentioned coherence
functions as being scattered by the microstructure that
is present in the sample. [71]

In light of the preceding comments, both the diffusion field _D_ ( _x, y, z_ ) and the diffuse-flow fraction _F_ ( _x, y, z_ )
may be viewed as single-point measures—or order parameters [49]—that are influenced by the partially coherent
nature of the underlying field. These single-point functions, which are only nonvanishing for partially coherent
fields, contain partial rather than complete information
regarding the state of coherence of the field.


**E.** **Paraxial diffusion-field retrieval using a variety**
**of radiation and matter wave fields**


At the time of writing, and to the best of our knowledge, no Fokker-Planck TIE experiments outside of the
domain of x-ray optics have been reported. Accordingly, it would be interesting to apply the results of
the present pair of papers, to Fokker-Planck paraxial
diffusion-field retrieval using visible light, electrons, and
neutrons. While the same principle applies to all of these
paraxial-beam scenarios, some important points of difference should be mentioned. These are discussed below.
In the case of both visible-light and electron-optical implementations of the method, relatively aberration-free
coherent imaging systems are readily available [7, 168].
These enable both over-focus and under-focus images to
be obtained for the purposes of phase and diffusion-field
retrieval; as seen earlier in this paper, the ability to work
with symmetrically defocused images considerably simplifies the analysis. Conversely, for the case of both x-ray
imaging [42] and neutron imaging [169], it is often (but
not always) the case that negatively defocused images are
not available since a relatively aberration-free imaging
system is not incorporated into the experiment; in this
case, positively-defocused images may be formed (in the
absence of an imaging system) via free-space propagation

[106, 147, 170, 171] but negatively-defocused images are
not available. It is for this reason that some of the ap

69 See, e.g., Sec. 3.6.3 of Paganin [42].
70 See, e.g., pp. 422-428 of Mandel and Wolf [52].
71 See, e.g., Sec. 6.3 of Wolf [32].



31


proaches in this paper have been restricted to positively
defocused images.
The influence of partial spatial coherence [32], namely
the image-blurring effects of nonzero source size, may
also differ across different implementations. For experiments using visible-light microscopes [7], synchrotron xrays [172], and transmission electron microscopes [173], it
will often be the case that the image-blurring effects of an
extended incoherent source may be rendered negligible,
on account of the sufficiently high degree of brightness
of the respective sources. In this small-source case, the
contribution of angular source-size blur to a paraxial diffusion field—as quantified by nonzero _θ_ 0 in Eq. (24) of
Paper I—may often be ignored. However, for nuclearreactor [174] and spallation [175] neutron sources, microfocus x-ray sources [176, 177], and liquid metal-jet x-ray
sources [178], it will often be the case that the sourceblur contribution to the paraxial diffusion field cannot
be neglected.
Finally, regarding appropriate scattering-theory
diffusion-field models, these will often differ depending
on whether the Fokker-Planck extension of the TIE is
being applied to visible-light photons, x-ray photons,
electrons, neutrons, etc. We now give two examples. (i)
The projection approximation, whereby both the phase
shift and the diffusion field at some point _P_ on the
exit surface of a sample may be obtained via a suitable
integral taken over a straight line passing through the
sample, will often be applicable for hard x-rays [42]
and neutrons [169] passing through a macroscopic-sized
non-crystalline object [see, e.g., Eqs. (88) and (95) in
Paper I]. However, the projection approximation will fail
in visible-light scattering through optically thick media,
such as thick turbid media where the transverse scatter
within the volume of the sample cannot be neglected; in
such cases, a more sophisticated scattering formalism is
needed to calculate the intensity, phase, and diffusion
field over the exit surface of the sample [156, 179]. (ii)
Since hard x-rays primarily interact with the electron
density in a sample [42] and neutrons primarily interact
with the atomic nuclei [180], the corresponding diffusion
fields will in general contain complementary information
regarding unresolved microstructure.


**X.** **CONCLUSION**


In this direct continuation of Paper I [1] the concept of
a paraxial diffusion field was augmented to take into account the presence of a coherent component to the flow.
This gave Fokker-Planck extensions to the transportof-intensity equation of paraxial wave optics, whereby
coherent flow associated with phase gradients is augmented by diffuse flow associated with intensity gradients. Several derivations of this extension were given, together with several different means for phase retrieval and
diffusion-field retrieval. Existing methods for transportof-intensity phase retrieval need no modification in light


of any of the modifications of this equation discussed
in the present paper, provided that symmetrically overfocused and underfocused images are employed. Perhaps more importantly, _diffusion-field retrieval enables_
_a complementary additional channel of information to_
_be obtained from paraxial focal series, beyond the phase_
_and intensity fields that are reconstructed in transport-of-_
_intensity analyses_ . While the Fokker-Planck extension of
the transport-of-intensity equation has been applied to
experiments in x-ray optics, to the best of our knowledge the method has yet to be applied to experiments
employing visible light, electrons, and neutrons.


[1] D. M. Paganin, D. Pelliccia, and K. S. Morgan, Paraxial diffusion-field retrieval, Phys. Rev. A **108**, 013517
(2023).

[2] M. R. Teague, Deterministic phase retrieval: a Green’s
function solution, J. Opt. Soc. Am. **73**, 1434 (1983).

[3] D. M. Paganin and K. S. Morgan, X-ray Fokker-Planck
equation for paraxial imaging, Sci. Rep. **9**, 17537 (2019).

[4] K. S. Morgan and D. M. Paganin, Applying the FokkerPlanck equation to grating-based x-ray phase and darkfield imaging, Sci. Rep. **9**, 17465 (2019).

[5] P. C. Sabatier, Past and future of inverse problems, J.
Math. Phys. **41**, 4082 (2000).

[6] C. Lanczos, _The Variational Principles of Mechanics_,
4th ed. (University of Toronto Press, Toronto, 1970).

[7] M. Born and E. Wolf, _Principles of Optics_, 7th ed.
(Cambridge University Press, Cambridge, 1999).

[8] M. V. Berry, Five momenta, Eur. J. Phys. **34**, 1337
(2013).

[9] F. Zernike, Phase contrast, a new method for the microscopic observation of transparent objects, Physica **9**,
686 (1942).

[10] H. Bremmer, On the asymptotic evaluation of diffraction integrals with a special view to the theory of defocusing and optical contrast, Physica **18**, 469 (1952).

[11] J. M. Cowley, The electron-optical imaging of crystal
lattices, Acta Cryst. **12**, 367 (1959).

[12] J. M. Cowley, _Diffraction Physics_, 3rd ed. (North Holland, Amsterdam, 1995).

[13] D. Gilbarg and N. S. Trudinger, _Elliptic Partial Dif-_
_ferential Equations of Second Order_, 2nd ed. (Springer,
Berlin, 1998).

[14] T. E. Gureyev, A. Roberts, and K. A. Nugent, Partially
coherent fields, the transport-of-intensity equation, and
phase uniqueness, J. Opt. Soc. Am. A **12**, 1942 (1995).

[15] D. Paganin and K. A. Nugent, Noninterferometric phase
imaging with partially coherent light, Phys. Rev. Lett.
**80**, 2586 (1998).

[16] C. Zuo, J. Li, J. Sun, Y. Fan, J. Zhang, L. Lu, R. Zhang,
B. Wang, L. Huang, and Q. Chen, Transport of intensity equation: a tutorial, Opt. Lasers Eng. **135**, 106187
(2020).

[17] E. Hecht, _Optics_, 5th ed. (Pearson, Boston, 2017).



32


**ACKNOWLEDGMENTS**


K.S.M. acknowledges funding via Australian Research
Council Future Fellowship FT180100374. K.S.M. and
D.M.P. acknowledge funding from Australian Research
Council Discovery Project DP230101327. We acknowledge useful discussions with Jannis Ahlers, Samantha Alloo, Alaleh Aminzadeh, Alex Aumann, Mario Beltran,
Emmanuel Brun, Michelle Croughan, Carsten Detlefs,
Christian Dwyer, Jayan Gunasekera, Timur Gureyev,
Ying Ying How, Dominik John, Samy Kefs, Andrew
Kingston, Marcus Kitchen, Christoph Koch, Kieran
Larkin, Thomas Leatham, Amelia Liu, Clara Magnin,
Eduardo Miqueles, Konstantin Pavlov, Daniele Pelliccia,
Tim Petersen, James Pollock, Rahil Valani, and MarieChristine Zdora.


[18] D. M. Paganin and D. Pelliccia, X-ray phase-contrast
imaging: a broad overview of some fundamentals, Adv.
Imaging Electron Phys. **218**, 63 (2021).

[19] H. Risken, _The_ _Fokker-Planck_ _Equation_, 2nd ed.
(Springer Verlag, Berlin, 1989).

[20] D. M. Paganin, V. Favre-Nicolin, A. Mirone, A. Rack,
J. Villanova, M. P. Olbinado, V. Fernandez, J. C.
da Silva, and D. Pelliccia, Boosting spatial resolution by
incorporating periodic boundary conditions into singledistance hard-x-ray phase retrieval, J. Opt. **22**, 115607
(2020).

[21] T. A. Leatham, D. M. Paganin, and K. S. Morgan, Xray dark-field and phase retrieval without optics, via the
Fokker-Planck equation, IEEE Trans. Med. Imaging **42**,
1681 (2023).

[22] T. A. Leatham, D. M. Paganin, and K. S. Morgan, Xray phase and dark-field computed tomography without
optical elements, Opt. Express **32**, 4588 (2024).

[23] S. J. Alloo, D. M. Paganin, K. S. Morgan, M. J. Kitchen,
A. W. Stevenson, S. C. Mayo, H. T. Li, B. M. Kennedy,
A. Maksimenko, J. C. Bowden, and K. M. Pavlov, Darkfield tomography of an attenuating object using intrinsic x-ray speckle tracking, J. Med. Imaging **9**, 031502
(2022).

[24] M. A. Beltran, D. M. Paganin, M. K. Croughan, and
K. S. Morgan, Fast implicit diffusive dark-field retrieval
for single-exposure, single-mask x-ray imaging, Optica
**10**, 422 (2023).

[25] S. J. Alloo, K. S. Morgan, D. M. Paganin, and K. M.
Pavlov, Multimodal intrinsic speckle-tracking (MIST)
to extract images of rapidly-varying diffuse X-ray darkfield, Sci. Rep. **13**, 5424 (2023).

[26] S. J. Alloo, D. M. Paganin, M. K. Croughan, J. N.
Ahlers, K. M. Pavlov, and K. S. Morgan, Separating edges from microstructure in x-ray dark-field imaging: evolving and devolving perspectives via the X-ray
Fokker-Planck equation, Opt. Express **33**, 3577 (2025).

[27] T. J. Davis, Imperfect crystals and dynamical X-ray
diffraction in the complex reflectance plane, Aust. J.
Phys. **44**, 693 (1991).

[28] T. J. Davis, A stochastic model for X-ray diffraction
from imperfect crystals, Acta Cryst. A **48**, 872 (1992).


[29] T. J. Davis, The measurement of defect parameters in
imperfect crystals using X-ray diffraction, Acta Cryst.
A **49**, 755 (1993).

[30] T. J. Davis, Dynamical X-ray diffraction from imperfect
crystals: a solution based on the Fokker-Planck equation, Acta Cryst. A **50**, 224 (1994).

[31] J. J. Sakurai, _Advanced Quantum Mechanics_ (AddisonWesley, Reading, 1967).

[32] E. Wolf, _Introduction to the Theory of Coherence and_
_Polarization of Light_ (Cambridge University Press,
Cambridge, 2007).

[33] R. Loudon, _The Quantum Theory of Light_, 3rd ed. (Oxford University Press, Oxford, 2000).

[34] R. F. Loane, P. Xu, and J. Silcox, Thermal vibrations
in convergent-beam electron diffraction, Acta Cryst. A
**47**, 267 (1991).

[35] Ya. I. Nesterets, On the origins of decoherence and extinction contrast in phase-contrast imaging, Opt. Commun. **281**, 533 (2008).

[36] J. Crank, _The Mathematics of Diffusion_, 2nd ed. (Oxford University Press, Oxford, 1975).

[37] F. Mandl and G. Shaw, _Quantum Field Theory_, 2nd ed.
(Wiley, Chichester, 2010).

[38] A. Goldberg, H. M. Schey, and J. L. Schwartz,
Computer-generated motion pictures of onedimensional quantum-mechanical transmission and
reflection phenomena, Am. J. Phys. **35**, 177 (1967).

[39] D. M. Paganin, M. Sales, P. M. Kadletz, W. Kockelmann, M. A. Beltran, H. F. Poulsen, and S. Schmidt,
Revisiting neutron propagation-based phase-contrast
imaging and tomography: Use of phase retrieval to amplify the effective degree of brilliance, Phys. Rev. Appl.
**19**, 034005 (2023).

[40] K. M. Pavlov, D. M. Paganin, K. S. Morgan, H. T. Li,
S. Berujon, L. Qu´enot, and E. Brun, Directional darkfield implicit x-ray speckle tracking using an anisotropicdiffusion Fokker-Planck equation, Phys. Rev. A **104**,
053505 (2021).

[41] D. M. Paganin, _Studies in Phase Retrieval_, Ph.D. thesis,
University of Melbourne (1999).

[42] D. M. Paganin, _Coherent X-Ray Optics_ (Oxford University Press, Oxford, 2006).

[43] J. T. Winthrop and C. R. Worthington, Convolution
formulation of Fresnel diffraction, J. Opt. Soc. Am. **56**,
588 (1966).

[44] R. Metzler and J. Klafter, The random walk’s guide to
anomalous diffusion: a fractional dynamics approach,
Phys. Rep. **339**, 1 (2000).

[45] L. R. Evangelista and E. K. Lenzi, _Fractional Diffusion_
_Equations and Anomalous Diffusion_ (Cambridge University Press, Cambridge, 2018).

[46] A. Einstein, _Investigations on the Theory of the Brow-_
_nian Movement_ (Dover Publications, New York, 1956).

[47] L. Tisza, The theory of liquid helium, Phys. Rev. **72**,
838 (1947).

[48] W. Yourgrau and S. Mandelstam, _Variational Princi-_
_ples in Dynamics and Quantum Theory_, 3rd ed. (Dover
Publications, New York, 1979).

[49] K. Huang, _Statistical Mechanics_, 2nd ed. (Wiley, New
York, NY, USA, 1987).

[50] J. P. Sethna, _Statistical Mechanics: Entropy, Order Pa-_
_rameters and Complexity_ (Oxford University Press, Oxford, 2006).



33


[51] F. Zernike, The concept of degree of coherence and its
application to optical problems, Physica **5**, 785 (1938).

[52] L. Mandel and E. Wolf, _Optical Coherence and Quantum_
_Optics_ (Cambridge University Press, Cambridge, 1995).

[53] G. A. Pavliotis, _Stochastic Processes and Applications:_
_Diffusion Processes, the Fokker-Planck and Langevin_
_Equations_ (Springer, New York, 2014).

[54] T. H. Jensen, M. Bech, O. Bunk, T. Donath, C. David,
R. Feidenhans’l, and F. Pfeiffer, Directional x-ray darkfield imaging, Phys. Med. Biol. **55**, 3317 (2010).

[55] T. H. Jensen, M. Bech, I. Zanette, T. Weitkamp,
C. David, H. Deyhle, S. Rutishauser, E. Reznikova,
J. Mohr, R. Feidenhans’l, and F. Pfeiffer, Directional
x-ray dark-field imaging of strongly ordered systems,
Phys. Rev. B **82**, 214103 (2010).

[56] K. M. Pavlov, D. M. Paganin, H. T. Li, S. Berujon, H. Roug´e-Labriet, and E. Brun, X-ray multi-modal
intrinsic-speckle-tracking, J. Opt. **22**, 125604 (2020).

[57] T. E. Gureyev, D. M. Paganin, B. D. Arhatari, S. T.
Taba, S. Lewis, P. C. Brennan, and H. M. Quiney,
Dark-field signal extraction in propagation-based phasecontrast imaging, Phys. Med. Biol. **65**, 215029 (2020).

[58] J. N. Ahlers, K. M. Pavlov, M. J. Kitchen, and K. S.
Morgan, X-ray dark-field via spectral propagation-based
imaging, Optica **11**, 1182 (2024).

[59] J. N. Ahlers, K. M. Pavlov, M. J. Kitchen, S. A. Harker,
E. J. Pryor, J. A. Pollock, M. K. Croughan, Y. Y. How,
M.-C. Zdora, L. F. Costello, D. W. O’Connell, C. Hall,
and K. S. Morgan, Single-exposure x-ray dark-field
imaging via a dual-energy propagation-based setup,
Opt. Lett. **50**, 2171 (2025).

[60] J. Liu, S. J. Alloo, M. Langer, and K. M. Pavlov, Lowexposure high-quality multimodal speckle x-ray imaging
via an intrinsic gradient-flow approach, Phys. Rev. A
**112**, 063530 (2025).

[61] C. Kittel, _Elementary Statistical Physics_ (John Wiley
& Sons, New York, 1958).

[62] M. O. Scully and M. S. Zubairy, _Quantum Optics_ (Cambridge University Press, Cambridge, 1997).

[63] V. Balakrishnan, _Elements of Nonequilibrium Statistical_
_Mechanics_ (Springer, Cham, 2021).

[64] H. Goldstein, _Classical Mechanics_, 2nd ed. (AddisonWesley Publishing Company, Reading MA, 1980).

[65] H. H. Barrett and K. J. Myers, _Foundations of Image_
_Science_ (John Wiley & Sons, Hoboken NJ, 2004).

[66] K. B. Oldham and J. Spanier, _The Fractional Calculus:_
_Theory and Applications of Differentiation and Integra-_
_tion to Arbitrary Order_ (Dover Publications, New York,
2006).

[67] V. V. Yanovsky, A. V. Chechkin, D. Schertzer, and
A. V. Tur, L´evy anomalous diffusion and fractional
Fokker–Planck equation, Physica A **282**, 13 (2000).

[68] J. F. Kelly, C.-G. Li, and M. M. Meerschaert, Anomalous diffusion with ballistic scaling: A new fractional
derivative, J. Comput. Appl. Math. **339**, 161 (2018).

[69] G. Zaslavsky, Fractional kinetic equation for Hamiltonian chaos, Physica D **76**, 110 (1994).

[70] R. Metzler, E. Barkai, and J. Klafter, Anomalous diffusion and relaxation close to thermal equilibrium: A
fractional Fokker-Planck equation approach, Phys. Rev.
Lett. **82**, 3563 (1999).

[71] F. Liu, V. Anh, and I. Turner, Numerical solution of
the space fractional Fokker-Planck equation, J. Comput. Appl. Math. **166**, 209 (2004).


[72] L. A. Chernov, _Wave Propagation in a Random Medium_
(McGraw-Hill Book Company, New York, 1960).

[73] A. Messiah, _Quantum Mechanics_ (North-Holland, Amsterdam, 1961) 2 vols.

[74] E. H. Miyasaki, A. A. Bajor, G. M. Pettersson, M. L.
Senftleben, K. E. Fouke, T. G. W. Graham, D. D. John,
J. R. Morgan, G. Haspel, and S. Abrahamsson, Highspeed 3D imaging with a 25-camera multifocus microscope, Optica **12**, 1230 (2025).

[75] P. M. Morse and H. Feshbach, _Methods of Theoretical_
_Physics_ (McGraw-Hill, New York, 1953) 2 vols.

[76] J. A. Schmalz, T. E. Gureyev, D. M. Paganin, and K. M.
Pavlov, Phase retrieval using radiation and matterwave fields: Validity of Teague’s method for solution
of the transport-of-intensity equation, Phys. Rev. A **84**,
023808 (2011).

[77] V. Aksenov, V. Banakh, and O. Tikhomirova, Potential
and vortex features of optical speckle fields and visualization of wave-front singularities, Appl. Opt. **37**, 4536
(1998).

[78] S. Berujon, E. Ziegler, and P. Cloetens, X-ray pulse
wavefront metrology using speckle tracking, J. Synchrotron Rad. **22**, 886 (2015).

[79] W. A. Strauss, _Partial Differential Equations: An In-_
_troduction_ (John Wiley & Sons, New York, 1992).

[80] F. Roddier, Curvature sensing and compensation: a new
concept in adaptive optics, Appl. Opt. **27**, 1223 (1988).

[81] J. M. Cowley and A. F. Moodie, Fourier images IV: The
phase grating, Proc. Phys. Soc. **76**, 378 (1960).

[82] R. N. Bracewell, _The Fourier Transform and its Ap-_
_plications_, 2nd ed. (McGraw-Hill Book Company, New
York, 1986).

[83] W. H. Press, S. A. Teukolsky, W. T. Vetterling, and
B. P. Flannery, _Numerical Recipes: The Art of Scien-_
_tific Computing_, 3rd ed. (Cambridge University Press,
Cambridge, 2007).

[84] T. E. Gureyev, A. Roberts, and K. A. Nugent, Phase
retrieval with the transport-of-intensity equation: matrix solution with use of Zernike polynomials, J. Opt.
Soc. Am. A **12**, 1932 (1995).

[85] T. A. Leatham, _Retrieving X-ray Paraxial Imaging_
_Modalities via the Fokker-Planck equation_, Honours thesis, Monash University (2019).

[86] T. A. Leatham, _Applying the Fokker-Planck Equation_
_to X-ray Phase and Dark-Field Retrieval_, Ph.D. thesis,
Monash University (2023).

[87] J. H. Massig, Measurement of phase objects by simple
means, Appl. Opt. **38**, 4103 (1999).

[88] C. D. Perciante and J. A. Ferrari, Visualization of twodimensional phase gradients by subtraction of a reference periodic pattern, Appl. Opt. **39**, 2081 (2000).

[89] J. H. Massig, Deformation measurement on specular
surfaces by simple means, Opt. Eng. **40**, 2315 (2001).

[90] H. H. Wen, E. E. Bennett, R. Kopace, A. F. Stein, and
V. Pai, Single-shot x-ray differential phase-contrast and
diffraction imaging using two-dimensional transmission
gratings, Opt. Lett. **35**, 1932 (2010).

[91] K. S. Morgan, D. M. Paganin, and K. K. Siu, Quantitative single-exposure x-ray phase contrast imaging using a single attenuation grid, Opt. Express **19**, 19781
(2011).

[92] B. Medhi, Structured illumination-based transport-ofintensity phase imaging for quantitative diagnostics of
high-speed flows, Appl. Opt. **61**, 945 (2022).



34


[93] S. C. Mayo and B. Sexton, Refractive microlens array for
wave-front analysis in the medium to hard x-ray range,
Opt. Lett. **29**, 866 (2004).

[94] K. S. Morgan, P. Modregger, S. C. Irvine,
S. Rutishauser, V. A. Guzenko, M. Stampanoni,
and C. David, A sensitive x-ray phase contrast technique for rapid imaging using a single phase grid
analyzer, Opt. Lett. **38**, 4605 (2013).

[95] J. Rizzi, P. Mercere, M. Idir, P. D. Silva, G. Vincent,
and J. Primot, X-ray phase contrast imaging and noise
evaluation using a single phase grating interferometer,
Opt. Express **21**, 17340 (2013).

[96] S. B´erujon, E. Ziegler, R. Cerbino, and L. Peverini,
Two-dimensional x-ray beam phase sensing, Phys. Rev.
Lett. **108**, 158102 (2012).

[97] K. S. Morgan, D. M. Paganin, and K. K. Siu, X-ray
phase imaging with a paper analyzer, Appl. Phys. Lett.
**100**, 124102 (2012).

[98] S. Berujon, H. Wang, and K. Sawhney, X-ray multimodal imaging using a random-phase object, Phys. Rev.
A **86**, 063813 (2012).

[99] M.-C. Zdora, P. Thibault, T. Zhou, F. J. Koch,
J. Romell, S. Sala, A. Last, C. Rau, and I. Zanette, Xray phase-contrast imaging and metrology through unified modulated pattern analysis, Phys. Rev. Lett. **118**,
203903 (2017).

[100] M.-C. Zdora, State of the art of X-ray speckle-based
phase-contrast and dark-field imaging, J. Imaging **4**, 60
(2018).

[101] D. M. Paganin, H. Labriet, E. Brun, and S. Berujon, Single-image geometric-flow x-ray speckle tracking,
Phys. Rev. A **98**, 053813 (2018).

[102] M.-C. Zdora, _X-ray Phase-Contrast Imaging Using_
_Near-Field Speckles_ (Springer, Cham, 2021).

[103] V. Boominathan, J. T. Robinson, L. Waller, and
A. Veeraraghavan, Recent advances in lensless imaging,
Optica **9**, 1 (2022).

[104] S. H. Gage, Modern dark-field microscopy and the history of its development, Trans. Am. Microsc. Soc. **39**,
95 (1920).

[105] F. Pfeiffer, M. Bech, O. Bunk, P. Kraft, E. F. Eikenberry, Ch. Br¨onnimann, C. Gr¨unzweig, and C. David,
Hard-X-ray dark-field imaging using a grating interferometer, Nat. Mater. **7**, 134 (2008).

[106] A. Snigirev, I. Snigireva, V. Kohn, S. Kuznetsov, and
I. Schelokov, On the possibilities of x-ray phase contrast
microimaging by coherent high-energy synchrotron radiation, Rev. Sci. Instrum. **66**, 5486 (1995).

[107] D. Gabor, A new microscopic principle, Nature **161**, 777
(1948).

[108] B. E. A. Saleh and M. C. Teich, _Fundamentals of Pho-_
_tonics_ (Wiley, New York, 1991).

[109] W. O. Saxton and W. Baumeister, The correlation averaging of a regularly arranged bacterial cell envelope
protein, J. Microsc. **127**, 127 (1982).

[110] M. A. Neifeld, Information, resolution, and spacebandwidth product, Opt. Lett. **23**, 1477 (1998).

[111] T. E. Gureyev, F. de Hoog, Ya. I. Nesterets, and D. M.
Paganin, On the noise-resolution duality, Heisenberg
uncertainty and Shannon’s information, ANZIAM J. **56**,
C1 (2015).

[112] A. J. den Dekker and A. van den Bos, Resolution: a
survey, J. Opt. Soc. Am. A **14**, 547 (1997).


[113] A. van den Bos and A. den Dekker, Resolution
reconsidered–Conventional approaches and an alternative, Adv. Imaging Electron Phys. **117**, 241 (2001).

[114] T. E. Gureyev, Ya. I. Nesterets, F. de Hoog, G. Schmalz,
S. C. Mayo, S. Mohammadi, and G. Tromba, Duality
between noise and spatial resolution in linear systems,
Opt. Express **22**, 9087 (2014).

[115] F. de Hoog, G. Schmalz, and T. E. Gureyev, An uncertainty inequality, Appl. Math. Lett. **38**, 84 (2014).

[116] T. E. Gureyev, Ya. I. Nesterets, and F. de Hoog, Spatial
resolution, signal-to-noise and information capacity of
linear imaging systems, Opt. Express **24**, 17168 (2016).

[117] P. W. Bridgman, _Dimensional Analysis_ (Yale University
Press, New Haven CT, 1922).

[118] D. S. Lemons, _A Student’s Guide to Dimensional Anal-_
_ysis_ (Cambridge University Press, Cambridge, 2017).

[119] M. Endrizzi, X-ray phase-contrast imaging, Nucl. Instrum. Methods Phys. Res. A **878**, 88 (2018).

[120] A. A. Michelson, _Studies in Optics_ (University of
Chicago Press, Chicago, 1927).

[121] M. Strobl, C. Gr¨unzweig, A. Hilger, I. Manke, N. Kardjilov, C. David, and F. Pfeiffer, Neutron dark-field tomography, Phys. Rev. Lett. **101**, 123902 (2008).

[122] F. Pfeiffer, M. Bech, O. Bunk, T. Donath, B. Henrich,
P. Kraft, and C. David, X-ray dark-field and phasecontrast imaging using a grating interferometer, J. Appl.
Phys. **105**, 102006 (2009).

[123] I. Zanette, T. Zhou, A. Burvall, U. Lundstr¨om, D. H.
Larsson, M. Zdora, P. Thibault, F. Pfeiffer, and H. M.
Hertz, Speckle-based x-ray phase-contrast and darkfield imaging with a laboratory source, Phys. Rev. Lett.
**112**, 253903 (2014).

[124] W. Yashiro and A. Momose, Effects of unresolvable
edges in grating-based X-ray differential phase imaging,
Opt. Express **23**, 9233 (2015).

[125] G. R. Morrison and M. T. Browne, Dark-field imaging
with the scanning transmission x-ray microscope, Rev.
Sci. Instrum. **63**, 611 (1992).

[126] Y. Suzuki and F. Uchida, Dark-field imaging in hard
x-ray scanning microscopy, Rev. Sci. Instrum. **66**, 1468
(1995).

[127] C. F. Groenendijk, F. Schaff, L. C. P. Croton, M. J.
Kitchen, and K. S. Morgan, Material decomposition
from a single x-ray projection via single-grid phase contrast imaging, Opt. Lett. **45**, 4076 (2020).

[128] T. Young, The Bakerian lecture: On the theory of light
and colours, Phil. Trans. R. Soc. Lond. **92**, 12 (1802).

[129] G. A. Maggi, Sulla propagazione libera e perturbata
delle onde luminose in un mezzo isotropo, Annali di
Mat. II **16**, 21 (1888).

[130] A. Rubinowicz, Die Beugungswelle in der Kirchhoffschen Theorie der Beugungserscheinungen, Ann. Physik
**53**, 257 (1917).

[131] K. Miyamoto and E. Wolf, Generalization of the MaggiRubinowicz theory of the boundary diffraction wave–
Part I, J. Opt. Soc. Am. **52**, 615 (1962).

[132] K. Miyamoto and E. Wolf, Generalization of the MaggiRubinowicz theory of the boundary diffraction wave–
Part II, J. Opt. Soc. Am. **52**, 626 (1962).

[133] J. H. Hannay, Fresnel diffraction as an aperture edge
integral, J. Mod. Opt. **47**, 121 (2000).

[134] R. Borghi, Uniform asymptotics of paraxial boundary
diffraction waves, J. Opt. Soc. Am. A **32**, 685 (2015).



35


[135] J. B. Keller, Geometrical theory of diffraction, J. Opt.
Soc. Am. **52**, 116 (1962).

[136] M. Esposito, L. Massimi, I. Buchanan, J. D. Ferrara,
M. Endrizzi, and A. Olivo, A laboratory-based, lowenergy, multi-modal x-ray microscope with user-defined
resolution, Appl. Phys. Lett. **120**, 234101 (2022).

[137] M. K. Croughan, Y. Y. How, A. Pennings, and K. S.
Morgan, Directional dark-field retrieval with single-grid
x-ray imaging, Opt. Express **31**, 11578 (2023).

[138] M. Esposito, I. Buchanan, L. Massimi, J. D. Ferrara,
P. R. Shearing, A. Olivo, and M. Endrizzi, Laboratorybased x-ray dark-field microscopy, Phys. Rev. Appl. **20**,
064039 (2023).

[139] H. P. Yuen and P. Tombesi, Langevin equations with
negative diffusion coefficients. A new approach to quantum optics, Opt. Commun. **59**, 155 (1986).

[140] W. Tan, Y. Li, and W. Zhang, The solution of the
Fokker-Planck equation with zero or negative diffusion
coefficients in quantum optics, Opt. Commun. **64**, 195
(1987).

[141] T. E. Gureyev, Ya. I. Nesterets, A. W. Stevenson, P. R.
Miller, A. Pogany, and S. W. Wilkins, Some simple rules
for contrast, signal-to-noise and resolution in in-line
x-ray phase-contrast imaging, Opt. Express **16**, 3223
(2008).

[142] Yu. A. Kravtsov and Yu. I. Orlov, _Caustics, Catastro-_
_phes and Wave Fields_, 2nd ed. (Springer, Berlin, 1999).

[143] D. Paganin, S. C. Mayo, T. E. Gureyev, P. R. Miller,
and S. W. Wilkins, Simultaneous phase and amplitude
extraction from a single defocused image of a homogeneous object, J. Microsc. **206**, 33 (2002).

[144] T. E. Gureyev, D. M. Paganin, K. M. Pavlov, A. Maksimenko, and H. M. Quiney, Signal-to-noise and spatial
resolution in in-line imaging. 2. Phase-contrast tomography, J. Synch. Radiat. **32**, 1463 (2025).

[145] P. K. Poola and R. John, Label-free nanoscale characterization of red blood cell structure and dynamics using
single-shot transport of intensity equation, J. Biomed.
Opt. **22**, 106001 (2017).

[146] D. Gabor, _The Electron Microscope: Its Development,_
_Present Performance and Future Possibilities_ (Chemical Publishing Co., Brooklyn and New York, 1948) p. 48.

[147] B. E. Allman, P. J. McMahon, K. A. Nugent, D. Paganin, D. L. Jacobson, M. Arif, and S. A. Werner, Phase
radiography with neutrons, Nature **408**, 158 (2000).

[148] T. E. Gureyev, A. W. Stevenson, Ya. I. Nesterets, and
S. W. Wilkins, Image deblurring by means of defocus,
Opt. Commun. **240**, 81 (2004).

[149] M. A. Beltran, D. M. Paganin, and D. Pelliccia, Phaseand-amplitude recovery from a single phase-contrast image using partially spatially coherent x-ray radiation, J.
Opt. **20**, 055605 (2018).

[150] M. E. Peskin and D. V. Schroeder, _An Introduction to_
_Quantum Field Theory_ (CRC Press, Boca Raton, FL,
USA, 1995).

[151] G. Magyar and L. Mandel, Interference fringes produced
by superposition of two independent maser light beams,
Nature **198**, 255 (1963).

[152] D. M. Paganin and M. S´anchez del R´ıo, Speckled crossspectral densities and their associated correlation singularities for a modern source of partially coherent x rays,
Phys. Rev. A **100**, 043813 (2019).

[153] H. D. Bale and P. W. Schmidt, Small-angle x-rayscattering investigation of submicroscopic porosity with


fractal properties, Phys. Rev. Lett. **53**, 596 (1984).

[154] S. K. Sinha, E. B. Sirota, S. Garoff, and H. B. Stanley,
X-ray and neutron scattering from rough surfaces, Phys.
Rev. B **38**, 2297 (1988).

[155] J. Teixeira, Small-angle scattering by fractal systems, J.
Appl. Cryst. **21**, 781 (1988).

[156] E. Jakeman and K. D. Ridley, _Modeling Fluctuations in_
_Scattered Waves_ (Taylor & Francis, New York, 2006).

[157] K. Pearson, IX. Mathematical contributions to the theory of evolution. XIX. Second supplement to a memoir on skew variation, Phil. Trans. R. Soc. A **216**, 429
(1916).

[158] E. Wolf, New theory of partial coherence in the spacefrequency domain. Part I: spectra and cross-spectra of
steady-state sources, J. Opt. Soc. Am. **72**, 343 (1982).

[159] W. D. Montgomery, Unitary operators in the homogeneous wave field, Opt. Lett. **6**, 314 (1981).

[160] K. S. Thorne and R. D. Blandford, _Modern Classical_
_Physics: Optics, Fluids, Plasmas, Elasticity, Relativity,_
_and Statistical Physics_ (Princeton, Princeton University
Press, 2017) pp. 183–184.

[161] J. L. McCauley, _Chaos, Dynamics, and Fractals: An Al-_
_gorithmic Approach to Deterministic Chaos_ (Cambridge
University Press, Cambridge, 1993) pp. 105–108.

[162] S. N. Alperin, A. L. Grotelueschen, and M. E. Siemens,
Quantum turbulent structure in light, Phys. Rev. Lett.
**122**, 044301 (2019).

[163] J. W. Goodman, _Statistical Optics_ (John Wiley & Sons,
New York, 1985).

[164] J. W. Goodman, _Speckle Phenomena in Optics_ (Roberts
and Company, Englewood Colorado, 2007).

[165] M. A. Alonso, Wigner functions in optics: describing
beams as ray bundles and pulses as particle ensembles,
Adv. Opt. Photon. **3**, 272 (2011).

[166] E. W. Marchand and E. Wolf, Walther’s definitions of
generalized radiance, J. Opt. Soc. Am. **64**, 1273 (1974).

[167] A. Papoulis, Ambiguity function in Fourier optics, J.
Opt. Soc. Am. **64**, 779 (1974).



36


[168] R. Erni, _Aberration-Corrected Imaging in Transmission_
_Electron Microscopy: An Introduction_, 2nd ed. (Imperial College Press, London, 2015).

[169] I. S. Anderson, R. L. McGreevy, and H. Z. Bilheux, eds.,
_Neutron Imaging and Applications: A Reference for the_
_Imaging Community_ (Springer, Boston, 2009).

[170] P. Cloetens, R. Barrett, J. Baruchel, J.-P. Guigay, and
M. Schlenker, Phase objects in synchrotron radiation
hard x-ray imaging, J. Phys. D: Appl. Phys. **29**, 133
(1996).

[171] A. G. Klein and G. I. Opat, Observation of 2 _π_ rotations
by Fresnel diffraction of neutrons, Phys. Rev. Lett. **37**,
238 (1976).

[172] D. Pelliccia and D. M. Paganin, _Synchrotron Light_ (Oxford University Press, Oxford, 2025).

[173] L. Reimer and H. Kohl, _Transmission Electron Mi-_
_croscopy:_ _Physics_ _of_ _Image_ _Formation_, 5th ed.
(Springer, New York, 2008).

[174] A. G. Klein and S. A. Werner, Neutron optics, Rep.
Prog. Phys. **46**, 259 (1983).

[175] N. Fomin, J. Fry, R. W. Pattie, and G. L. Greene, Fundamental neutron physics at spallation sources, Annu.
Rev. Nucl. Part. Sci. **72**, 151 (2022).

[176] S. W. Wilkins, T. E. Gureyev, D. Gao, A. Pogany, and
A. W. Stevenson, Phase-contrast imaging using polychromatic hard X-rays, Nature **384**, 335 (1996).

[177] S. W. Wilkins, Ya. I. Nesterets, T. E. Gureyev, S. C.
Mayo, A. Pogany, and A. W. Stevenson, On the evolution and relative merits of hard X-ray phase-contrast
imaging methods, Phil. Trans. R. Soc. A **372**, 20130021
(2014).

[178] D. H. Larsson, P. A. C. Takman, U. Lundstr¨om, A. Burvall, and H. M. Hertz, A 24 keV liquid-metal-jet x-ray
source for biomedical applications, Rev. Sci. Instrum.
**82**, 123701 (2011).

[179] R. Carminati and J. C. Schotland, _Principles of Scat-_
_tering and Transport of Light_ (Cambridge University
Press, Cambridge, 2021).

[180] D. S. Sivia, _Elementary Scattering Theory_ (Oxford University Press, Oxford, 2011).


